!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstone-core",[],t):"object"==typeof exports?exports["cornerstone-core"]=t():e.cornerstone=t()}(window,function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(x[e]&&y[e]){for(var n in y[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(g[n]=t[n]);0==--v&&0===p&&E()}}(e,n),t&&t(e,n)};var n,a=!0,r="4d8d88ba53621f59b9a9",o={},i=[],s=[];function l(e){var t=C[e];if(!t)return M;var a=function(a){return t.hot.active?(C[a]?-1===C[a].parents.indexOf(e)&&C[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),M(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return M[e]},set:function(t){M[e]=t}}};for(var o in M)Object.prototype.hasOwnProperty.call(M,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),p++,M.e(e).then(t,function(e){throw t(),e});function t(){p--,"prepare"===c&&(b[e]||T(e),0===p&&0===v&&E())}},a.t=function(e,t){return 1&t&&(e=a(e)),M.t(e,-2&t)},a}function u(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:w,apply:O,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[e]};return n=void 0,t}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var m,g,h,v=0,p=0,b={},y={},x={};function j(e){return+e+""===e?+e:e}function w(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=M.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f("idle"),null;y={},b={},x=e.c,h=e.h,f("prepare");var t=new Promise(function(e,t){m={resolve:e,reject:t}});return g={},T("cornerstone"),"prepare"===c&&0===p&&0===v&&E(),t});var t}function T(e){x[e]?(y[e]=!0,v++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=M.p+""+e+"."+r+".hot-update.js",t.appendChild(n)}(e)):b[e]=!0}function E(){f("ready");var e=m;if(m=null,e)if(a)Promise.resolve().then(function(){return O(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&t.push(j(n));e.resolve(t)}}function O(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");var n,a,s,l,u;function d(e){for(var t=[e],n={},a=t.slice().map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((l=C[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],d=C[u];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(d.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),m(n[u],[o])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var v={},p=[],b={},y=function(){console.warn("[HMR] unexpected require("+T.moduleId+") to disposed module")};for(var w in g)if(Object.prototype.hasOwnProperty.call(g,w)){var T;u=j(w);var E=!1,O=!1,I=!1,S="";switch((T=g[w]?d(u):{type:"disposed",moduleId:w}).chain&&(S="\nUpdate propagation: "+T.chain.join(" -> ")),T.type){case"self-declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(E=new Error("Aborted because of self decline: "+T.moduleId+S));break;case"declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+T.moduleId+" in "+T.parentId+S));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(T),t.ignoreUnaccepted||(E=new Error("Aborted because "+u+" is not accepted"+S));break;case"accepted":t.onAccepted&&t.onAccepted(T),O=!0;break;case"disposed":t.onDisposed&&t.onDisposed(T),I=!0;break;default:throw new Error("Unexception type "+T.type)}if(E)return f("abort"),Promise.reject(E);if(O)for(u in b[u]=g[u],m(p,T.outdatedModules),T.outdatedDependencies)Object.prototype.hasOwnProperty.call(T.outdatedDependencies,u)&&(v[u]||(v[u]=[]),m(v[u],T.outdatedDependencies[u]));I&&(m(p,[T.moduleId]),b[u]=y)}var P,D=[];for(a=0;a<p.length;a++)C[u=p[a]]&&C[u].hot._selfAccepted&&D.push({module:u,errorHandler:C[u].hot._selfAccepted});f("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var _,L=p.slice();L.length>0;)if(u=L.pop(),l=C[u]){var k={},A=l.hot._disposeHandlers;for(s=0;s<A.length;s++)(n=A[s])(k);for(o[u]=k,l.hot.active=!1,delete C[u],delete v[u],s=0;s<l.children.length;s++){var R=C[l.children[s]];R&&(P=R.parents.indexOf(u))>=0&&R.parents.splice(P,1)}}for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(l=C[u]))for(_=v[u],s=0;s<_.length;s++)(P=l.children.indexOf(_[s]))>=0&&l.children.splice(P,1);for(u in f("apply"),r=h,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(l=C[u])){_=v[u];var H=[];for(a=0;a<_.length;a++)if(n=l.hot._acceptedDependencies[_[a]]){if(-1!==H.indexOf(n))continue;H.push(n)}for(a=0;a<H.length;a++){n=H[a];try{n(_)}catch(U){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:_[a],error:U}),t.ignoreErrored||B||(B=U)}}}for(a=0;a<D.length;a++){var F=D[a];i=[u=F.module];try{M(u)}catch(U){if("function"==typeof F.errorHandler)try{F.errorHandler(U)}catch(N){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:N,originalError:U}),t.ignoreErrored||B||(B=N),B||(B=U)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:U}),t.ignoreErrored||B||(B=U)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise(function(e){e(p)}))}var C={};function M(t){if(C[t])return C[t].exports;var n=C[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return M.m=e,M.c=C,M.d=function(e,t,n){M.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},M.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},M.t=function(e,t){if(1&t&&(e=M(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(M.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)M.d(n,a,(function(t){return e[t]}).bind(null,a));return n},M.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return M.d(t,"a",t),t},M.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},M.p="",M.h=function(){return r},l("./index.js")(M.s="./index.js")}({"./canvasToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),o=Object(r.default)(n);return o.invert(),o.transformPoint(t.x,t.y)}},"./colors/colormap.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getColormapsList",function(){return l}),n.d(t,"getColormap",function(){return u});var a=n("./colors/lookupTable.js"),r=[0,0,0,0],o={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}};function i(e,t){for(var n=0,a=e.length-1;n<=a;){var r=n+Math.floor((a-n)/2),o=e[r];if(o===t)return r;t<o?a=r-1:n=r+1}return n}function s(e,t,n){var a,r=[],o=[],s=[],l=[];for(n=null===n?1:n,a=0;a<t.length;a++){var u=t[a];r.push((e-1)*u[0]),o.push(u[1]),s.push(u[1])}var d=function(e,t,n){for(var a=(1-e)/((n=null===n?100:n)-1),r=[];n-- >0;)r.push(e),e+=a;return r[r.length-1]=1,r}(0,0,e);for(a=0;a<e;a++)d[a]=(e-1)*Math.pow(d[a],n);var c=function(e,t){var n,a=[],r=t.length;for(e.sort(function(e,t){return e-t}),n=0;n<r;n++)a[n]=i(e,t[n]);return a}(r,d);for(a=1;a<e-1;a++){var f=c[a];l[a]=(d[a]-r[f-1])/(r[f]-r[f-1])*(o[f]-s[f-1])+s[f-1]}return l[0]=s[0],l[e-1]=o[t.length-1],l}function l(){var e=[];return Object.keys(o).forEach(function(t){o.hasOwnProperty(t)&&e.push({id:t,name:o[t].name})}),e.sort(function(e,t){var n=e.name.toLowerCase(),a=t.name.toLowerCase();return n===a?0:n<a?-1:1}),e}function u(e,t){var n=o[e];return n||(n=o[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=function(e,t,n){var a,r=[],o=s(t=null===t?256:t,e.red,n=null===n?1:n),i=s(t,e.green,n),l=s(t,e.blue,n);for(a=0;a<t;a++){var u=Math.round(255*o[a]),d=Math.round(255*i[a]),c=Math.round(255*l[a]);r.push([u,d,c,255])}return r}(n.segmentedData,n.numColors,n.gamma)),{getId:function(){return e},getColorSchemeName:function(){return n.name},setColorSchemeName:function(e){n.name=e},getNumberOfColors:function(){return n.colors.length},setNumberOfColors:function(e){for(;n.colors.length<e;)n.colors.push(r);n.colors.length=e},getColor:function(e){return this.isValidIndex(e)?n.colors[e]:r},getColorRepeating:function(e){var t=n.colors.length;return this.getColor(e=t?e%t:0)},setColor:function(e,t){this.isValidIndex(e)&&(n.colors[e]=t)},addColor:function(e){n.colors.push(e)},insertColor:function(e,t){this.isValidIndex(e)&&n.colors.splice(e,1,t)},removeColor:function(e){this.isValidIndex(e)&&n.colors.splice(e,1)},clearColors:function(){n.colors=[]},buildLookupTable:function(e){if(e){var t=n.colors.length;e.setNumberOfTableValues(t);for(var a=0;a<t;a++)e.setTableValue(a,n.colors[a])}},createLookupTable:function(){var e=new a.default;return this.buildLookupTable(e),e},isValidIndex:function(e){return e>=0&&e<n.colors.length}}}},"./colors/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/colormap.js"),r=n("./colors/lookupTable.js");t.default={getColormap:a.getColormap,getColormapsList:a.getColormapsList,LookupTable:r.default}},"./colors/lookupTable.js":function(e,t,n){"use strict";function a(e,t,n){if(e>1)throw new Error("HSVToRGB expects hue < 1");var a=[];if(0===t)return a[0]=n,a[1]=n,a[2]=n,a;var r=Math.floor(6*e),o=6*e-r,i=n*(1-t),s=n*(1-t*o),l=n*(1-t*(1-o));switch(r){case 0:case 6:a[0]=n,a[1]=l,a[2]=i;break;case 1:a[0]=s,a[1]=n,a[2]=i;break;case 2:a[0]=i,a[1]=n,a[2]=l;break;case 3:a[0]=i,a[1]=s,a[2]=n;break;case 4:a[0]=l,a[1]=i,a[2]=n;break;case 5:a[0]=n,a[1]=i,a[2]=s}return a}n.r(t),t.default=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}var t;return(t=[{key:"setNumberOfTableValues",value:function(e){this.NumberOfColors=e}},{key:"setRamp",value:function(e){this.Ramp=e}},{key:"setTableRange",value:function(e,t){this.TableRange[0]=e,this.TableRange[1]=t}},{key:"setHueRange",value:function(e,t){this.HueRange[0]=e,this.HueRange[1]=t}},{key:"setSaturationRange",value:function(e,t){this.SaturationRange[0]=e,this.SaturationRange[1]=t}},{key:"setValueRange",value:function(e,t){this.ValueRange[0]=e,this.ValueRange[1]=t}},{key:"setRange",value:function(e,t){this.InputRange[0]=e,this.InputRange[1]=t}},{key:"setAlphaRange",value:function(e,t){this.AlphaRange[0]=e,this.AlphaRange[1]=t}},{key:"getColor",value:function(e){return this.mapValue(e)}},{key:"build",value:function(e){if(!(this.Table.length>1)||e){this.Table=[];var t,n,r,o,i=this.NumberOfColors-1;i?(t=(this.HueRange[1]-this.HueRange[0])/i,n=(this.SaturationRange[1]-this.SaturationRange[0])/i,r=(this.ValueRange[1]-this.ValueRange[0])/i,o=(this.AlphaRange[1]-this.AlphaRange[0])/i):t=n=r=o=0;for(var s=0;s<=i;s++){var l=this.AlphaRange[0]+s*o,u=a(this.HueRange[0]+s*t,this.SaturationRange[0]+s*n,this.ValueRange[0]+s*r),d=[];switch(this.Ramp){case"scurve":d[0]=Math.floor(127.5*(1+Math.cos((1-u[0])*Math.PI))),d[1]=Math.floor(127.5*(1+Math.cos((1-u[1])*Math.PI))),d[2]=Math.floor(127.5*(1+Math.cos((1-u[2])*Math.PI))),d[3]=Math.floor(255*l);break;case"linear":d[0]=Math.floor(255*u[0]+.5),d[1]=Math.floor(255*u[1]+.5),d[2]=Math.floor(255*u[2]+.5),d[3]=Math.floor(255*l+.5);break;case"sqrt":d[0]=Math.floor(255*Math.sqrt(u[0])+.5),d[1]=Math.floor(255*Math.sqrt(u[1])+.5),d[2]=Math.floor(255*Math.sqrt(u[2])+.5),d[3]=Math.floor(255*Math.sqrt(l)+.5);break;default:throw new Error("Invalid Ramp value (".concat(this.Ramp,")"))}this.Table.push(d)}this.buildSpecialColors()}}},{key:"buildSpecialColors",value:function(){var e=this.NumberOfColors,t=e+1,n=e+2;this.Table[e+0]=this.UseBelowRangeColor||0===e?this.BelowRangeColor:this.Table[0],this.Table[t]=this.UseAboveRangeColor||0===e?this.AboveRangeColor:this.Table[e-1],this.Table[n]=this.NaNColor}},{key:"mapValue",value:function(e){var t=this.getIndex(e);if(t<0)return this.NaNColor;if(0===t){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(t===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[t]}},{key:"getIndex",value:function(e){var t={Range:[]};if(t.MaxIndex=this.NumberOfColors-1,t.Shift=-this.TableRange[0],t.Scale=this.TableRange[1]<=this.TableRange[0]?Number.MAX_VALUE:t.MaxIndex/(this.TableRange[1]-this.TableRange[0]),t.Range[0]=this.TableRange[0],t.Range[1]=this.TableRange[1],isNaN(e))return-1;var n=function(e,t){return Math.floor(e<t.Range[0]?t.MaxIndex+0+1.5:e>t.Range[1]?t.MaxIndex+1+1.5:(e+t.Shift)*t.Scale)}(e,t);return n===this.NumberOfColors+0?n=0:n===this.NumberOfColors+1&&(n=this.NumberOfColors-1),n}},{key:"setTableValue",value:function(e,t){if(5===arguments.length&&(t=Array.prototype.slice.call(arguments,1)),e<0)throw new Error("Can't set the table value for negative index (".concat(e,")"));e>=this.NumberOfColors&&new Error("Index ".concat(e," is greater than the number of colors ").concat(this.NumberOfColors)),this.Table[e]=t,0!==e&&e!==this.NumberOfColors-1||this.buildSpecialColors()}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}()},"./disable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./triggerEvent.js"),o=n("./events.js");t.default=function(e){if(void 0===e)throw new Error("disable: element must not be undefined");for(var t=Object(a.getEnabledElements)(),n=0;n<t.length;n++)if(t[n].element===e){var i={element:e};Object(r.default)(e,o.default.ELEMENT_DISABLED,i),Object(r.default)(o.events,o.default.ELEMENT_DISABLED,i),t[n].element.removeChild(t[n].canvas),t[n].canvas=void 0,t.splice(n,1);break}}},"./displayImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js"),o=n("./updateImage.js"),i=n("./internal/now.js"),s=n("./layers.js"),l=n("./triggerEvent.js"),u=n("./events.js");t.default=function(e,t,n){if(void 0===e)throw new Error("displayImage: parameter element must not be undefined");if(void 0===t)throw new Error("displayImage: parameter image must not be undefined");var d,c=Object(a.getEnabledElement)(e),f=c.image;if(c.image=t,c.layers&&c.layers.length&&Object(s.setLayerImage)(e,t),void 0===c.viewport&&(c.viewport=Object(r.default)(c.canvas,t)),n)for(var m in n)null!==n[m]&&(c.viewport[m]=n[m]);void 0!==c.lastImageTimeStamp&&(d=(1e3/(Object(i.default)()-c.lastImageTimeStamp)).toFixed()),c.lastImageTimeStamp=Object(i.default)();var g={viewport:c.viewport,element:c.element,image:c.image,oldImage:f,enabledElement:c,frameRate:d};Object(l.default)(c.element,u.default.NEW_IMAGE,g),Object(o.default)(e)}},"./draw.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);Object(r.default)(t)}},"./drawInvalidated.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(){for(var e=Object(a.getEnabledElements)(),t=0;t<e.length;t++){var n=e[t];!0===n.invalid&&Object(r.default)(n,!0)}}},"./enable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./resize.js"),o=n("./internal/drawImageSync.js"),i=n("./internal/requestAnimationFrame.js"),s=n("./internal/tryEnableWebgl.js"),l=n("./triggerEvent.js"),u=n("./generateUUID.js"),d=n("./events.js"),c=n("./internal/getCanvas.js");t.default=function(e,t){if(void 0===e)throw new Error("enable: parameter element cannot be undefined");t&&t.renderer&&"webgl"===t.renderer.toLowerCase()&&Object(s.default)(t);var n={element:e,canvas:Object(c.default)(e),image:void 0,invalid:!1,needsRedraw:!0,options:Object.assign({},t),layers:[],data:{},renderingTools:{},uuid:Object(u.default)()};Object(a.addEnabledElement)(n),Object(l.default)(d.events,d.default.ELEMENT_ENABLED,n),Object(r.default)(e,!0),function e(t){if(void 0!==n.canvas){var a={enabledElement:n,timestamp:t};Object(l.default)(n.element,d.default.PRE_RENDER,a),n.needsRedraw&&function(e){return void 0!==e.image||e.layers.length>0}(n)&&Object(o.default)(n,n.invalid),Object(i.default)(e)}}()}},"./enabledElementData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getElementData",function(){return r}),n.d(t,"removeElementData",function(){return o});var a=n("./enabledElements.js");function r(e,t){var n=Object(a.getEnabledElement)(e);return!1===n.data.hasOwnProperty(t)&&(n.data[t]={}),n.data[t]}function o(e,t){delete Object(a.getEnabledElement)(e).data[t]}},"./enabledElements.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getEnabledElement",function(){return r}),n.d(t,"addEnabledElement",function(){return o}),n.d(t,"getEnabledElementsByImageId",function(){return i}),n.d(t,"getEnabledElements",function(){return s});var a=[];function r(e){if(void 0===e)throw new Error("getEnabledElement: parameter element must not be undefined");for(var t=0;t<a.length;t++)if(a[t].element===e)return a[t];throw new Error("element not enabled")}function o(e){if(void 0===e)throw new Error("getEnabledElement: enabledElement element must not be undefined");a.push(e)}function i(e){var t=[];return a.forEach(function(n){n.image&&n.image.imageId===e&&t.push(n)}),t}function s(){return a}},"./events.js":function(e,t,n){"use strict";n.r(t),n.d(t,"events",function(){return a}),t.default={NEW_IMAGE:"cornerstonenewimage",INVALIDATED:"cornerstoneinvalidated",PRE_RENDER:"cornerstoneprerender",IMAGE_CACHE_MAXIMUM_SIZE_CHANGED:"cornerstoneimagecachemaximumsizechanged",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",IMAGE_CACHE_FULL:"cornerstoneimagecachefull",IMAGE_CACHE_CHANGED:"cornerstoneimagecachechanged",WEBGL_TEXTURE_REMOVED:"cornerstonewebgltextureremoved",WEBGL_TEXTURE_CACHE_FULL:"cornerstonewebgltexturecachefull",IMAGE_LOADED:"cornerstoneimageloaded",IMAGE_LOAD_PROGRESS:"cornerstoneimageloadprogress",IMAGE_LOAD_FAILED:"cornerstoneimageloadfailed",ELEMENT_RESIZED:"cornerstoneelementresized",IMAGE_RENDERED:"cornerstoneimagerendered",LAYER_ADDED:"cornerstonelayeradded",LAYER_REMOVED:"cornerstonelayerremoved",ACTIVE_LAYER_CHANGED:"cornerstoneactivelayerchanged",ELEMENT_DISABLED:"cornerstoneelementdisabled",ELEMENT_ENABLED:"cornerstoneelementenabled"};var a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={},this.namespaces={}}var t;return(t=[{key:"addEventNamespaceListener",value:function(e,t){e.indexOf(".")<=0||(this.namespaces[e]=t,this.addEventListener(e.split(".")[0],t))}},{key:"removeEventNamespaceListener",value:function(e){e.indexOf(".")<=0||!this.namespaces[e]||(this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e])}},{key:"addEventListener",value:function(e,t){e.indexOf(".")>0?this.addEventNamespaceListener(e,t):(e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t))}},{key:"removeEventListener",value:function(e,t){if(e.indexOf(".")>0)this.removeEventNamespaceListener(e);else if(e in this.listeners)for(var n=this.listeners[e],a=0,r=n.length;a<r;a++)if(n[a]===t)return void n.splice(a,1)}},{key:"dispatchEvent",value:function(e){if(!(e.type in this.listeners))return!0;for(var t=this.listeners[e.type].slice(),n=0,a=t.length;n<a;n++)t[n].call(this,e);return!e.defaultPrevented}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}())},"./falseColorMapping.js":function(e,t,n){"use strict";n.r(t),n.d(t,"convertImageToFalseColorImage",function(){return s}),n.d(t,"convertToFalseColorImage",function(){return l}),n.d(t,"restoreImage",function(){return i});var a=n("./enabledElements.js"),r=n("./pixelDataToFalseColorData.js"),o=n("./colors/colormap.js");function i(e){return!(!e.restore||"function"!=typeof e.restore||(e.restore(),0))}function s(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n=(t=function(e){return e&&"string"==typeof e&&(e=Object(o.getColormap)(e)),e}(t)).getId();if(e.colormapId===n)return!1;if(i(e),n){var a=e.minPixelValue||0,s=e.maxPixelValue||255;e.restore=function(e){if(e.restore)return e.restore;var t=e.color,n=e.rgba,a=e.cachedLut,r=e.slope,o=e.windowWidth,i=e.windowCenter,s=e.minPixelValue,l=e.maxPixelValue;return function(){if(e.color=t,e.rgba=n,e.cachedLut=a,e.slope=r,e.windowWidth=o,e.windowCenter=i,e.minPixelValue=s,e.maxPixelValue=l,e.origPixelData){var u=e.origPixelData;e.getPixelData=function(){return u}}e.origPixelData=void 0,e.colormapId=void 0,e.falseColor=void 0}}(e);var l=t.createLookupTable();l.setTableRange(a,s),Object(r.default)(e,l);var u=function(e){for(var t,n=Number.MAX_VALUE,a=Number.MIN_VALUE,r=e.length,o=0;o<r;o++)n=n<(t=e[o])?n:t,a=a>t?a:t;return{minPixelValue:n,maxPixelValue:a}}(e.getPixelData());e.minPixelValue=u.minPixelValue,e.maxPixelValue=u.maxPixelValue,e.windowWidth=255,e.windowCenter=128,e.colormapId=n}return!0}function l(e,t){return s(Object(a.getEnabledElement)(e).image,t)}},"./fitToWindow.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./updateImage.js"),o=n("./internal/getImageFitScale.js");t.default=function(e){var t=Object(a.getEnabledElement)(e),n=t.image;t.viewport.scale=Object(o.default)(t.canvas,n,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0,Object(r.default)(e)}},"./generateUUID.js":function(e,t,n){"use strict";n.r(t),t.default=function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}},"./getDefaultViewportForImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(r.default)(n.canvas,t)}},"./getImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){return Object(a.getEnabledElement)(e).image}},"./getPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./getStoredPixels.js"),o=n("./internal/getModalityLUT.js");t.default=function(e,t,n,i,s){var l=Object(r.default)(e,t,n,i,s),u=Object(a.getEnabledElement)(e),d=Object(o.default)(u.image.slope,u.image.intercept,u.viewport.modalityLUT);return l.map(d)}},"./getStoredPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e,t,n,r,o){if(void 0===e)throw new Error("getStoredPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);for(var i=Object(a.getEnabledElement)(e),s=[],l=0,u=i.image.getPixelData(),d=0;d<o;d++)for(var c=0;c<r;c++)s[l++]=u[(d+n)*i.image.columns+(c+t)];return s}},"./getViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){var t=Object(a.getEnabledElement)(e).viewport;if(void 0!==t)return Object.assign({},t)}},"./imageCache.js":function(e,t,n){"use strict";n.r(t),n.d(t,"cachedImages",function(){return l}),n.d(t,"setMaximumSizeBytes",function(){return u}),n.d(t,"putImageLoadObject",function(){return c}),n.d(t,"getImageLoadObject",function(){return f}),n.d(t,"removeImageLoadObject",function(){return m}),n.d(t,"getCacheInfo",function(){return g}),n.d(t,"purgeCache",function(){return h}),n.d(t,"changeImageIdCacheSize",function(){return v});var a=n("./events.js"),r=n("./triggerEvent.js"),o=1073741824,i=0,s={},l=[];function u(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");o=e,Object(r.default)(a.events,a.default.IMAGE_CACHE_MAXIMUM_SIZE_CHANGED),d()}function d(){if(!(i<=o)){for(l.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});i>o;){var e=l[l.length-1].imageId;m(e),Object(r.default)(a.events,a.default.IMAGE_CACHE_PROMISE_REMOVED,{imageId:e})}var t=g();Object(r.default)(a.events,a.default.IMAGE_CACHE_FULL,t)}}function c(e,t){if(void 0===e)throw new Error("putImageLoadObject: imageId must not be undefined");if(void 0===t.promise)throw new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");if(!0===s.hasOwnProperty(e))throw new Error("putImageLoadObject: imageId already in cache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw new Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");var n={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};s[e]=n,l.push(n),t.promise.then(function(e){if(-1!==l.indexOf(n)){if(n.loaded=!0,n.image=e,void 0===e.sizeInBytes)throw new Error("putImageLoadObject: image.sizeInBytes must not be undefined");if(void 0===e.sizeInBytes.toFixed)throw new Error("putImageLoadObject: image.sizeInBytes is not a number");n.sizeInBytes=e.sizeInBytes,i+=n.sizeInBytes;var t={action:"addImage",image:n};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,t),n.sharedCacheKey=e.sharedCacheKey,d()}},function(){l.splice(l.indexOf(s[e]),1),delete s[e]})}function f(e){if(void 0===e)throw new Error("getImageLoadObject: imageId must not be undefined");var t=s[e];if(void 0!==t)return t.timeStamp=Date.now(),t.imageLoadObject}function m(e){if(void 0===e)throw new Error("removeImageLoadObject: imageId must not be undefined");var t=s[e];if(void 0===t)throw new Error("removeImageLoadObject: imageId was not present in imageCache");l.splice(l.indexOf(t),1),i-=t.sizeInBytes;var n,o={action:"deleteImage",image:t};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,o),(n=t.imageLoadObject).promise.then(function(){n.decache&&n.decache()},function(){n.decache&&n.decache()}),delete s[e]}function g(){return{maximumSizeInBytes:o,cacheSizeInBytes:i,numberOfImagesCached:l.length}}function h(){for(;l.length>0;)m(l[0].imageId)}function v(e,t){var n=s[e];n&&n.imageLoadObject.promise.then(function(e){var o=t-e.sizeInBytes;e.sizeInBytes=t,n.sizeInBytes=t,i+=o;var s={action:"changeImageSize",image:e};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,s)})}t.default={imageCache:s,cachedImages:l,setMaximumSizeBytes:u,putImageLoadObject:c,getImageLoadObject:f,removeImageLoadObject:m,getCacheInfo:g,purgeCache:h,changeImageIdCacheSize:v}},"./imageLoader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"loadImage",function(){return u}),n.d(t,"loadAndCacheImage",function(){return d}),n.d(t,"registerImageLoader",function(){return c}),n.d(t,"registerUnknownImageLoader",function(){return f});var a,r=n("./imageCache.js"),o=n("./events.js"),i=n("./triggerEvent.js"),s={};function l(e,t){var n=e.indexOf(":"),r=e.substring(0,n),l=s[r];if(null==l){if(void 0!==a)return a(e);throw new Error("loadImageFromImageLoader: no image loader for imageId")}var u=l(e,t);return u.promise.then(function(e){Object(i.default)(o.events,o.default.IMAGE_LOADED,{image:e})},function(t){var n={imageId:e,error:t};Object(i.default)(o.events,o.default.IMAGE_LOAD_FAILED,n)}),u}function u(e,t){if(void 0===e)throw new Error("loadImage: parameter imageId must not be undefined");var n=Object(r.getImageLoadObject)(e);return void 0!==n?n.promise:l(e,t).promise}function d(e,t){if(void 0===e)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");var n=Object(r.getImageLoadObject)(e);return void 0!==n||(n=l(e,t),Object(r.putImageLoadObject)(e,n)),n.promise}function c(e,t){s[e]=t}function f(e){var t=a;return a=e,t}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js");n.d(t,"EVENTS",function(){return a.default}),n.d(t,"events",function(){return a.events});var r=n("./enabledElements.js");n.d(t,"getEnabledElement",function(){return r.getEnabledElement}),n.d(t,"addEnabledElement",function(){return r.addEnabledElement}),n.d(t,"getEnabledElementsByImageId",function(){return r.getEnabledElementsByImageId}),n.d(t,"getEnabledElements",function(){return r.getEnabledElements});var o=n("./layers.js");n.d(t,"addLayer",function(){return o.addLayer}),n.d(t,"removeLayer",function(){return o.removeLayer}),n.d(t,"getLayer",function(){return o.getLayer}),n.d(t,"getLayers",function(){return o.getLayers}),n.d(t,"getVisibleLayers",function(){return o.getVisibleLayers}),n.d(t,"setActiveLayer",function(){return o.setActiveLayer}),n.d(t,"getActiveLayer",function(){return o.getActiveLayer}),n.d(t,"purgeLayers",function(){return o.purgeLayers}),n.d(t,"setLayerImage",function(){return o.setLayerImage});var i=n("./falseColorMapping.js");n.d(t,"convertImageToFalseColorImage",function(){return i.convertImageToFalseColorImage}),n.d(t,"convertToFalseColorImage",function(){return i.convertToFalseColorImage}),n.d(t,"restoreImage",function(){return i.restoreImage});var s=n("./enabledElementData.js");n.d(t,"getElementData",function(){return s.getElementData}),n.d(t,"removeElementData",function(){return s.removeElementData});var l=n("./imageLoader.js");n.d(t,"loadImage",function(){return l.loadImage}),n.d(t,"loadAndCacheImage",function(){return l.loadAndCacheImage}),n.d(t,"registerImageLoader",function(){return l.registerImageLoader}),n.d(t,"registerUnknownImageLoader",function(){return l.registerUnknownImageLoader});var u=n("./requestPool/imageLoadPoolManager.ts");n.d(t,"imageLoadPoolManager",function(){return u.default});var d=n("./requestPool/imageRetrievalPoolManager.ts");n.d(t,"imageRetrievalPoolManager",function(){return d.default});var c=n("./requestPool/RequestPoolManager.ts");n.d(t,"RequestPoolManager",function(){return c.RequestPoolManager});var f=n("./canvasToPixel.js");n.d(t,"canvasToPixel",function(){return f.default});var m=n("./colors/index.js");n.d(t,"colors",function(){return m.default});var g=n("./disable.js");n.d(t,"disable",function(){return g.default});var h=n("./displayImage.js");n.d(t,"displayImage",function(){return h.default});var v=n("./draw.js");n.d(t,"draw",function(){return v.default});var p=n("./internal/drawImage.js");n.d(t,"drawImage",function(){return p.default});var b=n("./drawInvalidated.js");n.d(t,"drawInvalidated",function(){return b.default});var y=n("./enable.js");n.d(t,"enable",function(){return y.default});var x=n("./fitToWindow.js");n.d(t,"fitToWindow",function(){return x.default});var j=n("./internal/generateLut.js");n.d(t,"generateLut",function(){return j.default});var w=n("./internal/getDefaultViewport.js");n.d(t,"getDefaultViewport",function(){return w.default});var T=n("./getDefaultViewportForImage.js");n.d(t,"getDefaultViewportForImage",function(){return T.default});var E=n("./internal/getDisplayedArea.js");n.d(t,"getDisplayedArea",function(){return E.default});var O=n("./getImage.js");n.d(t,"getImage",function(){return O.default});var C=n("./getPixels.js");n.d(t,"getPixels",function(){return C.default});var M=n("./getStoredPixels.js");n.d(t,"getStoredPixels",function(){return M.default});var I=n("./getViewport.js");n.d(t,"getViewport",function(){return I.default});var S=n("./imageCache.js");n.d(t,"imageCache",function(){return S.default});var P=n("./internal/index.js");n.d(t,"internal",function(){return P.default});var D=n("./invalidate.js");n.d(t,"invalidate",function(){return D.default});var _=n("./invalidateImageId.js");n.d(t,"invalidateImageId",function(){return _.default});var L=n("./metaData.js");n.d(t,"metaData",function(){return L.default});var k=n("./pageToPixel.js");n.d(t,"pageToPixel",function(){return k.default});var A=n("./pixelDataToFalseColorData.js");n.d(t,"pixelDataToFalseColorData",function(){return A.default});var R=n("./pixelToCanvas.js");n.d(t,"pixelToCanvas",function(){return R.default});var B=n("./rendering/renderColorImage.js");n.d(t,"renderColorImage",function(){return B.renderColorImage});var H=n("./rendering/renderGrayscaleImage.js");n.d(t,"renderGrayscaleImage",function(){return H.renderGrayscaleImage});var F=n("./rendering/renderLabelMapImage.js");n.d(t,"renderLabelMapImage",function(){return F.renderLabelMapImage});var U=n("./rendering/renderPseudoColorImage.js");n.d(t,"renderPseudoColorImage",function(){return U.renderPseudoColorImage});var N=n("./rendering/renderToCanvas.js");n.d(t,"renderToCanvas",function(){return N.default});var V=n("./rendering/renderWebImage.js");n.d(t,"renderWebImage",function(){return V.renderWebImage});var z=n("./rendering/index.js");n.d(t,"rendering",function(){return z.default});var q=n("./internal/requestAnimationFrame.js");n.d(t,"requestAnimationFrame",function(){return q.default});var W=n("./reset.js");n.d(t,"reset",function(){return W.default});var G=n("./resize.js");n.d(t,"resize",function(){return G.default});var Y=n("./internal/setDefaultViewport.js");n.d(t,"setDefaultViewport",function(){return Y.default});var X=n("./setToPixelCoordinateSystem.js");n.d(t,"setToPixelCoordinateSystem",function(){return X.default});var J=n("./setViewport.js");n.d(t,"setViewport",function(){return J.default});var Z=n("./internal/storedColorPixelDataToCanvasImageData.js");n.d(t,"storedColorPixelDataToCanvasImageData",function(){return Z.default});var K=n("./internal/storedPixelDataToCanvasImageData.js");n.d(t,"storedPixelDataToCanvasImageData",function(){return K.default});var Q=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataColorLUT",function(){return Q.default});var $=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataPseudocolorLUT",function(){return $.default});var ee=n("./triggerEvent.js");n.d(t,"triggerEvent",function(){return ee.default});var te=n("./updateImage.js");n.d(t,"updateImage",function(){return te.default});var ne=n("./webgl/index.js");n.d(t,"webGL",function(){return ne.default}),t.default={drawImage:p.default,generateLut:j.default,getDefaultViewport:w.default,requestAnimationFrame:q.default,storedPixelDataToCanvasImageData:K.default,storedColorPixelDataToCanvasImageData:Z.default,storedPixelDataToCanvasImageDataColorLUT:Q.default,storedPixelDataToCanvasImageDataPseudocolorLUT:$.default,internal:P.default,renderLabelMapImage:F.renderLabelMapImage,renderPseudoColorImage:U.renderPseudoColorImage,renderColorImage:B.renderColorImage,renderGrayscaleImage:H.renderGrayscaleImage,renderWebImage:V.renderWebImage,renderToCanvas:N.default,canvasToPixel:f.default,disable:g.default,displayImage:h.default,draw:v.default,drawInvalidated:b.default,enable:y.default,getElementData:s.getElementData,removeElementData:s.removeElementData,getEnabledElement:r.getEnabledElement,addEnabledElement:r.addEnabledElement,getEnabledElementsByImageId:r.getEnabledElementsByImageId,getEnabledElements:r.getEnabledElements,addLayer:o.addLayer,removeLayer:o.removeLayer,getLayer:o.getLayer,getLayers:o.getLayers,getVisibleLayers:o.getVisibleLayers,setActiveLayer:o.setActiveLayer,getActiveLayer:o.getActiveLayer,purgeLayers:o.purgeLayers,setLayerImage:o.setLayerImage,fitToWindow:x.default,getDefaultViewportForImage:T.default,getDisplayedArea:E.default,setDefaultViewport:Y.default,getImage:O.default,getPixels:C.default,getStoredPixels:M.default,getViewport:I.default,loadImage:l.loadImage,loadAndCacheImage:l.loadAndCacheImage,registerImageLoader:l.registerImageLoader,registerUnknownImageLoader:l.registerUnknownImageLoader,invalidate:D.default,invalidateImageId:_.default,pageToPixel:k.default,pixelToCanvas:R.default,reset:W.default,resize:G.default,setToPixelCoordinateSystem:X.default,setViewport:J.default,updateImage:te.default,pixelDataToFalseColorData:A.default,rendering:z.default,imageCache:S.default,metaData:L.default,webGL:ne.default,colors:m.default,convertImageToFalseColorImage:i.convertImageToFalseColorImage,convertToFalseColorImage:i.convertToFalseColorImage,restoreImage:i.restoreImage,EVENTS:a.default,events:a.events,triggerEvent:ee.default,imageLoadPoolManager:u.default,imageRetrievalPoolManager:d.default,RequestPoolManager:c.RequestPoolManager}},"./internal/calculateTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/transform.js"),r=n("./internal/getDisplayedArea.js");t.default=function(e,t){var n=new a.Transform;n.translate(e.canvas.width/2,e.canvas.height/2);var o=e.viewport.rotation;0!==o&&n.rotate(o*Math.PI/180);var i=e.viewport.scale,s=e.viewport.scale,l=Object(r.default)(e.image,e.viewport),u=l.tlhc.x-1,d=l.tlhc.y-1,c=l.brhc.x-u,f=l.brhc.y-d;return"NONE"===l.presentationSizeMode?e.image.rowPixelSpacing<e.image.columnPixelSpacing?i*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(s*=e.image.rowPixelSpacing/e.image.columnPixelSpacing):(i=l.columnPixelSpacing,s=l.rowPixelSpacing,"SCALE TO FIT"===l.presentationSizeMode&&(i=s=Math.min(e.canvas.width/(c*i),e.canvas.height/(f*s)),l.rowPixelSpacing<l.columnPixelSpacing?i*=l.columnPixelSpacing/l.rowPixelSpacing:l.columnPixelSpacing<l.rowPixelSpacing&&(s*=l.rowPixelSpacing/l.columnPixelSpacing))),n.scale(i,s),0!==o&&n.rotate(-o*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==o&&n.rotate(o*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-c/2,-f/2),n.translate(-u,-d),n}},"./internal/computeAutoVoi.js":function(e,t,n){"use strict";function a(e,t){if(!function(e){return e.voiLUT&&e.voiLUT.lut&&e.voiLUT.lut.length>0||void 0!==e.voi.windowWidth&&void 0!==e.voi.windowCenter}(e)){var n=t.maxPixelValue*t.slope+t.intercept,a=t.minPixelValue*t.slope+t.intercept,r=n-a,o=(n+a)/2;void 0===e.voi?e.voi={windowWidth:r,windowCenter:o}:(e.voi.windowWidth=r,e.voi.windowCenter=o)}}n.r(t),n.d(t,"default",function(){return a})},"./internal/createViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/setDefaultViewport.js");t.default=function(){return Object.assign({},{scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:void 0},a.state.viewport)}},"./internal/drawCompositeImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./layers.js"),r=n("./rendering/renderGrayscaleImage.js"),o=n("./rendering/renderColorImage.js"),i=n("./rendering/renderPseudoColorImage.js"),s=n("./rendering/renderLabelMapImage.js"),l=n("./setToPixelCoordinateSystem.js"),u=n("./internal/getDisplayedArea.js");function d(e){var t=e.syncProps||{};t.originalScale=e.viewport.scale,e.syncProps=t}t.default=function(e,t){var n=e.element,c=Object(a.getLayers)(n),f=Object(a.getActiveLayer)(n),m=Object(a.getVisibleLayers)(n),g=!e.lastSyncViewportsState&&e.syncViewports;e.lastSyncViewportsState=e.syncViewports,g&&c.forEach(function(e){e.viewport&&d(e)}),!0===e.syncViewports&&function(e,t){e.forEach(function(e){if(e!==t&&e.viewport&&t.viewport){e.syncProps||d(e);var n,a,r=(a=e,(n=t).syncProps||d(n),a.syncProps||d(a),a.syncProps.originalScale/n.syncProps.originalScale);e.viewport.scale=t.viewport.scale*r,e.viewport.rotation=t.viewport.rotation,e.viewport.translation={x:t.viewport.translation.x/r,y:t.viewport.translation.y/r},e.viewport.hflip=t.viewport.hflip,e.viewport.vflip=t.viewport.vflip}})}(m,f);var h=e.canvas.getContext("2d",{desynchronized:!0});h.setTransform(1,0,0,1,0,0),h.fillStyle="black",h.fillRect(0,0,e.canvas.width,e.canvas.height),function(e,t,n){t.forEach(function(t,a){if(t.image){e.save(),t.canvas=e.canvas,Object(l.default)(t,e);var d=t.viewport.colormap||t.options.colormap,c=t.invalid||n;if(d&&""!==d&&!0===t.viewport.labelmap)Object(s.addLabelMapLayer)(t,c);else if(d&&""!==d)Object(i.addPseudoColorLayer)(t,c);else if(!0===t.image.color)Object(o.addColorLayer)(t,c);else{var f=0===a;Object(r.addGrayscaleLayer)(t,c,f)}e.globalAlpha=t.options&&t.options.opacity?t.options.opacity:1,t.options&&t.options.fillStyle&&(e.fillStyle=t.options.fillStyle),e.imageSmoothingEnabled=!t.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled;var m=Object(u.default)(t.image,t.viewport),g=m.tlhc.x-1,h=m.tlhc.y-1,v=m.brhc.x-g,p=m.brhc.y-h;e.drawImage(t.canvas,g,h,v,p,g,h,v,p),e.restore(),t.invalid=!1}})}(h,m,t)}},"./internal/drawImage.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.needsRedraw=!0,t&&(e.invalid=!0)}},"./internal/drawImageSync.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js"),r=n("./internal/drawCompositeImage.js"),o=n("./rendering/renderColorImage.js"),i=n("./rendering/renderGrayscaleImage.js"),s=n("./rendering/renderPseudoColorImage.js"),l=n("./rendering/renderLabelMapImage.js"),u=n("./triggerEvent.js"),d=n("./events.js");t.default=function(e,t){var n=e.image,c=e.element,f=e.layers||[];if(e.canvas&&e.image){var m=Object(a.default)();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},f&&f.length)Object(r.default)(e,t);else if(n){var g=n.render;g||(g=e.viewport.colormap&&""!==e.viewport.colormap&&!0===e.image.labelmap?l.renderLabelMapImage:e.viewport.colormap&&""!==e.viewport.colormap?s.renderPseudoColorImage:n.color?o.renderColorImage:i.renderGrayscaleImage),g(e,t)}var h=Object(a.default)()-m,v={viewport:e.viewport,element:c,image:n,enabledElement:e,canvasContext:e.canvas.getContext("2d",{desynchronized:!0}),renderTimeInMs:h};n.stats.lastRenderTime=h,e.invalid=!1,e.needsRedraw=!1,Object(u.default)(c,d.default.IMAGE_RENDERED,v)}}},"./internal/generateColorLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getVOILut.js");t.default=function(e,t,n,r,o){var i=e.maxPixelValue,s=e.minPixelValue,l=Math.min(s,0);if(void 0===e.cachedLut){var u=i-l+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(u)}var d=e.cachedLut.lutArray,c=Object(a.default)(t,n,o);if(!0===r)for(var f=s;f<=i;f++)d[f+-l]=255-c(f);else for(var m=s;m<=i;m++)d[m+-l]=c(m);return d}},"./internal/generateLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getModalityLUT.js"),r=n("./internal/getVOILut.js");t.default=function(e,t,n,o,i,s){var l=e.maxPixelValue,u=e.minPixelValue,d=Math.min(u,0);if(void 0===e.cachedLut){var c=l-d+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(c)}var f=e.cachedLut.lutArray,m=Boolean(e.slope%1)||Boolean(e.intercept%1),g=Object(a.default)(e.slope,e.intercept,i),h=Object(r.default)(t,n,s,m);if(!0===o)for(var v=u;v<=l;v++)f[v+-d]=255-h(g(v));else for(var p=u;p<=l;p++)f[p+-d]=h(g(p));return f}},"./internal/getCanvas.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a="cornerstone-canvas";function r(e){var t="canvas.".concat(a);return e.querySelector(t)||function(e){var t=document.createElement("canvas");return t.style.display="block",t.classList.add(a),e.appendChild(t),t}(e)}},"./internal/getDefaultViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/createViewport.js"),r=n("./internal/getImageFitScale.js");t.default=function(e,t){if(void 0===e)throw new Error("getDefaultViewport: parameter canvas must not be undefined");return void 0===t?Object(a.default)():{scale:Object(r.default)(e,t,0).scaleFactor,translation:{x:0,y:0},voi:{windowWidth:t.windowWidth,windowCenter:t.windowCenter},invert:t.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT,colormap:t.colormap,labelmap:Boolean(t.labelmap),displayedArea:void 0}}},"./internal/getDisplayedArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&t.displayedArea)return t.displayedArea;if(void 0===e)throw new Error("getDisplayedArea: parameter image must not be undefined");return{tlhc:{x:1,y:1},brhc:{x:e.columns,y:e.rows},rowPixelSpacing:void 0===e.rowPixelSpacing?1:e.rowPixelSpacing,columnPixelSpacing:void 0===e.columnPixelSpacing?1:e.columnPixelSpacing,presentationSizeMode:"NONE"}}},"./internal/getFillStyle.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=(e.viewport||{}).invert;return-1!==["black","white"].indexOf((e.options||{}).fillStyle)&&t?"white":"black"}},"./internal/getImageFitScale.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js"),r=n("./internal/getImageSize.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(a.validateParameterUndefinedOrNull)(e,"getImageScale: parameter windowSize must not be undefined"),Object(a.validateParameterUndefinedOrNull)(t,"getImageScale: parameter image must not be undefined");var o=Object(r.default)(t,n),i=t.rowPixelSpacing||1,s=t.columnPixelSpacing||1,l=1,u=1;i<s?u=s/i:l=i/s;var d=e.height/o.height/l,c=e.width/o.width/u;return{verticalScale:d,horizontalScale:c,scaleFactor:Math.min(c,d)}}},"./internal/getImageSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js");function r(e){return!(null==e||0===e||180===e)}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(a.validateParameterUndefinedOrNull)(e,"getImageSize: parameter image must not be undefined"),Object(a.validateParameterUndefinedOrNull)(e.width,"getImageSize: parameter image must have width"),Object(a.validateParameterUndefinedOrNull)(e.height,"getImageSize: parameter image must have height"),r(t)?{height:e.width,width:e.height}:{width:e.width,height:e.height}}},"./internal/getModalityLUT.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return n?function(e){var t=e.lut[0],n=e.lut[e.lut.length-1],a=e.firstValueMapped+e.lut.length;return function(r){return r<e.firstValueMapped?t:r>=a?n:e.lut[r]}}(n):function(e,t){return function(n){return n*e+t}}(e,t)}},"./internal/getTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e){return Object(a.default)(e)}},"./internal/getVOILut.js":function(e,t,n){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n.r(t),t.default=function(e,t,n,r){return n?function(e,t){var n,r=Math.max.apply(Math,(n=e.lut,function(e){if(Array.isArray(e))return a(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).toString(2).length-8,o=e.lut[0]>>r,i=e.lut[e.lut.length-1]>>r,s=e.firstValueMapped+e.lut.length-1;return function(n){return n<e.firstValueMapped?o:n>=s?i:t?e.lut[Math.round(n)-e.firstValueMapped]>>r:e.lut[n-e.firstValueMapped]>>r}}(n,r):function(e,t){return function(n){return 255*((n-t)/e+.5)}}(e,t)}},"./internal/guid.js":function(e,t,n){"use strict";function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.r(t),t.default=function(){return"".concat(a()+a(),"-").concat(a(),"-").concat(a(),"-").concat(a(),"-").concat(a()).concat(a()).concat(a())}},"./internal/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/transform.js"),r=n("./internal/calculateTransform.js"),o=n("./internal/drawImage.js"),i=n("./internal/generateLut.js"),s=n("./internal/getDefaultViewport.js"),l=n("./internal/getTransform.js"),u=n("./internal/requestAnimationFrame.js"),d=n("./internal/setDefaultViewport.js"),c=n("./internal/storedColorPixelDataToCanvasImageData.js"),f=n("./internal/storedPixelDataToCanvasImageData.js"),m=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),g=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),h=n("./internal/storedPixelDataToCanvasImageDataRGBA.js");t.default={drawImage:o.default,generateLut:i.default,getDefaultViewport:s.default,requestAnimationFrame:u.default,setDefaultViewport:d.default,storedPixelDataToCanvasImageData:f.default,storedPixelDataToCanvasImageDataRGBA:h.default,storedPixelDataToCanvasImageDataColorLUT:m.default,storedPixelDataToCanvasImageDataPseudocolorLUT:g.default,storedColorPixelDataToCanvasImageData:c.default,getTransform:l.default,calculateTransform:r.default,Transform:a.Transform}},"./internal/now.js":function(e,t,n){"use strict";n.r(t),t.default=function(){return window.performance?performance.now():Date.now()}},"./internal/requestAnimationFrame.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return window.requestAnimationFrame(e)||window.webkitRequestAnimationFrame(e)||window.mozRequestAnimationFrame(e)||window.oRequestAnimationFrame(e)||window.msRequestAnimationFrame(e)||function(e){window.setTimeout(e,1e3/60)}(e)}},"./internal/setDefaultViewport.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",function(){return a});var a={viewport:{}};t.default=function(e){a.viewport=e||{}}},"./internal/storedColorPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=e.minPixelValue,s=0,l=0,u=o.length;if(r=Object(a.default)(),i<0)for(;l<u;)n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s]=t[o[l]+-i],l+=2,s+=2;else for(;l<u;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s]=t[o[l]],l+=2,s+=2;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=o.length,s=e.minPixelValue,l=3,u=0;if(r=Object(a.default)(),o instanceof Int16Array)if(s<0)for(;u<i;)n[l]=t[o[u++]+-s],l+=4;else for(;u<i;)n[l]=t[o[u++]],l+=4;else if(o instanceof Uint16Array)for(;u<i;)n[l]=t[o[u++]],l+=4;else if(s<0)for(;u<i;)n[l]=t[o[u++]+-s],l+=4;else for(;u<i;)n[l]=t[o[u++]],l+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedPixelDataToCanvasImageDataColorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),r=n("./internal/now.js");t.default=function(e,t,n){var o=Object(r.default)(),i=e.getPixelData();e.stats.lastGetPixelDataTime=Object(r.default)()-o;var s,l,u=i.length,d=e.minPixelValue,c=0,f=0;if(o=Object(r.default)(),l=t instanceof a.default.LookupTable?t.Table:t,d<0)for(;f<u;)s=l[i[f++]+-d],n[c++]=s[0],n[c++]=s[1],n[c++]=s[2],n[c++]=s[3];else for(;f<u;)s=l[i[f++]],n[c++]=s[0],n[c++]=s[1],n[c++]=s[2],n[c++]=s[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-o}},"./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),r=n("./internal/now.js");t.default=function(e,t,n,o){var i=Object(r.default)(),s=e.getPixelData();e.stats.lastGetPixelDataTime=Object(r.default)()-i;var l,u,d,c=s.length,f=e.minPixelValue,m=0,g=0;if(i=Object(r.default)(),d=n instanceof a.default.LookupTable?n.Table:n,f<0)for(;g<c;)l=t[s[g++]+-f],o[m++]=(u=d[l])[0],o[m++]=u[1],o[m++]=u[2],o[m++]=u[3];else for(;g<c;)l=t[s[g++]],o[m++]=(u=d[l])[0],o[m++]=u[1],o[m++]=u[2],o[m++]=u[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-i}},"./internal/storedPixelDataToCanvasImageDataRGBA.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i,s=o.length,l=e.minPixelValue,u=0,d=0;if(r=Object(a.default)(),o instanceof Int16Array)if(l<0)for(;d<s;)i=t[o[d++]+-l],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;d<s;)i=t[o[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(o instanceof Uint16Array)for(;d<s;)i=t[o[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(l<0)for(;d<s;)i=t[o[d++]+-l],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;d<s;)i=t[o[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedRGBAPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=e.minPixelValue,s=0,l=0,u=o.length;if(r=Object(a.default)(),i<0)for(;l<u;)n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s++]=o[l++];else for(;l<u;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=o[l++];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/transform.js":function(e,t,n){"use strict";n.r(t),n.d(t,"Transform",function(){return a});var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}var t;return(t=[{key:"reset",value:function(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function(){var t=new e;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}},{key:"multiply",value:function(e){var t=this.m[1]*e.m[0]+this.m[3]*e.m[1],n=this.m[0]*e.m[2]+this.m[2]*e.m[3],a=this.m[1]*e.m[2]+this.m[3]*e.m[3],r=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],o=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];this.m[0]=this.m[0]*e.m[0]+this.m[2]*e.m[1],this.m[1]=t,this.m[2]=n,this.m[3]=a,this.m[4]=r,this.m[5]=o}},{key:"invert",value:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=-this.m[1]*e,n=-this.m[2]*e,a=this.m[0]*e,r=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*e,this.m[1]=t,this.m[2]=n,this.m[3]=a,this.m[4]=r,this.m[5]=o}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),a=this.m[1]*t+this.m[3]*n,r=this.m[0]*-n+this.m[2]*t,o=this.m[1]*-n+this.m[3]*t;this.m[0]=this.m[0]*t+this.m[2]*n,this.m[1]=a,this.m[2]=r,this.m[3]=o}},{key:"translate",value:function(e,t){this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t}},{key:"scale",value:function(e,t){this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t}},{key:"transformPoint",value:function(e,t){var n=e;return{x:e=n*this.m[0]+t*this.m[2]+this.m[4],y:t=n*this.m[1]+t*this.m[3]+this.m[5]}}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}()},"./internal/tryEnableWebgl.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/index.js");t.default=function(e){return a.default.renderer.isWebGLAvailable()?(a.default.renderer.initRenderer(),e.renderer="webgl",e.desynchronized=!0,e.preserveDrawingBuffer=!0,!0):(console.error("WebGL not available, falling back to Canvas renderer"),delete e.renderer,delete e.preserveDrawingBuffer,!1)}},"./internal/validator.js":function(e,t,n){"use strict";function a(e,t){if(void 0===e)throw new Error(t)}function r(e,t){if(null==e)throw new Error(t)}n.r(t),n.d(t,"validateParameterUndefined",function(){return a}),n.d(t,"validateParameterUndefinedOrNull",function(){return r})},"./invalidate.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./triggerEvent.js"),o=n("./events.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);t.invalid=!0,t.needsRedraw=!0;var n={element:e};Object(r.default)(e,o.default.INVALIDATED,n)}},"./invalidateImageId.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){Object(a.getEnabledElementsByImageId)(e).forEach(function(e){Object(r.default)(e,!0)})}},"./layers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rescaleImage",function(){return c}),n.d(t,"addLayer",function(){return f}),n.d(t,"removeLayer",function(){return m}),n.d(t,"getLayer",function(){return g}),n.d(t,"getLayers",function(){return h}),n.d(t,"getVisibleLayers",function(){return v}),n.d(t,"setActiveLayer",function(){return p}),n.d(t,"setLayerImage",function(){return b}),n.d(t,"getActiveLayer",function(){return y}),n.d(t,"purgeLayers",function(){return x});var a=n("./internal/guid.js"),r=n("./enabledElements.js"),o=n("./internal/getDefaultViewport.js"),i=n("./internal/getDisplayedArea.js"),s=n("./updateImage.js"),l=n("./triggerEvent.js"),u=n("./events.js");function d(e,t,n){var a=t.element,r={viewport:t.viewport,element:t.element,image:t.image,enabledElement:t,layerId:n};Object(l.default)(a,e,r)}function c(e,t){if(e.layerId===t.layerId)throw new Error("rescaleImage: both arguments represent the same layer");var n=e.image,a=t.image;if(n.imageId&&a.imageId){var r=Object(i.default)(a,t.viewport),o=Object(i.default)(n,e.viewport);t.viewport.scale=e.viewport.scale*(t.viewport.scale/e.viewport.scale*(r.columnPixelSpacing*a.width/(o.columnPixelSpacing*n.width)))}}function f(e,t,n){var i,s=Object(a.default)(),l=Object(r.getEnabledElement)(e),f=l.layers;t&&(i=Object(o.default)(l.canvas,t),n&&n.viewport&&(i=Object.assign(i,n.viewport))),!1!==l.syncViewports&&(l.syncViewports=!0);var m={image:t,layerId:s,viewport:i,options:n||{},renderingTools:{}};return f.length&&t&&c(f[0],m),f.push(m),d(u.default.LAYER_ADDED,l,s),1===f.length&&t&&p(e,s),s}function m(e,t){var n=Object(r.getEnabledElement)(e),a=n.layers,o=n.layers.findIndex(function(e){return e.layerId===t});-1!==o&&(a.splice(o,1),t===n.activeLayerId&&a.length&&p(e,a[0].layerId),d(u.default.LAYER_REMOVED,n,t))}function g(e,t){return Object(r.getEnabledElement)(e).layers.find(function(e){return e.layerId===t})}function h(e){return Object(r.getEnabledElement)(e).layers}function v(e){return Object(r.getEnabledElement)(e).layers.filter(function(e){return e.options&&!1!==e.options.visible&&0!==e.options.opacity})}function p(e,t){var n=Object(r.getEnabledElement)(e);if(n.activeLayerId!==t){var a=n.layers.findIndex(function(e){return e.layerId===t});if(-1===a)throw new Error("setActiveLayer: layer not found in layers array");var o=n.layers[a];if(!o.image)throw new Error("setActiveLayer: layer with undefined image cannot be set as active.");n.activeLayerId=t,n.image=o.image,n.viewport=o.viewport,Object(s.default)(e),d(u.default.ACTIVE_LAYER_CHANGED,n,t)}}function b(e,t,n){var a,i=Object(r.getEnabledElement)(e),s=i.layers[0];if(!(a=n?g(e,n):y(e)))throw new Error("setLayerImage: Layer not found");if(a.image=t,t){if(!a.viewport){var l=Object(o.default)(i.canvas,t);a.options&&a.options.viewport&&(a.viewport=Object.assign(l,a.options.viewport)),s.layerId!==n&&c(s,a)}}else a.viewport=void 0}function y(e){var t=Object(r.getEnabledElement)(e);return t.layers.find(function(e){return e.layerId===t.activeLayerId})}function x(e){var t=Object(r.getEnabledElement)(e);t.layers=[],delete t.activeLayerId,delete t.lastSyncViewportsState}},"./metaData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addProvider",function(){return r}),n.d(t,"removeProvider",function(){return o});var a=[];function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(t=0;t<a.length&&!(a[t].priority<=n);t++);a.splice(t,0,{priority:n,provider:e})}function o(e){for(var t=0;t<a.length;t++)if(a[t].provider===e){a.splice(t,1);break}}t.default={addProvider:r,removeProvider:o,get:function(e,t){for(var n=0;n<a.length;n++){var r=a[n].provider(e,t);if(void 0!==r)return r}}}},"./pageToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t,n){var o=Object(a.getEnabledElement)(e);if(void 0===o.image)throw new Error("image has not been loaded yet");var i=e.getBoundingClientRect(),s={x:t-i.left-window.pageXOffset,y:n-i.top-window.pageYOffset},l=Object(r.default)(o);return l.invert(),l.transformPoint(s.x,s.y)}},"./pixelDataToFalseColorData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./colors/index.js");function r(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n,r,o=e.minPixelValue,i=0,s=0,l=e.width*e.height,u=e.origPixelData||e.getPixelData(),d=new Uint8Array(4*l);if(e.color=!0,e.falseColor=!0,e.origPixelData=u,t instanceof a.default.LookupTable)for(t.build();s<l;)n=u[s++],r=t.mapValue(n),d[i++]=r[0],d[i++]=r[1],d[i++]=r[2],d[i++]=r[3];else if(o<0)for(;s<l;)n=u[s++],d[i++]=t[n+-o][0],d[i++]=t[n+-o][1],d[i++]=t[n+-o][2],d[i++]=t[n+-o][3];else for(;s<l;)n=u[s++],d[i++]=t[n][0],d[i++]=t[n][1],d[i++]=t[n][2],d[i++]=t[n][3];e.rgba=!0,e.cachedLut=void 0,e.render=void 0,e.slope=1,e.intercept=0,e.minPixelValue=0,e.maxPixelValue=255,e.windowWidth=255,e.windowCenter=128,e.getPixelData=function(){return d}}},"./pixelToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(r.default)(n).transformPoint(t.x,t.y)}},"./rendering/doesImageNeedToBeRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.lastRenderedViewport;return t.imageId!==e.renderingTools.lastRenderedImageId||!n||n.windowCenter!==e.viewport.voi.windowCenter||n.windowWidth!==e.viewport.voi.windowWidth||n.invert!==e.viewport.invert||n.rotation!==e.viewport.rotation||n.hflip!==e.viewport.hflip||n.vflip!==e.viewport.vflip||n.modalityLUT!==e.viewport.modalityLUT||n.voiLUT!==e.viewport.voiLUT||n.colormap!==e.viewport.colormap}},"./rendering/getLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/computeAutoVoi.js"),r=n("./rendering/lutMatches.js"),o=n("./internal/generateLut.js");t.default=function(e,t,n){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&Object(r.default)(e.cachedLut.modalityLUT,t.modalityLUT)&&Object(r.default)(e.cachedLut.voiLUT,t.voiLUT)&&e.cachedLut.invert===t.invert&&!0!==n||(Object(a.default)(t,e),Object(o.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert,t.modalityLUT,t.voiLUT),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.voiLUT=t.voiLUT,e.cachedLut.modalityLUT=t.modalityLUT),e.cachedLut.lutArray}},"./rendering/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./rendering/renderColorImage.js"),r=n("./rendering/renderGrayscaleImage.js"),o=n("./rendering/renderWebImage.js"),i=n("./rendering/renderPseudoColorImage.js"),s=n("./rendering/renderLabelMapImage.js"),l=n("./rendering/renderToCanvas.js");t.default={colorImage:a.renderColorImage,grayscaleImage:r.renderGrayscaleImage,webImage:o.renderWebImage,pseudoColorImage:i.renderPseudoColorImage,labelMapImage:s.renderLabelMapImage,toCanvas:l.default}},"./rendering/initializeRenderCanvas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.renderCanvas;n.width=t.width,n.height=t.height;var a=n.getContext("2d",{desynchronized:!0});a.fillStyle="white",a.fillRect(0,0,n.width,n.height);var r=a.getImageData(0,0,t.width,t.height);e.renderingTools.renderCanvasContext=a,e.renderingTools.renderCanvasData=r}},"./rendering/lutMatches.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return!e&&!t||!(!e||!t)&&e.id===t.id}},"./rendering/renderColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderColorImage",function(){return h}),n.d(t,"addColorLayer",function(){return v});var a=n("./internal/now.js"),r=n("./internal/getFillStyle.js"),o=n("./internal/generateColorLut.js"),i=n("./internal/storedColorPixelDataToCanvasImageData.js"),s=n("./internal/storedRGBAPixelDataToCanvasImageData.js"),l=n("./setToPixelCoordinateSystem.js"),u=n("./webgl/index.js"),d=n("./rendering/doesImageNeedToBeRendered.js"),c=n("./rendering/initializeRenderCanvas.js"),f=n("./rendering/saveLastRendered.js"),m=n("./internal/getDisplayedArea.js");function g(e,t,n){e.renderingTools.renderCanvas&&!0===e.renderingTools.lastRenderedIsColor||(e.renderingTools.renderCanvas=document.createElement("canvas"));var r=e.renderingTools.renderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&t.getCanvas&&t.getCanvas())return t.getCanvas();if(!1===Object(d.default)(e,t)&&!0!==n)return r;r.width===t.width&&r.height===t.height||Object(c.default)(e,t);var l=Object(a.default)(),u=function(e,t){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&e.cachedLut.invert===t.invert||(Object(o.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert),e.cachedLut.lutArray}(t,e.viewport);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(a.default)()-l;var f=e.renderingTools.renderCanvasData,m=e.renderingTools.renderCanvasContext;return t.rgba?Object(s.default)(t,u,f.data):Object(i.default)(t,u,f.data),l=Object(a.default)(),m.putImageData(f,0,0),t.stats.lastPutImageDataTime=Object(a.default)()-l,r}function h(e,t){if(void 0===e)throw new Error("renderColorImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderColorImage: image must be loaded before it can be drawn");var a,o=e.canvas.getContext("2d",{desynchronized:!0});o.setTransform(1,0,0,1,0,0),o.fillStyle=Object(r.default)(e),o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(l.default)(e,o),a=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?u.default.renderer.render(e):g(e,n,t);var i=Object(m.default)(e.image,e.viewport),s=i.tlhc.x-1,d=i.tlhc.y-1,c=i.brhc.x-s,h=i.brhc.y-d;o.drawImage(a,s,d,c,h,s,d,c,h),e.renderingTools=Object(f.default)(e)}function v(e,t){if(void 0===e)throw new Error("addColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addColorLayer: image must be loaded before it can be drawn");n.rgba=!0,e.canvas=g(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(f.default)(e)}},"./rendering/renderGrayscaleImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderGrayscaleImage",function(){return h}),n.d(t,"addGrayscaleLayer",function(){return v});var a=n("./internal/getFillStyle.js"),r=n("./internal/storedPixelDataToCanvasImageData.js"),o=n("./internal/storedPixelDataToCanvasImageDataRGBA.js"),i=n("./setToPixelCoordinateSystem.js"),s=n("./internal/now.js"),l=n("./webgl/index.js"),u=n("./rendering/getLut.js"),d=n("./rendering/doesImageNeedToBeRendered.js"),c=n("./rendering/initializeRenderCanvas.js"),f=n("./rendering/saveLastRendered.js"),m=n("./internal/getDisplayedArea.js");function g(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&!i||(e.renderingTools.renderCanvas=document.createElement("canvas"),Object(c.default)(e,t));var l=e.renderingTools.renderCanvas;if(!1===Object(d.default)(e,t)&&!0!==n)return l;l.width===t.width&&l.height===t.height||Object(c.default)(e,t);var f=Object(s.default)(),m=Object(u.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(s.default)()-f;var g=e.renderingTools.renderCanvasData,h=e.renderingTools.renderCanvasContext;return a?Object(r.default)(t,m,g.data):Object(o.default)(t,m,g.data),f=Object(s.default)(),h.putImageData(g,0,0),t.stats.lastPutImageDataTime=Object(s.default)()-f,l}function h(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var r,o=e.canvas.getContext("2d",{desynchronized:!0});o.setTransform(1,0,0,1,0,0),o.fillStyle=Object(a.default)(e),o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(i.default)(e,o),r=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?l.default.renderer.render(e):g(e,n,t);var s=Object(m.default)(e.image,e.viewport),u=s.tlhc.x-1,d=s.tlhc.y-1,c=s.brhc.x-u,h=s.brhc.y-d;o.drawImage(r,u,d,c,h,u,d,c,h),e.renderingTools=Object(f.default)(e)}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw new Error("addGrayscaleLayer: layer parameter must not be undefined");var a=e.image;if(void 0===a)throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");e.canvas=g(e,a,t,n);var r=e.canvas.getContext("2d",{desynchronized:!0});r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,e.renderingTools=Object(f.default)(e)}},"./rendering/renderLabelMapImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderLabelMapImage",function(){return m}),n.d(t,"addLabelMapLayer",function(){return g});var a=n("./setToPixelCoordinateSystem.js"),r=n("./internal/now.js"),o=n("./internal/getFillStyle.js"),i=n("./rendering/initializeRenderCanvas.js"),s=n("./rendering/saveLastRendered.js"),l=n("./rendering/doesImageNeedToBeRendered.js"),u=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),d=n("./colors/index.js"),c=n("./internal/getDisplayedArea.js");function f(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,o=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),o&&"string"==typeof o&&(o=d.default.getColormap(o)),!o)throw new Error("renderLabelMapImage: colormap not found.");var s=o.getId();if(!1===Object(l.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===s)return a;a.width===t.width&&a.height===t.height||Object(i.default)(e,t);var c=Object(r.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===s||(e.renderingTools.colorLut=o.createLookupTable(),e.renderingTools.colormapId=s),t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(r.default)()-c;var f=e.renderingTools.colorLut,m=e.renderingTools.renderCanvasData,g=e.renderingTools.renderCanvasContext;return Object(u.default)(t,f,m.data),c=Object(r.default)(),g.putImageData(m,0,0),t.stats.lastPutImageDataTime=Object(r.default)()-c,a}function m(e,t){if(void 0===e)throw new Error("renderLabelMapImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderLabelMapImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d",{desynchronized:!0});r.setTransform(1,0,0,1,0,0),r.fillStyle=Object(o.default)(e),r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(a.default)(e,r);var i=f(e,n,t),l=Object(c.default)(e.image,e.viewport),u=l.tlhc.x-1,d=l.tlhc.y-1,m=l.brhc.x-u,g=l.brhc.y-d;r.drawImage(i,u,d,m,g,u,d,m,g),e.renderingTools=Object(s.default)(e)}function g(e,t){if(void 0===e)throw new Error("addLabelMapLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addLabelMapLayer: image must be loaded before it can be drawn");e.canvas=f(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(s.default)(e)}},"./rendering/renderPseudoColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderPseudoColorImage",function(){return g}),n.d(t,"addPseudoColorLayer",function(){return h});var a=n("./setToPixelCoordinateSystem.js"),r=n("./internal/now.js"),o=n("./internal/getFillStyle.js"),i=n("./rendering/initializeRenderCanvas.js"),s=n("./rendering/getLut.js"),l=n("./rendering/saveLastRendered.js"),u=n("./rendering/doesImageNeedToBeRendered.js"),d=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),c=n("./colors/index.js"),f=n("./internal/getDisplayedArea.js");function m(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,o=e.viewport.colormap||e.options.colormap;if(e.options&&e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),o&&"string"==typeof o&&(o=c.default.getColormap(o)),!o)throw new Error("renderPseudoColorImage: colormap not found.");var l=o.getId();if(!1===Object(u.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===l)return a;a.width===t.width&&a.height===t.height||Object(i.default)(e,t);var f=Object(r.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===l||(o.setNumberOfColors(256),e.renderingTools.colorLut=o.createLookupTable(),e.renderingTools.colormapId=l);var m=Object(s.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(r.default)()-f;var g=e.renderingTools.colorLut,h=e.renderingTools.renderCanvasData,v=e.renderingTools.renderCanvasContext;return Object(d.default)(t,m,g,h.data),f=Object(r.default)(),v.putImageData(h,0,0),t.stats.lastPutImageDataTime=Object(r.default)()-f,a}function g(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d",{desynchronized:!0});r.setTransform(1,0,0,1,0,0),r.fillStyle=Object(o.default)(e),r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(a.default)(e,r);var i=m(e,n,t),s=Object(f.default)(e.image,e.viewport),u=s.tlhc.x-1,d=s.tlhc.y-1,c=s.brhc.x-u,g=s.brhc.y-d;r.drawImage(i,u,d,c,g,u,d,c,g),e.renderingTools=Object(l.default)(e)}function h(e,t){if(void 0===e)throw new Error("addPseudoColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addPseudoColorLayer: image must be loaded before it can be drawn");e.canvas=m(e,n,t);var a=e.canvas.getContext("2d",{desynchronized:!0});a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(l.default)(e)}},"./rendering/renderToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./triggerEvent.js"),r=n("./events.js"),o=n("./internal/drawImageSync.js"),i=n("./internal/getDefaultViewport.js"),s=n("./internal/tryEnableWebgl.js");function l(e,t,n,a){return{element:e,canvas:e,image:t,invalid:!0,needsRedraw:!0,options:n,layers:[],data:{},renderingTools:{},viewport:a}}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===e)throw new Error("renderToCanvas: parameter canvas cannot be undefined");u&&u.renderer&&"webgl"===u.renderer.toLowerCase()&&Object(s.default)(u);var d=Object(i.default)(e,t);n&&Object.assign(d,n);var c=l(e,t,u,d),f={enabledElement:c,timestamp:Date.now()};Object(a.default)(c.element,r.default.PRE_RENDER,f),Object(o.default)(c,c.invalid)}},"./rendering/renderWebImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderWebImage",function(){return i});var a=n("./setToPixelCoordinateSystem.js"),r=n("./rendering/renderColorImage.js"),o=n("./internal/getDisplayedArea.js");function i(e,t){if(void 0===e)throw new Error("renderWebImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderWebImage: image must be loaded before it can be drawn");if(e.viewport.voi.windowWidth===e.image.windowWidth&&e.viewport.voi.windowCenter===e.image.windowCenter&&!1===e.viewport.invert){var i=e.canvas.getContext("2d",{desynchronized:!0});i.setTransform(1,0,0,1,0,0),i.fillStyle="black",i.fillRect(0,0,e.canvas.width,e.canvas.height),i.imageSmoothingEnabled=!e.viewport.pixelReplication,i.mozImageSmoothingEnabled=i.imageSmoothingEnabled,Object(a.default)(e,i);var s=Object(o.default)(e.image,e.viewport),l=s.tlhc.x-1,u=s.tlhc.y-1,d=s.brhc.x-l,c=s.brhc.y-u;i.drawImage(n.getImage(),l,u,d,c,l,u,d,c)}else Object(r.renderColorImage)(e,t)}},"./rendering/saveLastRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.viewport,n=e.image.color;return e.renderingTools.lastRenderedImageId=e.image.imageId,e.renderingTools.lastRenderedIsColor=n,e.renderingTools.lastRenderedViewport={windowCenter:t.voi.windowCenter,windowWidth:t.voi.windowWidth,invert:t.invert,rotation:t.rotation,hflip:t.hflip,vflip:t.vflip,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT,colormap:t.colormap},e.renderingTools}},"./requestPool/RequestPoolManager.ts":function(e,t,n){"use strict";function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"RequestPoolManager",function(){return i});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"requestPool",void 0),o(this,"awake",void 0),o(this,"numRequests",void 0),o(this,"maxNumRequests",void 0),o(this,"grabDelay",void 0),o(this,"timeoutHandle",void 0),this.requestPool={interaction:{0:[]},thumbnail:{0:[]},prefetch:{0:[]}},this.awake=!1,this.grabDelay=5,this.numRequests={interaction:0,thumbnail:0,prefetch:0},this.maxNumRequests={interaction:6,thumbnail:6,prefetch:5}}var t;return(t=[{key:"destroy",value:function(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}},{key:"addRequest",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o={requestFn:e,type:t,additionalDetails:n};void 0===this.requestPool[t][a]&&(this.requestPool[t][a]=[]),r?this.requestPool[t][a].unshift(o):this.requestPool[t][a].push(o),this.awake||(this.awake=!0,this.startGrabbing())}},{key:"filterRequests",value:function(e){var t=this;Object.keys(this.requestPool).forEach(function(n){var a=t.requestPool[n];Object.keys(a).forEach(function(t){a[t]=a[t].filter(function(t){return e(t)})})})}},{key:"clearRequestStack",value:function(e){if(!this.requestPool[e])throw new Error("No category for the type ".concat(e," found"));this.requestPool[e]={0:[]}}},{key:"sendRequest",value:function(e){var t=this,n=e.requestFn,a=e.type;this.numRequests[a]++,this.awake=!0,n().finally(function(){t.numRequests[a]--,t.startAgain()})}},{key:"startGrabbing",value:function(){for(var e=this.maxNumRequests.interaction+this.maxNumRequests.thumbnail+this.maxNumRequests.prefetch-(this.numRequests.interaction+this.numRequests.thumbnail+this.numRequests.prefetch),t=0;t<e;t++){var n=this.getNextRequest();if(!1===n)break;n&&this.sendRequest(n)}}},{key:"startAgain",value:function(){var e=this;this.awake&&(this.grabDelay?this.timeoutHandle=window.setTimeout(function(){e.startGrabbing()},this.grabDelay):this.startGrabbing())}},{key:"getSortedPriorityGroups",value:function(e){var t=this;return Object.keys(this.requestPool[e]).map(Number).filter(function(n){return t.requestPool[e][n].length}).sort()}},{key:"getNextRequest",value:function(){var e,t=this.getSortedPriorityGroups("interaction"),n=a(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(this.requestPool.interaction[r].length&&this.numRequests.interaction<this.maxNumRequests.interaction)return this.requestPool.interaction[r].shift()}}catch(m){n.e(m)}finally{n.f()}var o,i=this.getSortedPriorityGroups("thumbnail"),s=a(i);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(this.requestPool.thumbnail[l].length&&this.numRequests.thumbnail<this.maxNumRequests.thumbnail)return this.requestPool.thumbnail[l].shift()}}catch(m){s.e(m)}finally{s.f()}var u,d=this.getSortedPriorityGroups("prefetch"),c=a(d);try{for(c.s();!(u=c.n()).done;){var f=u.value;if(this.requestPool.prefetch[f].length&&this.numRequests.prefetch<this.maxNumRequests.prefetch)return this.requestPool.prefetch[f].shift()}}catch(m){c.e(m)}finally{c.f()}return t.length||i.length||d.length||(this.awake=!1),!1}},{key:"getRequestPool",value:function(){return this.requestPool}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}()},"./requestPool/imageLoadPoolManager.ts":function(e,t,n){"use strict";n.r(t);var a=new(n("./requestPool/RequestPoolManager.ts").RequestPoolManager);a.maxNumRequests={interaction:1e3,thumbnail:1e3,prefetch:1e3},a.grabDelay=0,t.default=a},"./requestPool/imageRetrievalPoolManager.ts":function(e,t,n){"use strict";n.r(t);var a=new(n("./requestPool/RequestPoolManager.ts").RequestPoolManager);a.maxNumRequests={interaction:20,thumbnail:20,prefetch:20},a.grabDelay=0,t.default=a},"./reset.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getDefaultViewport.js"),r=n("./enabledElements.js"),o=n("./updateImage.js");t.default=function(e){var t=Object(r.getEnabledElement)(e);t.viewport=Object(a.default)(t.canvas,t.image),Object(o.default)(e)}},"./resize.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./fitToWindow.js"),o=n("./updateImage.js"),i=n("./triggerEvent.js"),s=n("./internal/getImageSize.js"),l=n("./events.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),u=n.canvas.width,d=n.canvas.height;!function(e,t){t.width!==e.clientWidth&&(t.width=e.clientWidth,t.style.width="".concat(e.clientWidth,"px")),t.height!==e.clientHeight&&(t.height=e.clientHeight,t.style.height="".concat(e.clientHeight,"px"))}(e,n.canvas);var c={element:e};Object(i.default)(e,l.default.ELEMENT_RESIZED,c),void 0!==n.image&&(t||function(e,t,n){var a=e.viewport.scale,r=Object(s.default)(e.image,e.viewport.rotation),o=Math.round(r.width*a),i=Math.round(r.height*a);return o===t&&i<=n||o<=t&&i===n&&0===e.viewport.translation.x&&0===e.viewport.translation.y}(n,u,d)?Object(r.default)(e):(function(e,t,n){var a=e.viewport.scale,r=Math.sqrt(e.canvas.width/t*(e.canvas.height/n));e.viewport.scale=r*a}(n,u,d),Object(o.default)(e)))}},"./setToPixelCoordinateSystem.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e,t,n){if(void 0===e)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");var r=Object(a.default)(e,n);t.setTransform(r.m[0],r.m[1],r.m[2],r.m[3],r.m[4],r.m[5])}},"./setViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getDefaultViewport.js"),r=n("./enabledElements.js"),o=n("./updateImage.js");t.default=function(e,t){var n=Object(r.getEnabledElement)(e);if(void 0===n.viewport&&(n.viewport=Object(a.default)(n.canvas)),t)for(var i in t)null!==t[i]&&(n.viewport[i]=t[i]);n.viewport.voi.windowWidth&&(n.viewport.voi.windowWidth=Math.max(n.viewport.voi.windowWidth,1e-6)),n.viewport.scale&&(n.viewport.scale=Math.max(n.viewport.scale,1e-4)),n.viewport.rotation%=360,n.viewport.rotation<0&&(n.viewport.rotation+=360),n.image&&Object(o.default)(e)}},"./triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./updateImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.getEnabledElement)(e);Object(r.default)(n,t)}},"./webgl/createProgramFromString.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.createShader(n);if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost()){var r=e.getShaderInfoLog(a);console.error("Could not compile shader:\n".concat(r))}return a}n.r(t),t.default=function(e,t,n){return function(e,t,n){var a=e.createProgram();if(e.attachShader(a,t),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS)&&!e.isContextLost()){var r=e.getProgramInfoLog(a);console.error("WebGL program filed to link:\n".concat(r))}return a}(e,a(e,t,e.VERTEX_SHADER),a(e,n,e.FRAGMENT_SHADER))}},"./webgl/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/renderer.js"),r=n("./webgl/createProgramFromString.js"),o=n("./webgl/textureCache.js"),i={createProgramFromString:r.default,renderer:{render:a.render,initRenderer:a.initRenderer,getRenderCanvas:a.getRenderCanvas,isWebGLAvailable:a.isWebGLAvailable},textureCache:o.default};Object.defineProperty(i,"isWebGLInitialized",{enumerable:!0,configurable:!1,get:function(){return a.isWebGLInitialized}}),t.default=i},"./webgl/renderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isWebGLInitialized",function(){return c}),n.d(t,"getRenderCanvas",function(){return f}),n.d(t,"initRenderer",function(){return m}),n.d(t,"render",function(){return p}),n.d(t,"isWebGLAvailable",function(){return b});var a,r,o,i=n("./webgl/shaders/index.js"),s=n("./webgl/vertexShader.js"),l=n("./webgl/textureCache.js"),u=n("./webgl/createProgramFromString.js"),d=document.createElement("canvas"),c=!1;function f(){return d}function m(){!0!==c&&function(e){a=null;try{var t={desynchronized:!0,preserveDrawingBuffer:!0};a=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),e.removeEventListener("webglcontextlost",g,!1),e.addEventListener("webglcontextlost",g,!1),e.removeEventListener("webglcontextrestored",h,!1),e.addEventListener("webglcontextrestored",h,!1)}catch(n){throw new Error("Error creating WebGL context")}return a||(console.error("Unable to initialize WebGL. Your browser may not support it."),a=null),a}(d)&&(o=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,o),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),r=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,r),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),function(){for(var e in i.shaders){var t=i.shaders[e];t.attributes={},t.uniforms={},t.vert=s.vertexShader,t.program=Object(u.default)(a,t.vert,t.frag),t.attributes.texCoordLocation=a.getAttribLocation(t.program,"a_texCoord"),a.enableVertexAttribArray(t.attributes.texCoordLocation),t.attributes.positionLocation=a.getAttribLocation(t.program,"a_position"),a.enableVertexAttribArray(t.attributes.positionLocation),t.uniforms.resolutionLocation=a.getUniformLocation(t.program,"u_resolution")}}(),c=!0)}function g(e){e.preventDefault(),console.warn("WebGL Context Lost!")}function h(e){e.preventDefault(),c=!1,l.default.purgeCache(),m()}function v(e){if(e.color)return"rgb";var t=e.getPixelData();return t instanceof Int16Array?"int16":t instanceof Uint16Array?"uint16":t instanceof Int8Array?"int8":"uint8"}function p(e){var t=e.image;d.width=t.width,d.height=t.height;var n=e.viewport,s=function(e){var t=v(e);return i.shaders.hasOwnProperty(t)?i.shaders[t]:i.shaders.rgb}(t),u=function(e){var t=l.default.getImageTexture(e.imageId);return t||(t=function(e){var t={uint8:a.LUMINANCE,int8:a.LUMINANCE_ALPHA,uint16:a.LUMINANCE_ALPHA,int16:a.RGB,rgb:a.RGB},n=v(e),r=t[n],o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_ALIGNMENT,1);var s=i.dataUtilities[n].storedPixelDataToImageData(e,e.width,e.height);return a.texImage2D(a.TEXTURE_2D,0,r,e.width,e.height,0,r,a.UNSIGNED_BYTE,s),{texture:o,sizeInBytes:e.width*e.height*{int8:1,uint16:2,int16:3,rgb:3}[n]}}(e),l.default.putImageTexture(e,t)),t.texture}(t);return function(e,t,n,i,s){for(var l in a.clearColor(1,0,0,1),a.viewport(0,0,i,s),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(e.program),a.bindBuffer(a.ARRAY_BUFFER,r),a.vertexAttribPointer(e.attributes.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,o),a.vertexAttribPointer(e.attributes.positionLocation,2,a.FLOAT,!1,0,0),t){var u=a.getUniformLocation(e.program,l);if(u){var d=t[l],c=d.type,f=d.value;"i"===c?a.uniform1i(u,f):"f"===c?a.uniform1f(u,f):"2f"===c&&a.uniform2f(u,f[0],f[1])}}!function(e,t,n){e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,n,0,n,t,0,0,0]),e.STATIC_DRAW)}(a,i,s),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n),a.drawArrays(a.TRIANGLE_STRIP,0,4)}(s,{u_resolution:{type:"2f",value:[t.width,t.height]},wc:{type:"f",value:n.voi.windowCenter},ww:{type:"f",value:n.voi.windowWidth},slope:{type:"f",value:t.slope},intercept:{type:"f",value:t.intercept},minPixelValue:{type:"f",value:t.minPixelValue},invert:{type:"i",value:n.invert?1:0}},u,t.width,t.height),d}function b(){var e={failIfMajorPerformanceCaveat:!0};try{var t=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(t.getContext("webgl",e)||t.getContext("experimental-webgl",e))}catch(n){return!1}}},"./webgl/shaders/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"shaders",function(){return l}),n.d(t,"dataUtilities",function(){return u});var a=n("./webgl/shaders/int16.js"),r=n("./webgl/shaders/int8.js"),o=n("./webgl/shaders/rgb.js"),i=n("./webgl/shaders/uint16.js"),s=n("./webgl/shaders/uint8.js"),l={int16:a.int16Shader,int8:r.int8Shader,rgb:o.rgbShader,uint16:i.uint16Shader,uint8:s.uint8Shader},u={int16:a.int16DataUtilities,int8:r.int8DataUtilities,rgb:o.rgbDataUtilities,uint16:i.uint16DataUtilities,uint8:s.uint8DataUtilities}},"./webgl/shaders/int16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int16DataUtilities",function(){return r}),n.d(t,"int16Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*3),a=0,r=0;r<t.length;r++){var o=Math.abs(t[r]);n[a++]=255&o,n[a++]=o>>8,n[a++]=t[r]<0?0:1}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/int8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int8DataUtilities",function(){return r}),n.d(t,"int8Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,r=0;r<t.length;r++)n[a++]=t[r],n[a++]=t[r]<0?0:1;return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/rgb.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rgbDataUtilities",function(){return r}),n.d(t,"rgbShader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){var t=e.minPixelValue,n=0,a=0,r=e.width*e.height*4,o=e.width*e.height*3,i=e.getPixelData(),s=new Uint8Array(o);if(t<0)for(;a<r;)s[n++]=i[a++]+-t,s[n++]=i[a++]+-t,s[n++]=i[a++]+-t,a+=1;else for(;a<r;)s[n++]=i[a++],s[n++]=i[a++],s[n++]=i[a++],a+=1;return s}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}"},"./webgl/shaders/uint16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint16DataUtilities",function(){return r}),n.d(t,"uint16Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,r=0;r<t.length;r++){var o=t[r];n[a++]=255&o,n[a++]=o>>8}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/uint8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint8DataUtilities",function(){return r}),n.d(t,"uint8Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){return e.getPixelData()}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/textureCache.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./triggerEvent.js"),o={},i=[],s=268435456,l=0;function u(){if(!(l<=s)){for(i.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});l>s;){var e=i[i.length-1];l-=e.sizeInBytes,delete o[e.imageId],i.pop(),Object(r.default)(a.events,a.default.WEBGL_TEXTURE_REMOVED,{imageId:e.imageId})}var t={maximumSizeInBytes:s,cacheSizeInBytes:l,numberOfImagesCached:i.length};Object(r.default)(a.events,a.default.WEBGL_TEXTURE_CACHE_FULL,t)}}t.default={purgeCache:function(){for(;i.length>0;){var e=i.pop();delete o[e.imageId]}l=0},getImageTexture:function(e){if(void 0===e)throw new Error("getImageTexture: imageId must not be undefined");var t=o[e];if(void 0!==t)return t.timeStamp=new Date,t.imageTexture},putImageTexture:function(e,t){var n=e.imageId;if(void 0===e)throw new Error("putImageTexture: image must not be undefined");if(void 0===n)throw new Error("putImageTexture: imageId must not be undefined");if(void 0===t)throw new Error("putImageTexture: imageTexture must not be undefined");if(!0===Object.prototype.hasOwnProperty.call(o,n))throw new Error("putImageTexture: imageId already in cache");var a={imageId:n,imageTexture:t,timeStamp:new Date,sizeInBytes:t.sizeInBytes};if(o[n]=a,i.push(a),void 0===t.sizeInBytes)throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===t.sizeInBytes.toFixed)throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");l+=a.sizeInBytes,u()},removeImageTexture:function(e){if(void 0===e)throw new Error("removeImageTexture: imageId must not be undefined");var t=o[e];if(void 0===t)throw new Error("removeImageTexture: imageId must not be undefined");return i.splice(i.indexOf(t),1),l-=t.sizeInBytes,delete o[e],t.imageTexture},setMaximumSizeBytes:function(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");s=e,u()}}},"./webgl/vertexShader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"vertexShader",function(){return a});var a="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstone-math",[],t):"object"==typeof exports?exports["cornerstone-math"]=t():e.cornerstoneMath=t()}(window,function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(j[e]&&x[e]){for(var n in x[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(g[n]=t[n]);0==--p&&0===b&&O()}}(e,n),t&&t(e,n)};var n,a=!0,r="a93104d9ec79cc46b114",o={},i=[],s=[];function l(e){var t=P[e];if(!t)return D;var a=function(a){return t.hot.active?(P[a]?-1===P[a].parents.indexOf(e)&&P[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),D(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return D[e]},set:function(t){D[e]=t}}};for(var o in D)Object.prototype.hasOwnProperty.call(D,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),b++,D.e(e).then(t,function(e){throw t(),e});function t(){b--,"prepare"===c&&(y[e]||E(e),0===b&&0===p&&O())}},a.t=function(e,t){return 1&t&&(e=a(e)),D.t(e,-2&t)},a}function u(t){var a={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:n!==t,active:!0,accept:function(e,t){if(void 0===e)a._selfAccepted=!0;else if("function"==typeof e)a._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)a._acceptedDependencies[e[n]]=t||function(){};else a._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)a._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)a._declinedDependencies[e[t]]=!0;else a._declinedDependencies[e]=!0},dispose:function(e){a._disposeHandlers.push(e)},addDisposeHandler:function(e){a._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=a._disposeHandlers.indexOf(e);t>=0&&a._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,c){case"idle":(g={})[t]=e[t],f("ready");break;case"ready":S(t);break;case"prepare":case"check":case"dispose":case"apply":(v=v||[]).push(t)}},check:T,apply:C,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[t]};return n=void 0,a}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var m,g,h,v,p=0,b=0,y={},x={},j={};function w(e){return+e+""===e?+e:e}function T(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=D.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f(I()?"ready":"idle"),null;x={},y={},j=e.c,h=e.h,f("prepare");var t=new Promise(function(e,t){m={resolve:e,reject:t}});return g={},E("cornerstoneMath"),"prepare"===c&&0===b&&0===p&&O(),t});var t}function E(e){j[e]?(x[e]=!0,p++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=D.p+""+e+"."+r+".hot-update.js",document.head.appendChild(t)}(e)):y[e]=!0}function O(){f("ready");var e=m;if(m=null,e)if(a)Promise.resolve().then(function(){return C(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&t.push(w(n));e.resolve(t)}}function C(e){if("ready"!==c)throw new Error("apply() is only allowed in ready status");return M(e=e||{})}function M(t){var a,s,l,u,d;function c(e){for(var t=[e],n={},a=t.map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((u=P[o])&&(!u.hot._selfAccepted||u.hot._selfInvalidated)){if(u.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(u.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<u.parents.length;s++){var l=u.parents[s],d=P[l];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([l]),moduleId:o,parentId:l};-1===t.indexOf(l)&&(d.hot._acceptedDependencies[o]?(n[l]||(n[l]=[]),m(n[l],[o])):(delete n[l],t.push(l),a.push({chain:i.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}I();var p={},b=[],y={},x=function(){console.warn("[HMR] unexpected require("+E.moduleId+") to disposed module")};for(var T in g)if(Object.prototype.hasOwnProperty.call(g,T)){var E;d=w(T);var O=!1,C=!1,S=!1,_="";switch((E=g[T]?c(d):{type:"disposed",moduleId:T}).chain&&(_="\nUpdate propagation: "+E.chain.join(" -> ")),E.type){case"self-declined":t.onDeclined&&t.onDeclined(E),t.ignoreDeclined||(O=new Error("Aborted because of self decline: "+E.moduleId+_));break;case"declined":t.onDeclined&&t.onDeclined(E),t.ignoreDeclined||(O=new Error("Aborted because of declined dependency: "+E.moduleId+" in "+E.parentId+_));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(E),t.ignoreUnaccepted||(O=new Error("Aborted because "+d+" is not accepted"+_));break;case"accepted":t.onAccepted&&t.onAccepted(E),C=!0;break;case"disposed":t.onDisposed&&t.onDisposed(E),S=!0;break;default:throw new Error("Unexception type "+E.type)}if(O)return f("abort"),Promise.reject(O);if(C)for(d in y[d]=g[d],m(b,E.outdatedModules),E.outdatedDependencies)Object.prototype.hasOwnProperty.call(E.outdatedDependencies,d)&&(p[d]||(p[d]=[]),m(p[d],E.outdatedDependencies[d]));S&&(m(b,[E.moduleId]),y[d]=x)}var L,k=[];for(s=0;s<b.length;s++)P[d=b[s]]&&P[d].hot._selfAccepted&&y[d]!==x&&!P[d].hot._selfInvalidated&&k.push({module:d,parents:P[d].parents.slice(),errorHandler:P[d].hot._selfAccepted});f("dispose"),Object.keys(j).forEach(function(e){!1===j[e]&&function(e){delete installedChunks[e]}(e)});for(var A,R=b.slice();R.length>0;)if(d=R.pop(),u=P[d]){var B={},H=u.hot._disposeHandlers;for(l=0;l<H.length;l++)(a=H[l])(B);for(o[d]=B,u.hot.active=!1,delete P[d],delete p[d],l=0;l<u.children.length;l++){var F=P[u.children[l]];F&&(L=F.parents.indexOf(d))>=0&&F.parents.splice(L,1)}}for(d in p)if(Object.prototype.hasOwnProperty.call(p,d)&&(u=P[d]))for(A=p[d],l=0;l<A.length;l++)(L=u.children.indexOf(A[l]))>=0&&u.children.splice(L,1);for(d in f("apply"),void 0!==h&&(r=h,h=void 0),g=void 0,y)Object.prototype.hasOwnProperty.call(y,d)&&(e[d]=y[d]);var U=null;for(d in p)if(Object.prototype.hasOwnProperty.call(p,d)&&(u=P[d])){A=p[d];var N=[];for(s=0;s<A.length;s++)if(a=u.hot._acceptedDependencies[A[s]]){if(-1!==N.indexOf(a))continue;N.push(a)}for(s=0;s<N.length;s++){a=N[s];try{a(A)}catch(z){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:A[s],error:z}),t.ignoreErrored||U||(U=z)}}}for(s=0;s<k.length;s++){var V=k[s];i=V.parents,n=d=V.module;try{D(d)}catch(z){if("function"==typeof V.errorHandler)try{V.errorHandler(z)}catch(q){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:q,originalError:z}),t.ignoreErrored||U||(U=q),U||(U=z)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:z}),t.ignoreErrored||U||(U=z)}}return U?(f("fail"),Promise.reject(U)):v?M(t).then(function(e){return b.forEach(function(t){e.indexOf(t)<0&&e.push(t)}),e}):(f("idle"),new Promise(function(e){e(b)}))}function I(){if(v)return g||(g={}),v.forEach(S),v=void 0,!0}function S(t){Object.prototype.hasOwnProperty.call(g,t)||(g[t]=e[t])}var P={};function D(t){if(P[t])return P[t].exports;var n=P[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return D.m=e,D.c=P,D.d=function(e,t,n){D.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},D.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},D.t=function(e,t){if(1&t&&(e=D(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(D.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)D.d(n,a,(function(t){return e[t]}).bind(null,a));return n},D.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return D.d(t,"a",t),t},D.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},D.p="",D.h=function(){return r},l("./index.js")(D.s="./index.js")}({"./Line3.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=(a=n("./vector3.js"))&&a.__esModule?a:{default:a},i=n("./math.js"),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=void 0!==t?t:new o.default,this.end=void 0!==n?n:new o.default}return r(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"center",value:function(e){return(e||new o.default).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return(e||new o.default).subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){var n=t||new o.default;return this.delta(n).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){var n=new o.default,a=new o.default;n.subVectors(e,this.start),a.subVectors(this.end,this.start);var r=a.dot(a),s=a.dot(n)/r;return t&&(s=(0,i.clamp)(s,0,1)),s}},{key:"closestPointToPoint",value:function(e,t,n){var a=this.closestPointToPointParameter(e,t),r=n||new o.default;return this.delta(r).multiplyScalar(a).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"intersectLine",value:function(e){var t=this.end.clone().sub(this.start),n=e.end.clone().sub(e.start),a=e.start.clone().sub(this.start),r=t.clone().cross(n),o=a.clone().cross(n),s=a.dot(r);if((0,i.approximatelyEquals)(s,0)){var l=o.dot(r)/r.lengthSq();if(!(l>1||isNaN(l))){var u=this.start.clone().add(t.clone().multiplyScalar(l));return u.clone().sub(e.start).lengthSq()+u.clone().sub(e.end).lengthSq()<=e.distanceSq()?u:void 0}}}}]),e}();t.default=s},"./index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector3=t.rect=t.quaternion=t.point=t.Plane=t.Matrix4=t.sign=t.radToDeg=t.degToRad=t.clamp=t.lineSegment=t.Line3=void 0;var a=f(n("./Line3.js")),r=f(n("./lineSegment.js")),o=n("./math.js"),i=f(n("./matrix4.js")),s=f(n("./plane.js")),l=f(n("./point.js")),u=f(n("./quaternion.js")),d=f(n("./rect.js")),c=f(n("./vector3.js"));function f(e){return e&&e.__esModule?e:{default:e}}var m={Line3:a.default,lineSegment:r.default,clamp:o.clamp,degToRad:o.degToRad,radToDeg:o.radToDeg,sign:o.sign,Matrix4:i.default,Plane:s.default,point:l.default,quaternion:u.default,rect:d.default,Vector3:c.default};t.Line3=a.default,t.lineSegment=r.default,t.clamp=o.clamp,t.degToRad=o.degToRad,t.radToDeg=o.radToDeg,t.sign=o.sign,t.Matrix4=i.default,t.Plane=s.default,t.point=l.default,t.quaternion=u.default,t.rect=d.default,t.Vector3=c.default,t.default=m},"./lineSegment.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./math.js");function r(e){return e*e}function o(e,t){return r(e.x-t.x)+r(e.y-t.y)}t.default={distanceToPoint:function(e,t){return Math.sqrt(function(e,t){var n=o(e.start,e.end);if(0===n)return o(t,e.start);var a=((t.x-e.start.x)*(e.end.x-e.start.x)+(t.y-e.start.y)*(e.end.y-e.start.y))/n;return o(t,a<0?e.start:a>1?e.end:{x:e.start.x+a*(e.end.x-e.start.x),y:e.start.y+a*(e.end.y-e.start.y)})}(e,t))},intersectLine:function(e,t){var n,r,o,i,s,l,u,d,c,f,m,g={},h=e.start.x,v=e.start.y,p=e.end.x,b=e.end.y,y=t.start.x,x=t.start.y,j=t.end.x,w=t.end.y,T=void 0;if(f=(n=b-v)*j+(o=h-p)*w+(s=p*v-h*b),(0===(c=n*y+o*x+s)||0===f||(0,a.sign)(c)!==(0,a.sign)(f))&&(d=(r=w-x)*p+(i=y-j)*b+(l=j*x-y*w),0===(u=r*h+i*v+l)||0===d||(0,a.sign)(u)!==(0,a.sign)(d))){m=n*i-r*o,T=o*l-i*s;var E=parseFloat(T/m);T=r*s-n*l;var O=parseFloat(T/m);return g.x=E,g.y=O,g}}}},"./math.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.degToRad=function(e){return e*(Math.PI/180)},t.approximatelyEquals=function(e,t,n){var a=n||1e-4;return Math.abs(e-t)<=a*Math.max(1,Math.abs(e),Math.abs(t))},t.radToDeg=function(e){return e*(180/Math.PI)},t.sign=function(e){return"number"==typeof e?e?e<0?-1:1:e==e?0:NaN:NaN}},"./matrix4.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=(a=n("./vector3.js"))&&a.__esModule?a:{default:a},i=function(){function e(t,n,a,r,o,i,s,l,u,d,c,f,m,g,h,v){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements=new Float32Array(16);var p=this.elements;p[0]=void 0!==t?t:1,p[4]=n||0,p[8]=a||0,p[12]=r||0,p[1]=o||0,p[5]=void 0!==i?i:1,p[9]=s||0,p[13]=l||0,p[2]=u||0,p[6]=d||0,p[10]=void 0!==c?c:1,p[14]=f||0,p[3]=m||0,p[7]=g||0,p[11]=h||0,p[15]=void 0!==v?v:1}return r(e,[{key:"makeRotationFromQuaternion",value:function(e){var t=this.elements,n=e.x,a=e.y,r=e.z,o=e.w,i=n+n,s=a+a,l=r+r,u=n*i,d=n*s,c=n*l,f=a*s,m=a*l,g=r*l,h=o*i,v=o*s,p=o*l;return t[0]=1-(f+g),t[4]=d-p,t[8]=c+v,t[1]=d+p,t[5]=1-(u+g),t[9]=m-h,t[2]=c-v,t[6]=m+h,t[10]=1-(u+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,a=t.elements,r=this.elements,o=n[0],i=n[4],s=n[8],l=n[12],u=n[1],d=n[5],c=n[9],f=n[13],m=n[2],g=n[6],h=n[10],v=n[14],p=n[3],b=n[7],y=n[11],x=n[15],j=a[0],w=a[4],T=a[8],E=a[12],O=a[1],C=a[5],M=a[9],I=a[13],S=a[2],P=a[6],D=a[10],_=a[14],L=a[3],k=a[7],A=a[11],R=a[15];return r[0]=o*j+i*O+s*S+l*L,r[4]=o*w+i*C+s*P+l*k,r[8]=o*T+i*M+s*D+l*A,r[12]=o*E+i*I+s*_+l*R,r[1]=u*j+d*O+c*S+f*L,r[5]=u*w+d*C+c*P+f*k,r[9]=u*T+d*M+c*D+f*A,r[13]=u*E+d*I+c*_+f*R,r[2]=m*j+g*O+h*S+v*L,r[6]=m*w+g*C+h*P+v*k,r[10]=m*T+g*M+h*D+v*A,r[14]=m*E+g*I+h*_+v*R,r[3]=p*j+b*O+y*S+x*L,r[7]=p*w+b*C+y*P+x*k,r[11]=p*T+b*M+y*D+x*A,r[15]=p*E+b*I+y*_+x*R,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"getInverse",value:function(e,t){var n=this.elements,a=e.elements,r=a[0],o=a[4],i=a[8],s=a[12],l=a[1],u=a[5],d=a[9],c=a[13],f=a[2],m=a[6],g=a[10],h=a[14],v=a[3],p=a[7],b=a[11],y=a[15];n[0]=d*h*p-c*g*p+c*m*b-u*h*b-d*m*y+u*g*y,n[4]=s*g*p-i*h*p-s*m*b+o*h*b+i*m*y-o*g*y,n[8]=i*c*p-s*d*p+s*u*b-o*c*b-i*u*y+o*d*y,n[12]=s*d*m-i*c*m-s*u*g+o*c*g+i*u*h-o*d*h,n[1]=c*g*v-d*h*v-c*f*b+l*h*b+d*f*y-l*g*y,n[5]=i*h*v-s*g*v+s*f*b-r*h*b-i*f*y+r*g*y,n[9]=s*d*v-i*c*v-s*l*b+r*c*b+i*l*y-r*d*y,n[13]=i*c*f-s*d*f+s*l*g-r*c*g-i*l*h+r*d*h,n[2]=u*h*v-c*m*v+c*f*p-l*h*p-u*f*y+l*m*y,n[6]=s*m*v-o*h*v-s*f*p+r*h*p+o*f*y-r*m*y,n[10]=o*c*v-s*u*v+s*l*p-r*c*p-o*l*y+r*u*y,n[14]=s*u*f-o*c*f-s*l*m+r*c*m+o*l*h-r*u*h,n[3]=d*m*v-u*g*v-d*f*p+l*g*p+u*f*b-l*m*b,n[7]=o*g*v-i*m*v+i*f*p-r*g*p-o*f*b+r*m*b,n[11]=i*u*v-o*d*v-i*l*p+r*d*p+o*l*b-r*u*b,n[15]=o*d*f-i*u*f+i*l*m-r*d*m-o*l*g+r*u*g;var x=r*n[0]+l*n[4]+f*n[8]+v*n[12];if(0===x){var j="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(j);return console.warn(j),this.identity(),this}return this.multiplyScalar(1/x),this}},{key:"applyToVector3Array",value:function(){var e=new o.default;return function(t,n,a){void 0===n&&(n=0),void 0===a&&(a=t.length);for(var r=0,o=n;r<a;r+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"set",value:function(e,t,n,a,r,o,i,s,l,u,d,c,f,m,g,h){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=a,v[1]=r,v[5]=o,v[9]=i,v[13]=s,v[2]=l,v[6]=u,v[10]=d,v[14]=c,v[3]=f,v[7]=m,v[11]=g,v[15]=h,this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}}]),e}();t.default=i},"./plane.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=(a=n("./vector3.js"))&&a.__esModule?a:{default:a},l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.normal=void 0!==t?t:new s.default(1,0,0),this.constant=void 0!==n?n:0}return i(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,a){return this.normal.set(e,t,n),this.constant=a,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return this.orthoPoint(e,t).sub(e).negate()}},{key:"orthoPoint",value:function(e,t){var n=this.distanceToPoint(e);return(t||new s.default).copy(this.normal).multiplyScalar(n)}},{key:"isIntersectionLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectPlane",value:function(e){var t=this.normal.clone().cross(e.normal),n={origin:new s.default,direction:t};if(this.normal.clone().cross(e.normal).length<1e-10)return n.direction=new s.default,n;var a=this.constant,r=e.constant,o=this.normal.clone().dot(e.normal),i=-(a-r*o)/(1-o*o),l=-(r-a*o)/(1-o*o);return n.origin=this.normal.clone().multiplyScalar(i).add(e.normal.clone().multiplyScalar(l)),n}},{key:"coplanarPoint",value:function(e){return(e||new s.default).copy(this.normal).multiplyScalar(-this.constant)}},{key:"translate",value:function(e){return this.constant=this.constant-e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new e).copy(this)}}]),e}();l.prototype.setFromCoplanarPoints=(r=new s.default,o=new s.default,function(e,t,n){var a=r.subVectors(n,t).cross(o.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}),l.prototype.intersectLine=function(){var e=new s.default;return function(t,n){var a=n||new s.default,r=t.delta(e),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(t.start)?a.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/o;return i<0||i>1?void 0:a.copy(r).multiplyScalar(i).add(t.start)}}(),t.default=l},"./point.js":function(e,t,n){"use strict";function a(e,t){return{x:e.x-t.x,y:e.y-t.y}}function r(e,t){return Math.sqrt(o(e,t))}function o(e,t){var n=a(e,t);return n.x*n.x+n.y*n.y}Object.defineProperty(t,"__esModule",{value:!0}),t.default={subtract:a,copy:function(e){return{x:e.x,y:e.y}},pageToPoint:function(e){return{x:e.pageX,y:e.pageY}},distance:r,distanceSquared:o,insideRect:function(e,t){return!(e.x<t.left||e.x>t.left+t.width||e.y<t.top||e.y>t.top+t.height)},findClosestPoint:function(e,t){var n=[],a=void 0;return e.forEach(function(e,o){var i=r(e,t);n.push(i),a=0===o?i:Math.min(i,a)}),e[n.indexOf(a)]}}},"./quaternion.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(t,n,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t||0,this.y=n||0,this.z=a||0,this.w=void 0!==r?r:1}return a(e,[{key:"setFromAxisAngle",value:function(e,t){var n=t/2,a=Math.sin(n);return this.x=e.x*a,this.y=e.y*a,this.z=e.z*a,this.w=Math.cos(n),this}},{key:"multiplyQuaternions",value:function(e,t){var n=e.x,a=e.y,r=e.z,o=e.w,i=t.x,s=t.y,l=t.z,u=t.w;return this.x=n*u+o*i+a*l-r*s,this.y=a*u+o*s+r*i-n*l,this.z=r*u+o*l+n*s-a*i,this.w=o*u-n*i-a*s-r*l,this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],a=t[4],r=t[8],o=t[1],i=t[5],s=t[9],l=t[2],u=t[6],d=t[10],c=n+i+d,f=void 0;return c>0?(f=.5/Math.sqrt(c+1),this.w=.25/f,this.x=(u-s)*f,this.y=(r-l)*f,this.z=(o-a)*f):n>i&&n>d?(f=2*Math.sqrt(1+n-i-d),this.w=(u-s)/f,this.x=.25*f,this.y=(a+o)/f,this.z=(r+l)/f):i>d?(f=2*Math.sqrt(1+i-n-d),this.w=(r-l)/f,this.x=(a+o)/f,this.y=.25*f,this.z=(s+u)/f):(f=2*Math.sqrt(1+d-n-i),this.w=(o-a)/f,this.x=(r+l)/f,this.y=(s+u)/f,this.z=.25*f),this}}]),e}();t.default=r},"./rect.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./lineSegment.js"))&&a.__esModule?a:{default:a};function o(e){return{topLeft:{x:e.left,y:e.top},bottomRight:{x:e.left+e.width,y:e.top+e.height}}}t.default={distanceToPoint:function(e,t){var n=655535;return function(e){return[{start:{x:e.left,y:e.top},end:{x:e.left+e.width,y:e.top}},{start:{x:e.left+e.width,y:e.top},end:{x:e.left+e.width,y:e.top+e.height}},{start:{x:e.left+e.width,y:e.top+e.height},end:{x:e.left,y:e.top+e.height}},{start:{x:e.left,y:e.top+e.height},end:{x:e.left,y:e.top}}]}(e).forEach(function(e){var a=r.default.distanceToPoint(e,t);a<n&&(n=a)}),n},getIntersectionRect:function(e,t){var n={topLeft:{},bottomRight:{}};if(function(e,t){var n=o(e),a=o(t);return!((e.width>=0?t.width>=0?n.bottomRight.x<=a.topLeft.x||a.bottomRight.x<=n.topLeft.x:n.bottomRight.x<=a.bottomRight.x||a.topLeft.x<=n.topLeft.x:t.width>=0?n.topLeft.x<=a.topLeft.x||a.bottomRight.x<=n.bottomRight.x:n.topLeft.x<=a.bottomRight.x||a.topLeft.x<=n.bottomRight.x)||(e.height>=0?t.height>=0?n.bottomRight.y<=a.topLeft.y||a.bottomRight.y<=n.topLeft.y:n.bottomRight.y<=a.bottomRight.y||a.topLeft.y<=n.topLeft.y:t.height>=0?n.topLeft.y<=a.topLeft.y||a.bottomRight.y<=n.bottomRight.y:n.topLeft.y<=a.bottomRight.y||a.top<=n.bottomRight.y))}(e,t)){var a=o(e),r=o(t);return e.width>=0?t.width>=0?(n.topLeft.x=Math.max(a.topLeft.x,r.topLeft.x),n.bottomRight.x=Math.min(a.bottomRight.x,r.bottomRight.x)):(n.topLeft.x=Math.max(a.topLeft.x,r.bottomRight.x),n.bottomRight.x=Math.min(a.bottomRight.x,r.topLeft.x)):t.width>=0?(n.topLeft.x=Math.min(a.topLeft.x,r.bottomRight.x),n.bottomRight.x=Math.max(a.bottomRight.x,r.topLeft.x)):(n.topLeft.x=Math.min(a.topLeft.x,r.topLeft.x),n.bottomRight.x=Math.max(a.bottomRight.x,r.bottomRight.x)),e.height>=0?t.height>=0?(n.topLeft.y=Math.max(a.topLeft.y,r.topLeft.y),n.bottomRight.y=Math.min(a.bottomRight.y,r.bottomRight.y)):(n.topLeft.y=Math.max(a.topLeft.y,r.bottomRight.y),n.bottomRight.y=Math.min(a.bottomRight.y,r.topLeft.y)):t.height>=0?(n.topLeft.y=Math.min(a.topLeft.y,r.bottomRight.y),n.bottomRight.y=Math.max(a.bottomRight.y,r.topLeft.y)):(n.topLeft.y=Math.min(a.topLeft.y,r.topLeft.y),n.bottomRight.y=Math.max(a.bottomRight.y,r.bottomRight.y)),n}}}},"./vector3.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i,s,l,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=(a=n("./quaternion.js"))&&a.__esModule?a:{default:a},c=n("./math.js"),f=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t||0,this.y=n||0,this.z=a||0}return u(e,[{key:"set",value:function(e,t,n){return this.x=e,this.y=t,this.z=n,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*a,this.y=r[1]*t+r[4]*n+r[7]*a,this.z=r[2]*t+r[5]*n+r[8]*a,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*a+r[12],this.y=r[1]*t+r[5]*n+r[9]*a+r[13],this.z=r[2]*t+r[6]*n+r[10]*a+r[14],this}},{key:"applyProjection",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*a+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*a+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*a+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*a+r[14])*o,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.x,o=e.y,i=e.z,s=e.w,l=s*t+o*a-i*n,u=s*n+i*t-r*a,d=s*a+r*n-o*t,c=-r*t-o*n-i*a;return this.x=l*s+c*-r+u*-i-d*-o,this.y=u*s+c*-o+d*-r-l*-i,this.z=d*s+c*-i+l*-o-u*-r,this}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*a,this.y=r[1]*t+r[5]*n+r[9]*a,this.z=r[2]*t+r[6]*n+r[10]*a,this.normalize(),this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this}},{key:"min",value:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this}},{key:"max",value:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this}},{key:"clamp",value:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.multiplyScalar(-1)}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"lengthManhattan",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"setLength",value:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"cross",value:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,a=this.y,r=this.z;return this.x=a*e.z-r*e.y,this.y=r*e.x-n*e.z,this.z=n*e.y-a*e.x,this}},{key:"crossVectors",value:function(e,t){var n=e.x,a=e.y,r=e.z,o=t.x,i=t.y,s=t.z;return this.x=a*s-r*i,this.y=r*o-n*s,this.z=n*i-a*o,this}},{key:"angleTo",value:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos((0,c.clamp)(t,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,a=this.z-e.z;return t*t+n*n+a*a}},{key:"setFromMatrixPosition",value:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),a=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=a,this}},{key:"setFromMatrixColumn",value:function(e,t){var n=4*e,a=t.elements;return this.x=a[n],this.y=a[n+1],this.z=a[n+2],this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}}]),e}();f.prototype.projectOnVector=(r=void 0,o=void 0,function(e){return void 0===r&&(r=new f),r.copy(e).normalize(),o=this.dot(r),this.copy(r).multiplyScalar(o)}),f.prototype.projectOnPlane=function(){var e=void 0;return function(t){return void 0===e&&(e=new f),e.copy(this).projectOnVector(t),this.sub(e)}}(),f.prototype.reflect=function(){var e=void 0;return function(t){return void 0===e&&(e=new f),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),f.prototype.clampScalar=(i=void 0,s=void 0,function(e,t){return void 0===i&&(i=new f,s=new f),i.set(e,e,e),s.set(t,t,t),this.clamp(i,s)}),f.prototype.applyAxisAngle=(l=void 0,function(e,t){return void 0===l&&(l=new d.default),this.applyQuaternion(l.setFromAxisAngle(e.normalize(),t)),this}),t.default=f}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstone-tools",[],t):"object"==typeof exports?exports["cornerstone-tools"]=t():e.cornerstoneTools=t()}(window,function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(x[e]&&y[e]){for(var n in y[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(g[n]=t[n]);0==--v&&0===p&&E()}}(e,n),t&&t(e,n)};var n,a=!0,r="c0a25c28b170fadd6e59",o={},i=[],s=[];function l(e){var t=C[e];if(!t)return M;var a=function(a){return t.hot.active?(C[a]?-1===C[a].parents.indexOf(e)&&C[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),M(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return M[e]},set:function(t){M[e]=t}}};for(var o in M)Object.prototype.hasOwnProperty.call(M,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),p++,M.e(e).then(t,function(e){throw t(),e});function t(){p--,"prepare"===c&&(b[e]||T(e),0===p&&0===v&&E())}},a.t=function(e,t){return 1&t&&(e=a(e)),M.t(e,-2&t)},a}function u(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:w,apply:O,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[e]};return n=void 0,t}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var m,g,h,v=0,p=0,b={},y={},x={};function j(e){return+e+""===e?+e:e}function w(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=M.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f("idle"),null;y={},b={},x=e.c,h=e.h,f("prepare");var t=new Promise(function(e,t){m={resolve:e,reject:t}});return g={},T("cornerstoneTools"),"prepare"===c&&0===p&&0===v&&E(),t});var t}function T(e){x[e]?(y[e]=!0,v++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=M.p+""+e+"."+r+".hot-update.js",document.head.appendChild(t)}(e)):b[e]=!0}function E(){f("ready");var e=m;if(m=null,e)if(a)Promise.resolve().then(function(){return O(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&t.push(j(n));e.resolve(t)}}function O(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");var n,a,s,l,u;function d(e){for(var t=[e],n={},a=t.map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((l=C[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],d=C[u];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(d.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),m(n[u],[o])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var v={},p=[],b={},y=function(){console.warn("[HMR] unexpected require("+T.moduleId+") to disposed module")};for(var w in g)if(Object.prototype.hasOwnProperty.call(g,w)){var T;u=j(w);var E=!1,O=!1,I=!1,S="";switch((T=g[w]?d(u):{type:"disposed",moduleId:w}).chain&&(S="\nUpdate propagation: "+T.chain.join(" -> ")),T.type){case"self-declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(E=new Error("Aborted because of self decline: "+T.moduleId+S));break;case"declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+T.moduleId+" in "+T.parentId+S));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(T),t.ignoreUnaccepted||(E=new Error("Aborted because "+u+" is not accepted"+S));break;case"accepted":t.onAccepted&&t.onAccepted(T),O=!0;break;case"disposed":t.onDisposed&&t.onDisposed(T),I=!0;break;default:throw new Error("Unexception type "+T.type)}if(E)return f("abort"),Promise.reject(E);if(O)for(u in b[u]=g[u],m(p,T.outdatedModules),T.outdatedDependencies)Object.prototype.hasOwnProperty.call(T.outdatedDependencies,u)&&(v[u]||(v[u]=[]),m(v[u],T.outdatedDependencies[u]));I&&(m(p,[T.moduleId]),b[u]=y)}var P,D=[];for(a=0;a<p.length;a++)C[u=p[a]]&&C[u].hot._selfAccepted&&b[u]!==y&&D.push({module:u,errorHandler:C[u].hot._selfAccepted});f("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var _,L=p.slice();L.length>0;)if(u=L.pop(),l=C[u]){var k={},A=l.hot._disposeHandlers;for(s=0;s<A.length;s++)(n=A[s])(k);for(o[u]=k,l.hot.active=!1,delete C[u],delete v[u],s=0;s<l.children.length;s++){var R=C[l.children[s]];R&&(P=R.parents.indexOf(u))>=0&&R.parents.splice(P,1)}}for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(l=C[u]))for(_=v[u],s=0;s<_.length;s++)(P=l.children.indexOf(_[s]))>=0&&l.children.splice(P,1);for(u in f("apply"),r=h,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in v)if(Object.prototype.hasOwnProperty.call(v,u)&&(l=C[u])){_=v[u];var H=[];for(a=0;a<_.length;a++)if(n=l.hot._acceptedDependencies[_[a]]){if(-1!==H.indexOf(n))continue;H.push(n)}for(a=0;a<H.length;a++){n=H[a];try{n(_)}catch(U){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:_[a],error:U}),t.ignoreErrored||B||(B=U)}}}for(a=0;a<D.length;a++){var F=D[a];i=[u=F.module];try{M(u)}catch(U){if("function"==typeof F.errorHandler)try{F.errorHandler(U)}catch(N){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:N,originalError:U}),t.ignoreErrored||B||(B=N),B||(B=U)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:U}),t.ignoreErrored||B||(B=U)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise(function(e){e(p)}))}var C={};function M(t){if(C[t])return C[t].exports;var n=C[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return M.m=e,M.c=C,M.d=function(e,t,n){M.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},M.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},M.t=function(e,t){if(1&t&&(e=M(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(M.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)M.d(n,a,(function(t){return e[t]}).bind(null,a));return n},M.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return M.d(t,"a",t),t},M.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},M.p="",M.h=function(){return r},l("./index.js")(M.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(e,t){function n(e,t,n,a,r,o,i){try{var s=e[o](i),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(a,r)}e.exports=function(e){return function(){var t=this,a=arguments;return new Promise(function(r,o){var i=e.apply(t,a);function s(e){n(i,r,o,s,l,"next",e)}function l(e){n(i,r,o,s,l,"throw",e)}s(void 0)})}}},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"../node_modules/@babel/runtime/helpers/createClass.js":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}},"../node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},"../node_modules/@babel/runtime/helpers/inherits.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/setPrototypeOf.js");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},"../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":function(e,t){e.exports=function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(l){r=!0,o=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}},"../node_modules/@babel/runtime/helpers/nonIterableRest.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js");e.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?r(e):t}},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(e,t){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,a)}e.exports=n},"../node_modules/@babel/runtime/helpers/slicedToArray.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/arrayWithHoles.js"),r=n("../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"),o=n("../node_modules/@babel/runtime/helpers/nonIterableRest.js");e.exports=function(e,t){return a(e)||r(e,t)||o()}},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),r=n("../node_modules/@babel/runtime/helpers/iterableToArray.js"),o=n("../node_modules/@babel/runtime/helpers/nonIterableSpread.js");e.exports=function(e){return a(e)||r(e)||o()}},"../node_modules/@babel/runtime/helpers/typeof.js":function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){return e.exports=a="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(t)}e.exports=a},"../node_modules/@babel/runtime/regenerator/index.js":function(e,t,n){e.exports=n("../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/ms/index.js":function(e,t){var n=1e3,a=60*n,r=60*a,o=24*r;function i(e,t,n,a){var r=t>=1.5*n;return Math.round(e/n)+" "+a+(r?"s":"")}e.exports=function(e,t){t=t||{};var s,l,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*o;case"hours":case"hour":case"hrs":case"hr":case"h":return i*r;case"minutes":case"minute":case"mins":case"min":case"m":return i*a;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?(s=e,(l=Math.abs(s))>=o?i(s,l,o,"day"):l>=r?i(s,l,r,"hour"):l>=a?i(s,l,a,"minute"):l>=n?i(s,l,n,"second"):s+" ms"):function(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+"d":t>=r?Math.round(e/r)+"h":t>=a?Math.round(e/a)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../node_modules/process/browser.js":function(e,t){var n,a,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var l,u=[],d=!1,c=-1;function f(){d&&l&&(d=!1,l.length?u=l.concat(u):c=-1,u.length&&m())}function m(){if(!d){var e=s(f);d=!0;for(var t=u.length;t;){for(l=u,u=[];++c<t;)l&&l[c].run();c=-1,t=u.length}l=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new g(e,t)),1!==u.length||d||s(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(e,t,n){var a=function(){return this||"object"==typeof self&&self}()||Function("return this")(),r=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,o=r&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=n("../node_modules/regenerator-runtime/runtime.js"),r)a.regeneratorRuntime=o;else try{delete a.regeneratorRuntime}catch(i){a.regeneratorRuntime=void 0}},"../node_modules/regenerator-runtime/runtime.js":function(e,t){!function(t){"use strict";var n,a=Object.prototype,r=a.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag",u="object"==typeof e,d=t.regeneratorRuntime;if(d)u&&(e.exports=d);else{(d=t.regeneratorRuntime=u?e.exports:{}).wrap=x;var c="suspendedStart",f="suspendedYield",m="executing",g="completed",h={},v={};v[i]=function(){return this};var p=Object.getPrototypeOf,b=p&&p(p(D([])));b&&b!==a&&r.call(b,i)&&(v=b);var y=E.prototype=w.prototype=Object.create(v);T.prototype=y.constructor=E,E.constructor=T,E[l]=T.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(y),e},d.awrap=function(e){return{__await:e}},O(C.prototype),C.prototype[s]=function(){return this},d.AsyncIterator=C,d.async=function(e,t,n,a){var r=new C(x(e,t,n,a));return d.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},O(y),y[l]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},d.values=D,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,r){return s.type="throw",s.arg=e,t.next=a,r&&(t.method="next",t.arg=n),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:D(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),h}}}function x(e,t,n,a){var r=Object.create((t&&t.prototype instanceof w?t:w).prototype),o=new P(a||[]);return r._invoke=function(e,t,n){var a=c;return function(r,o){if(a===m)throw new Error("Generator is already running");if(a===g){if("throw"===r)throw o;return _()}for(n.method=r,n.arg=o;;){var i=n.delegate;if(i){var s=M(i,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===c)throw a=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var l=j(e,t,n);if("normal"===l.type){if(a=n.done?g:f,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=g,n.method="throw",n.arg=l.arg)}}}(e,n,o),r}function j(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(a){return{type:"throw",arg:a}}}function w(){}function T(){}function E(){}function O(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function C(e){function t(n,a,o,i){var s=j(e[n],e,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&r.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,o,i)},function(e){t("throw",e,o,i)}):Promise.resolve(u).then(function(e){l.value=e,o(l)},function(e){return t("throw",e,o,i)})}i(s.arg)}var n;this._invoke=function(e,a){function r(){return new Promise(function(n,r){t(e,a,n,r)})}return n=n?n.then(r,r):r()}}function M(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,M(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=j(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,h;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function D(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:_}}function _(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},"./drawing/draw.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.save(),t(e),e.restore()}},"./drawing/drawArrow.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/drawLine.js"),r=n("./drawing/drawJoinedLines.js");t.default=function(e,t,n,o,i,s){var l=Math.atan2(n.y-t.y,n.x-t.x),u={color:o,lineWidth:i};s&&(u.lineDash=s),Object(a.default)(e,void 0,t,n,u,"canvas"),u={color:o,lineWidth:i,fillStyle:o};var d=[{x:n.x-10*Math.cos(l-Math.PI/7),y:n.y-10*Math.sin(l-Math.PI/7)},{x:n.x-10*Math.cos(l+Math.PI/7),y:n.y-10*Math.sin(l+Math.PI/7)},n];Object(r.default)(e,void 0,n,d,u,"canvas")}},"./drawing/drawCircle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n)),Object(r.default)(e,i,function(e){e.arc(n.x,n.y,o,0,2*Math.PI)})}},"./drawing/drawEllipse.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js"),o=n("./util/pointProjector.js");t.default=function(e,t,n,i,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n),i=a.default.cornerstone.pixelToCanvas(t,i));var d=a.default.cornerstone.getViewport(t),c=t.clientWidth,f=t.clientHeight,m=d.scale,g=d.translation,h=d.rotation-u,v={x:c/2+g.x*m,y:f/2+g.y*m};Math.abs(h)>.05&&(n=Object(o.rotatePoint)(n,v,-h),i=Object(o.rotatePoint)(i,v,-h));var p=Math.abs(n.x-i.x),b=Math.abs(n.y-i.y),y=Math.min(n.x,i.x),x=Math.min(n.y,i.y),j={x:y+p/2,y:x+b/2};Math.abs(h)>.05&&(j=Object(o.rotatePoint)(j,v,h));var w=h*Math.PI/180;Object(r.default)(e,s,function(e){e.ellipse(j.x,j.y,p/2,b/2,w,0,2*Math.PI),e.closePath()})}},"./drawing/drawHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolStyle.js"),o=n("./stateManagement/toolColors.js"),i=n("./drawing/path.js"),s=n("./store/index.js");t.default=function(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=t.element,d=o.default.getToolColor();e.strokeStyle=l.color||d;for(var c=Object.keys(n),f=function(t){var o=n[c[t]];if(!0===o.drawnIndependently)return"continue";if(!0===l.drawHandlesIfActive&&!o.active)return"continue";if(l.hideHandlesIfMoving&&o.moving)return"continue";var d={lineWidth:o.active?r.default.getActiveWidth():r.default.getToolWidth(),fillStyle:l.fill};l.lineDash&&(d.lineDash=l.lineDash),Object(i.default)(e,d,function(e){var t=a.default.cornerstone.pixelToCanvas(u,o);e.arc(t.x,t.y,o.radius||l.handleRadius||s.state.handleRadius,0,2*Math.PI)})},m=0;m<c.length;m++)f(m)}},"./drawing/drawJoinedLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(r.default)(e,i,function(e){"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),o=o.map(function(e){return a.default.cornerstone.pixelToCanvas(t,e)})),e.moveTo(n.x,n.y),o.forEach(function(t){e.lineTo(t.x,t.y)})})}},"./drawing/drawLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./externalModules.js"),r=n("./drawing/path.js");function o(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(r.default)(e,i,function(e){"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),o=a.default.cornerstone.pixelToCanvas(t,o)),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y)})}},"./drawing/drawLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";Object(r.default)(e,o,function(e){n.forEach(function(n){var r=n.start,o=n.end;if("pixel"===i){var s=a.default.cornerstone;r=s.pixelToCanvas(t,r),o=s.pixelToCanvas(t,o)}e.moveTo(r.x,r.y),e.lineTo(o.x,o.y)})})}},"./drawing/drawLink.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/drawLine.js");t.default=function(e,t,n,o,i,s){var l=e.length>0?a.default.cornerstoneMath.point.findClosestPoint(e,t):t,u=a.default.cornerstoneMath.point.findClosestPoint([{x:n.left+n.width/2,y:n.top},{x:n.left,y:n.top+n.height/2},{x:n.left+n.width/2,y:n.top+n.height},{x:n.left+n.width,y:n.top+n.height/2}],l),d={color:i,lineWidth:s,lineDash:[2,3]};Object(r.default)(o,void 0,l,u,d,"canvas")}},"./drawing/drawLinkedTextBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/drawTextBox.js"),o=n("./drawing/drawLink.js");t.default=function(e,t,n,i,s,l,u,d,c,f){var m=a.default.cornerstone,g=m.pixelToCanvas(t,n);c&&(g.x+=c);var h={centering:{x:!1,y:f}};if(n.boundingBox=Object(r.default)(e,i,g.x,g.y,u,h),n.hasMoved){var v=l(s).map(function(e){return m.pixelToCanvas(t,e)});Object(o.default)(v,g,n.boundingBox,e,u,d)}}},"./drawing/drawRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js"),o=n("./util/pointProjector.js");t.default=function(e,t,n,i,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if("pixel"===l){var d=a.default.cornerstone;n=d.pixelToCanvas(t,n),i=d.pixelToCanvas(t,i)}var c=a.default.cornerstone.getViewport(t),f=t.clientWidth,m=t.clientHeight,g=c.scale,h=c.translation,v=c.rotation-u,p={x:f/2+h.x*g,y:m/2+h.y*g};Math.abs(v)>.05&&(n=Object(o.rotatePoint)(n,p,-v),i=Object(o.rotatePoint)(i,p,-v));var b=Math.abs(n.x-i.x),y=Math.abs(n.y-i.y);n={x:Math.min(n.x,i.x),y:Math.min(n.y,i.y)},i={x:n.x+b,y:n.y+y};var x={x:n.x+b,y:n.y},j={x:n.x,y:n.y+y};Math.abs(v)>.05&&(n=Object(o.rotatePoint)(n,p,v),i=Object(o.rotatePoint)(i,p,v),x=Object(o.rotatePoint)(x,p,v),j=Object(o.rotatePoint)(j,p,v)),Object(r.default)(e,s,function(e){e.moveTo(n.x,n.y),e.lineTo(x.x,x.y),e.lineTo(i.x,i.y),e.lineTo(j.x,j.y),e.lineTo(n.x,n.y)})}},"./drawing/drawTextBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"textBoxWidth",function(){return s});var a=n("./stateManagement/textStyle.js"),r=n("./drawing/draw.js"),o=n("./drawing/fillTextLines.js"),i=n("./drawing/fillBox.js");function s(e,t,n){var r=a.default.getFont(),o=e.font;r&&r!==o&&(e.font=r);var i=e.measureText(t).width;return r&&r!==o&&(e.font=o),i+2*n}t.default=function(e,t,n,l,u,d){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var c=a.default.getFontSize(),f=a.default.getBackgroundColor(),m=0;t.forEach(function(t){var n=s(e,t,5);m=Math.max(m,n)});var g={width:m,height:5+t.length*(c+5)};return Object(r.default)(e,function(e){e.strokeStyle=u,d&&d.centering&&!0===d.centering.x&&(n-=g.width/2),d&&d.centering&&!0===d.centering.y&&(l-=g.height/2),g.left=n,g.top=l;var a=d&&!0===d.debug?"#FF0000":f;Object(i.default)(e,g,a),Object(o.default)(e,g,t,u,5)}),g}},"./drawing/fillBox.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){e.fillStyle=n,e.fillRect(t.left,t.top,t.width,t.height)}},"./drawing/fillOutsideRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===s){var l=a.default.cornerstone;n=l.pixelToCanvas(t,n),o=l.pixelToCanvas(t,o)}var u=Math.min(n.x,o.x),d=Math.min(n.y,o.y),c=Math.abs(n.x-o.x),f=Math.abs(n.y-o.y);Object(r.default)(e,i,function(e){e.rect(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.rect(u+c,d,-c,f)})}},"./drawing/fillTextLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/textStyle.js");t.default=function(e,t,n,r,o){var i=a.default.getFontSize();e.font=a.default.getFont(),e.textBaseline="top",e.fillStyle=r,n.forEach(function(n,a){e.fillText(n,t.left+o,t.top+o+a*(i+o))})}},"./drawing/getNewContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.getContext("2d");return t.setTransform(1,0,0,1,0,0),t}},"./drawing/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/draw.js");n.d(t,"draw",function(){return a.default});var r=n("./drawing/drawArrow.js");n.d(t,"drawArrow",function(){return r.default});var o=n("./drawing/drawCircle.js");n.d(t,"drawCircle",function(){return o.default});var i=n("./drawing/drawEllipse.js");n.d(t,"drawEllipse",function(){return i.default});var s=n("./drawing/drawHandles.js");n.d(t,"drawHandles",function(){return s.default});var l=n("./drawing/drawJoinedLines.js");n.d(t,"drawJoinedLines",function(){return l.default});var u=n("./drawing/drawLine.js");n.d(t,"drawLine",function(){return u.default});var d=n("./drawing/drawLines.js");n.d(t,"drawLines",function(){return d.default});var c=n("./drawing/drawLink.js");n.d(t,"drawLink",function(){return c.default});var f=n("./drawing/drawLinkedTextBox.js");n.d(t,"drawLinkedTextBox",function(){return f.default});var m=n("./drawing/drawRect.js");n.d(t,"drawRect",function(){return m.default});var g=n("./drawing/drawTextBox.js");n.d(t,"drawTextBox",function(){return g.default});var h=n("./drawing/fillBox.js");n.d(t,"fillBox",function(){return h.default});var v=n("./drawing/fillOutsideRect.js");n.d(t,"fillOutsideRect",function(){return v.default});var p=n("./drawing/fillTextLines.js");n.d(t,"fillTextLines",function(){return p.default});var b=n("./drawing/getNewContext.js");n.d(t,"getNewContext",function(){return b.default});var y=n("./drawing/path.js");n.d(t,"path",function(){return y.default});var x=n("./drawing/setShadow.js");n.d(t,"setShadow",function(){return x.default});var j=n("./drawing/transformCanvasContext.js");n.d(t,"transformCanvasContext",function(){return j.default});var w=n("./drawing/resetCanvasContextTransform.js");n.d(t,"resetCanvasContextTransform",function(){return w.default})},"./drawing/path.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolStyle.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.color,o=t.lineWidth,i=t.fillStyle,s=t.lineDash,l=t.shouldDrawLines,u=void 0===l||l;e.beginPath(),e.strokeStyle=r||e.strokeStyle,e.lineWidth=o||void 0===o&&a.default.getToolWidth()||e.lineWidth,s&&e.setLineDash(s),n(e),i&&(e.fillStyle=i,e.fill()),u&&e.stroke(),s&&e.setLineDash([])}},"./drawing/resetCanvasContextTransform.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){e.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/getDefault.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.shadow&&(e.shadowColor=Object(a.default)(t.shadowColor,"#000000"),e.shadowBlur=Object(a.default)(t.shadowBlur,0),e.shadowOffsetX=Object(a.default)(t.shadowOffsetX,1),e.shadowOffsetY=Object(a.default)(t.shadowOffsetY,1))}},"./drawing/transformCanvasContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){if(n.hflip||n.vflip||n.rotation){var a={x:t.width/2+n.translation.x*n.scale,y:t.height/2+n.translation.y*n.scale};e.translate(a.x,a.y),n.rotation&&e.rotate(n.rotation*Math.PI/180),n.vflip&&e.scale(1,-1),n.hflip&&e.scale(-1,1),e.translate(-a.x,-a.y)}}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./eventListeners/onImageRenderedBrushEventHandler.js"),i=n("./externalModules.js"),s=Object(a.getModule)("segmentation"),l=function(e){var t=e.detail,n=t.element,i=a.state.tools.filter(function(e){return e.element===n&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)}),l=Object(r.getToolState)(n,"stack"),u=s.configuration;l&&(u.renderFill||u.renderOutline)&&Object(o.default)(e);var d=t.canvasContext.canvas.getContext("2d");i.forEach(function(t){t.renderToolData&&(d.save(),t.renderToolData(e),d.restore())})};t.default={enable:function(e){e.addEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,l)},disable:function(e){e.removeEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,l)}}},"./eventDispatchers/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/imageRenderedEventDispatcher.js");n.d(t,"imageRenderedEventDispatcher",function(){return a.default});var r=n("./eventDispatchers/mouseToolEventDispatcher.js");n.d(t,"mouseToolEventDispatcher",function(){return r.default});var o=n("./eventDispatchers/newImageEventDispatcher.js");n.d(t,"newImageEventDispatcher",function(){return o.default});var i=n("./eventDispatchers/touchToolEventDispatcher.js");n.d(t,"touchToolEventDispatcher",function(){return i.default})},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),i=n("./manipulators/index.js"),s=n("./util/logger.js"),l=n("./util/triggerEvent.js"),u=Object(s.getLogger)("eventDispatchers:mouseEventHandlers");t.default=function(e,t){u.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,s=n.element,d=t.createNewMeasurement(n);d&&(Object(o.addToolState)(s,t.name,d),r.default.cornerstone.updateImage(s),(1===Object.keys(d.handles).length?i.moveHandle:i.moveNewHandle)(n,t.name,d,d.handles.end,t.options,"mouse",function(e){if(!d.cancelled)if(e){var n=a.default.MEASUREMENT_COMPLETED,r={toolName:t.name,toolType:t.name,element:s,measurementData:d};Object(l.default)(s,n,r)}else Object(o.removeToolState)(s,t.name,d)}))}},"./eventDispatchers/mouseEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"mouseClick",function(){return l}),n.d(t,"mouseDoubleClick",function(){return u}),n.d(t,"mouseUp",function(){return d}),n.d(t,"mouseWheel",function(){return c});var a=n("./eventDispatchers/shared/customCallbackHandler.js"),r=n("./eventDispatchers/mouseEventHandlers/mouseDown.js");n.d(t,"mouseDown",function(){return r.default});var o=n("./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");n.d(t,"mouseDownActivate",function(){return o.default});var i=n("./eventDispatchers/mouseEventHandlers/mouseDrag.js");n.d(t,"mouseDrag",function(){return i.default});var s=n("./eventDispatchers/mouseEventHandlers/mouseMove.js");n.d(t,"mouseMove",function(){return s.default});var l=a.default.bind(null,"Mouse","mouseClickCallback"),u=a.default.bind(null,"Mouse","doubleClickCallback"),d=a.default.bind(null,"Mouse","mouseUpCallback"),c=a.default.bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./store/getToolsWithMoveableHandles.js"),i=n("./util/findAndMoveHelpers.js"),s=n("./store/getInteractiveToolsForElement.js"),l=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=e.detail.element,d=e.detail.currentPoints.canvas,c=Object(s.default)(n,a.getters.mouseTools()),f=c.filter(function(e){return"active"===e.mode&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(t.buttons)&&e.options.isMouseActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var m=f.find(function(e){return"function"==typeof e.preMouseDownCallback});if(m&&m.preMouseDownCallback(e))return}if(!a.state.isMultiPartToolActive){var g=Object(l.default)(n,c),h=Object(o.default)(n,g,d,"mouse");if(h.length>0){var v=h[0],p=Object(r.getToolState)(n,v.name),b=Object(i.findHandleDataNearImagePoint)(n,p,v.name,d);v.handleSelectedCallback(e,b.data,b.handle,"mouse")}else{var y=c.filter(function(e){var t=Object(r.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,d,"mouse")})});if(y.length>0){var x=y[0],j=Object(r.getToolState)(n,x.name).data.find(function(e){return x.pointNearTool(n,e,d)});x.toolSelectedCallback(e,j,"mouse")}else if(f.length>0){var w=f.find(function(e){return"function"==typeof e.postMouseDownCallback});if(w&&w.postMouseDownCallback(e))return}}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),r=n("./store/index.js"),o=n("./tools/base/BaseAnnotationTool.js"),i=n("./util/getActiveTool.js");t.default=function(e){if(!r.state.isToolLocked){var t=e.detail,n=t.element,s=t.buttons,l=Object(i.default)(n,s,"mouse");if(l){if("function"==typeof l.preMouseDownActivateCallback&&l.preMouseDownActivateCallback(e))return;r.state.isMultiPartToolActive||(l.addNewMeasurement?l.addNewMeasurement(e,"mouse"):l instanceof o.default&&Object(a.default)(e,l))}}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t,n=e.detail,i=n.element;t=(t=(t=Object(r.default)(i,a.getters.mouseTools())).filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(n.buttons)&&e.options.isMouseActive})).filter(function(e){return"function"==typeof e.mouseDragCallback}),a.state.isMultiPartToolActive&&(t=Object(o.default)(t)),0!==t.length&&t[0].mouseDragCallback(e)}}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./store/getInteractiveToolsForElement.js"),i=n("./store/getToolsWithDataForElement.js");t.default=function(e){if(!r.state.isToolLocked&&!r.state.isMultiPartToolActive){var t,n=e.detail,s=n.element;r.state.mousePositionImage=n.currentPoints.image;var l=(t=Object(o.default)(s,r.getters.mouseTools())).filter(function(e){return"active"===e.mode&&e.options.isMouseActive}),u=!1;l.length>0&&(u=l.some(function(e){return e.updateOnMouseMove})),t=Object(i.default)(s,t);for(var d=0;d<t.length;d++){var c=t[d];"function"==typeof c.mouseMoveCallback&&(u=c.mouseMoveCallback(e)||u)}!0===u&&a.default.cornerstone.updateImage(s)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./eventDispatchers/mouseEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.MOUSE_CLICK,r.mouseClick),e.addEventListener(a.default.MOUSE_DOWN,r.mouseDown),e.addEventListener(a.default.MOUSE_DOWN_ACTIVATE,r.mouseDownActivate),e.addEventListener(a.default.MOUSE_DOUBLE_CLICK,r.mouseDoubleClick),e.addEventListener(a.default.MOUSE_DRAG,r.mouseDrag),e.addEventListener(a.default.MOUSE_MOVE,r.mouseMove),e.addEventListener(a.default.MOUSE_UP,r.mouseUp),e.addEventListener(a.default.MOUSE_WHEEL,r.mouseWheel)},disable:function(e){e.removeEventListener(a.default.MOUSE_CLICK,r.mouseClick),e.removeEventListener(a.default.MOUSE_DOWN,r.mouseDown),e.removeEventListener(a.default.MOUSE_DOWN_ACTIVATE,r.mouseDownActivate),e.removeEventListener(a.default.MOUSE_DOUBLE_CLICK,r.mouseDoubleClick),e.removeEventListener(a.default.MOUSE_DRAG,r.mouseDrag),e.removeEventListener(a.default.MOUSE_MOVE,r.mouseMove),e.removeEventListener(a.default.MOUSE_UP,r.mouseUp),e.removeEventListener(a.default.MOUSE_WHEEL,r.mouseWheel)}}},"./eventDispatchers/newImageEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./externalModules.js"),o=function(e){if(a.state.isToolLocked)return!1;var t=e.detail.element,n=a.state.tools.filter(function(e){return e.element===t&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)});if(0===n.length)return!1;n.forEach(function(t){t.newImageCallback&&t.newImageCallback(e)})};t.default={enable:function(e){e.addEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,o)},disable:function(e){e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,o)}}},"./eventDispatchers/shared/customCallbackHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e,t,n){if(a.state.isToolLocked)return!1;var i=n.detail.element,s=a.state.tools.filter(function(t){return t.supportedInteractionTypes.includes(e)});if(s=(s=Object(r.default)(i,s,e)).filter(function(e){return"function"==typeof e[t]}),a.state.isMultiPartToolActive&&(s=Object(o.default)(s)),0===s.length)return!1;s[0][t](n)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./store/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),s=n("./manipulators/index.js"),l=n("./stateManagement/toolState.js"),u=n("./util/triggerEvent.js"),d=n("./util/logger.js"),c=Object(d.getLogger)("eventDispatchers:touchEventHandlers");t.default=function(e,t){c.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,d=n.element,f=t.createNewMeasurement(n);if(f){if(Object(l.addToolState)(d,t.name,f),1===Object.keys(f.handles).length&&n.type===a.default.TAP)return f.active=!1,f.handles.end.active=!1,f.handles.end.highlight=!1,f.invalidated=!0,(o.state.deleteIfHandleOutsideImage||t.options.deleteIfHandleOutsideImage)&&Object(i.default)(n,f.handles)&&Object(l.removeToolState)(d,t.name,f),void r.default.cornerstone.updateImage(d);r.default.cornerstone.updateImage(d),Object(s.moveNewHandle)(n,t.name,f,f.handles.end,t.options,"touch",function(){var e=a.default.MEASUREMENT_COMPLETED,n={toolName:t.name,toolType:t.name,element:d,measurementData:f};Object(u.default)(d,e,n)})}}},"./eventDispatchers/touchEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"doubleTap",function(){return l}),n.d(t,"touchDrag",function(){return u}),n.d(t,"touchEnd",function(){return d}),n.d(t,"touchPinch",function(){return c}),n.d(t,"touchPress",function(){return f}),n.d(t,"touchRotate",function(){return m});var a=n("./eventDispatchers/shared/customCallbackHandler.js"),r=n("./eventDispatchers/touchEventHandlers/multiTouchDrag.js");n.d(t,"multiTouchDrag",function(){return r.default});var o=n("./eventDispatchers/touchEventHandlers/tap.js");n.d(t,"tap",function(){return o.default});var i=n("./eventDispatchers/touchEventHandlers/touchStart.js");n.d(t,"touchStart",function(){return i.default});var s=n("./eventDispatchers/touchEventHandlers/touchStartActive.js");n.d(t,"touchStartActive",function(){return s.default});var l=a.default.bind(null,"DoubleTap","doubleTapCallback"),u=a.default.bind(null,"Touch","touchDragCallback"),d=a.default.bind(null,"Touch","touchEndCallback"),c=a.default.bind(null,"TouchPinch","touchPinchCallback"),f=a.default.bind(null,"Touch","touchPressCallback"),m=a.default.bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(a.state.isToolLocked)return!1;var t=e.detail,n=t.element,i=t.numPointers,s=a.state.tools.filter(function(e){return e.supportedInteractionTypes.includes("MultiTouch")});if(s=(s=Object(r.default)(n,s,"MultiTouch")).filter(function(e){return"function"==typeof e.multiTouchDragCallback&&i===e.configuration.touchPointers}),a.state.isMultiPartToolActive&&(s=Object(o.default)(s)),0===s.length)return!1;s[0].multiTouchDragCallback(e)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(e,t,n){"use strict";function a(e){Object.keys(e).forEach(function(t){e[t].active=!1})}n.r(t),t.default=function(e){if(e)for(var t=0;t<e.data.length;t++){var n=e.data[t];n.active=!1,n.handles&&a(n.handles)}}},"./eventDispatchers/touchEventHandlers/tap.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./eventDispatchers/touchEventHandlers/touchStartActive.js"),o=n("./store/index.js"),i=n("./store/getActiveToolsForElement.js"),s=n("./store/getToolsWithDataForElement.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/getHandleNearImagePoint.js"),d=n("./manipulators/index.js"),c=n("./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");t.default=function(e){if(!o.state.isToolLocked&&!o.state.isMultiPartToolActive){var t,n=e.detail.element,f=e.detail.currentPoints.canvas;t=Object(i.default)(n,o.getters.touchTools());var m=(t=Object(s.default)(n,t)).filter(function(e){for(var t=Object(l.getToolState)(n,e.name),a=0;a<t.data.length;a++)if(void 0!==Object(u.default)(n,t.data[a].handles,f,28))return!0;return!1});if(m.length>0){var g=m[0],h=Object(l.getToolState)(n,g.name),v=h.data.find(function(e){return void 0!==Object(u.default)(n,e.handles,f,28)});return h.data.active=!0,v.active=!0,a.default.cornerstone.updateImage(n),Object(d.moveHandle)(e.detail,g.name,h.data,v,g.options,"touch",function(){return Object(c.default)(h)}),e.stopImmediatePropagation(),void e.preventDefault()}var p=t.filter(function(e){var t=Object(l.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,f)})});if(p.length>0){var b=p[0],y=Object(l.getToolState)(n,b.name),x=y.data.find(function(e){return b.pointNearTool(n,e,f)});return x.active=!0,a.default.cornerstone.updateImage(n),Object(d.moveAllHandles)(e.detail,b.name,x,null,b.options,"touch",function(){return Object(c.default)(y)}),e.stopImmediatePropagation(),void e.preventDefault()}var j=Object(i.default)(n,o.getters.touchTools());return j.length>0&&j[0].touchStartActiveCallback?j[0].touchStartActiveCallback(e):Object(r.default)(e),!1}}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./util/findAndMoveHelpers.js"),o=n("./store/getToolsWithMoveableHandles.js"),i=n("./stateManagement/toolState.js"),s=n("./store/getInteractiveToolsForElement.js"),l=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=t.element,d=t.startPoints.canvas,c=Object(s.default)(n,a.getters.touchTools()),f=c.filter(function(e){return"active"===e.mode&&e.options.isTouchActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var m=f.find(function(e){return"function"==typeof e.preTouchStartCallback});if(m&&m.preTouchStartCallback(e))return}if(!a.state.isMultiPartToolActive){var g=Object(l.default)(n,c),h=Object(o.default)(n,g,d,"touch");if(h.length>0){var v=h[0],p=Object(i.getToolState)(n,v.name),b=Object(r.findHandleDataNearImagePoint)(n,p,v.name,d,"touch");v.handleSelectedCallback(e,b.data,b.handle,"touch")}else{var y=g.filter(function(e){var t=Object(i.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,d,"touch")})});if(y.length>0){var x=y[0],j=Object(i.getToolState)(n,x.name).data.find(function(e){return x.pointNearTool(n,e,d)});x.toolSelectedCallback(e,j,"touch")}else if(f.length>0){var w=f.find(function(e){return"function"==typeof e.postTouchStartCallback});if(w&&w.postTouchStartCallback(e))return}}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),o=n("./tools/base/BaseAnnotationTool.js"),i=n("./util/getActiveTool.js");t.default=function(e){if(!a.state.isToolLocked&&!a.state.isMultiPartToolActive){var t=e.detail.element,n=Object(i.default)(t,null,"touch");n&&n.addNewMeasurement?n.addNewMeasurement(e,"touch"):n instanceof o.default&&Object(r.default)(e,n)}}},"./eventDispatchers/touchToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./eventDispatchers/touchEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.TAP,r.tap),e.addEventListener(a.default.TOUCH_START,r.touchStart,{passive:!1}),e.addEventListener(a.default.TOUCH_DRAG,r.touchDrag,{passive:!1}),e.addEventListener(a.default.TOUCH_END,r.touchEnd),e.addEventListener(a.default.TOUCH_START_ACTIVE,r.touchStartActive),e.addEventListener(a.default.TOUCH_PRESS,r.touchPress),e.addEventListener(a.default.DOUBLE_TAP,r.doubleTap),e.addEventListener(a.default.TOUCH_PINCH,r.touchPinch),e.addEventListener(a.default.TOUCH_ROTATE,r.touchRotate),e.addEventListener(a.default.MULTI_TOUCH_DRAG,r.multiTouchDrag)},disable:function(e){e.removeEventListener(a.default.TAP,r.tap),e.removeEventListener(a.default.TOUCH_START,r.touchStart),e.removeEventListener(a.default.TOUCH_DRAG,r.touchDrag),e.removeEventListener(a.default.TOUCH_END,r.touchEnd),e.removeEventListener(a.default.TOUCH_START_ACTIVE,r.touchStartActive),e.removeEventListener(a.default.TOUCH_PRESS,r.touchPress),e.removeEventListener(a.default.DOUBLE_TAP,r.doubleTap),e.removeEventListener(a.default.TOUCH_PINCH,r.touchPinch),e.removeEventListener(a.default.TOUCH_ROTATE,r.touchRotate),e.removeEventListener(a.default.MULTI_TOUCH_DRAG,r.multiTouchDrag)}}},"./eventListeners/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/mouseEventListeners.js");n.d(t,"mouseEventListeners",function(){return a.default});var r=n("./eventListeners/wheelEventListener.js");n.d(t,"wheelEventListener",function(){return r.default});var o=n("./eventListeners/touchEventListeners.js");n.d(t,"touchEventListeners",function(){return o.default})},"./eventListeners/internals/normalizeWheel.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=0,n=0,a=0,r=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),a=10*t,r=10*n,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||r)&&e.deltaMode&&(1===e.deltaMode?(a*=40,r*=40):(a*=800,r*=800)),a&&!t&&(t=a<1?-1:1),r&&!n&&(n=r<1?-1:1),{spinX:t,spinY:n,pixelX:a,pixelY:r}}},"./eventListeners/internals/renderSegmentation.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/index.js"),r=n("./eventListeners/internals/renderSegmentationFill.js"),o=n("./eventListeners/internals/renderSegmentationOutline.js"),i=Object(a.getModule)("segmentation");function s(e,t,n,a,s){(function(e){var t=i.configuration;return t.renderFill&&(e&&0!==t.fillAlpha||!e&&0!==t.fillAlphaInactive)})(s)&&Object(r.default)(e,t,a,n,s),function(e){var t=i.configuration;return t.renderOutline&&(e&&0!==t.outlineAlpha||!e&&0!==t.outlineAlphaInactive)}(s)&&Object(o.default)(e,t,a,n,s)}},"./eventListeners/internals/renderSegmentationFill.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s}),n.d(t,"getLabelmapCanvas",function(){return l}),n.d(t,"renderFill",function(){return u});var a=n("./store/index.js"),r=n("./drawing/index.js"),o=n("./externalModules.js"),i=Object(a.getModule)("segmentation");function s(e,t,n,a,r){u(e,l(e,t,n),r)}function l(e,t,n){var a=e.detail.image,o=a.width,s=a.height,l=t.segmentsHidden,u=n.pixelData,d=i.state.colorLutTables[t.colorLUTIndex],c=document.createElement("canvas");c.width=o,c.height=s;for(var f=Object(r.getNewContext)(c),m=new ImageData(o,s),g=m.data,h=0;h<u.length;h++){var v=u[h];if(0!==v&&!l[v]){var p=d[u[h]];g[4*h]=p[0],g[4*h+1]=p[1],g[4*h+2]=p[2],g[4*h+3]=p[3]}}return f.putImageData(m,0,0),c}function u(e,t,n){var a=i.configuration,s=e.detail,l=Object(r.getNewContext)(s.canvasContext.canvas),u=o.default.cornerstone.pixelToCanvas(s.element,{x:0,y:0}),d=o.default.cornerstone.pixelToCanvas(s.element,{x:s.image.width,y:0}),c=o.default.cornerstone.pixelToCanvas(s.element,{x:s.image.width,y:s.image.height}),f=o.default.cornerstoneMath.point.distance(u,d),m=o.default.cornerstoneMath.point.distance(d,c),g=s.canvasContext.canvas,h=s.viewport,v=l.imageSmoothingEnabled,p=l.globalAlpha;l.imageSmoothingEnabled=!1,l.globalAlpha=n?a.fillAlpha:a.fillAlphaInactive,Object(r.transformCanvasContext)(l,g,h);var b=function(e){var t=e.viewport,n=e.image,a=t.scale,r=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?a*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(r*=n.rowPixelSpacing/n.columnPixelSpacing),{x:t.translation.x*a,y:t.translation.y*r}}(s);l.drawImage(t,g.width/2-f/2+b.x,g.height/2-m/2+b.y,f,m),l.globalAlpha=p,l.imageSmoothingEnabled=v,Object(r.resetCanvasContextTransform)(l)}},"./eventListeners/internals/renderSegmentationOutline.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s}),n.d(t,"renderOutline",function(){return l}),n.d(t,"getOutline",function(){return u}),n.d(t,"_addTopRightCorner",function(){return f});var a=n("./store/index.js"),r=n("./externalModules.js"),o=n("./drawing/index.js"),i=(n("./index.js"),Object(a.getModule)("segmentation"));function s(e,t,n,a,r){l(e,u(e,t,n,i.configuration.outlineWidth),t.colorLUTIndex,r)}function l(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=i.configuration,s=i.state,l=e.detail,u=l.element,d=l.canvasContext,c=r.outlineWidth||1,f=Object(o.getNewContext)(d.canvas),m=s.colorLutTables[n],g=f.globalAlpha;f.globalAlpha=a?r.outlineAlpha:r.outlineAlphaInactive,Object(o.draw)(f,function(e){for(var n=1;n<t.length;n++)if(t[n]){var a=m[n];Object(o.drawLines)(e,u,t[n],{color:"rgba(".concat(a[0],", ").concat(a[1],", ").concat(a[2],", 1.0 )"),lineWidth:c},"canvas")}}),f.globalAlpha=g}function u(e,t,n,a){var r=e.detail,o=r.element,i=r.image,s=r.viewport,l=i.width,u=i.height;a=a||1;var y=t.segmentsHidden,x=n.pixelData,j=t.activeSegmentIndex,w=[];n.segmentsOnLabelmap.forEach(function(e){!y[e]&&(w[e]=[])}),w[j]||(w[j]=[]);for(var T,E=function(e,t){var n=t/2,a=e.rotation;a*=Math.PI/180;var r=Math.cos(a),o=Math.sin(a),i=[r,o],s=[-o,r],l={x:n*i[0],y:n*i[1]},u={x:n*s[0],y:n*s[1]};return e.hflip&&(l.x*=-1,l.y*=-1),e.vflip&&(u.x*=-1,u.y*=-1),{i:l,j:u}}(s,a),O=0;O<x.length;O++){var C=x[O];if(0!==C&&!y[C]){var M={x:(T=O)%l,y:Math.floor(T/l)},I=d(M,u,l);void 0!==I.top&&x[I.top]===C||h(w[C],o,M,E),void 0!==I.bottom&&x[I.bottom]===C||v(w[C],o,M,E),void 0!==I.left&&x[I.left]===C||p(w[C],o,M,E),void 0!==I.right&&x[I.right]===C||b(w[C],o,M,E),void 0!==I.topLeft&&x[I.topLeft]!==C&&x[I.top]===C&&x[I.left]===C&&c(w[C],o,M,E),void 0!==I.topRight&&x[I.topRight]!==C&&x[I.top]===C&&x[I.right]===C&&f(w[C],o,M,E),void 0!==I.bottomLeft&&x[I.bottomLeft]!==C&&x[I.bottom]===C&&x[I.left]===C&&m(w[C],o,M,E),void 0!==I.bottomRight&&x[I.bottomRight]!==C&&x[I.bottom]===C&&x[I.right]===C&&g(w[C],o,M,E)}}return w}function d(e,t,n){var a=e.y*n+e.x,r={},o=e.y+1<t,i=e.x-1>=0,s=e.x+1<n;return e.y-1>=0&&(r.top=a-n,s&&(r.topRight=r.top+1),i&&(r.topLeft=r.top-1)),o&&(r.bottom=a+n,s&&(r.bottomRight=r.bottom+1),i&&(r.bottomLeft=r.bottom-1)),i&&(r.left=a-1),s&&(r.right=a+1),r}function c(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,n);o.x+=a.j.x,o.y+=a.j.y;var i={x:o.x,y:o.y};i.x+=2*a.i.x,i.y+=2*a.i.y,e.push({start:o,end:i})}function f(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,{x:n.x+1,y:n.y});o.x+=a.j.x,o.y+=a.j.y;var i={x:o.x,y:o.y};i.x-=2*a.i.x,i.y-=2*a.i.y,e.push({start:o,end:i})}function m(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,{x:n.x,y:n.y+1});o.x-=a.j.x,o.y-=a.j.y;var i={x:o.x,y:o.y};i.x+=2*a.i.x,i.y+=2*a.i.y,e.push({start:o,end:i})}function g(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,{x:n.x+1,y:n.y+1});o.x-=a.j.x,o.y-=a.j.y;var i={x:o.x,y:o.y};i.x-=2*a.i.x,i.y-=2*a.i.y,e.push({start:o,end:i})}function h(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,n),s=o(t,{x:n.x+1,y:n.y});i.x+=a.j.x,i.y+=a.j.y,s.x+=a.j.x,s.y+=a.j.y,e.push({start:i,end:s})}function v(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,{x:n.x,y:n.y+1}),s=o(t,{x:n.x+1,y:n.y+1});i.x-=a.j.x,i.y-=a.j.y,s.x-=a.j.x,s.y-=a.j.y,e.push({start:i,end:s})}function p(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,n),s=o(t,{x:n.x,y:n.y+1});i.x+=a.i.x,i.y+=a.i.y,s.x+=a.i.x,s.y+=a.i.y,e.push({start:i,end:s})}function b(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,{x:n.x+1,y:n.y}),s=o(t,{x:n.x+1,y:n.y+1});i.x-=a.i.x,i.y-=a.i.y,s.x-=a.i.x,s.y-=a.i.y,e.push({start:i,end:s})}},"./eventListeners/mouseEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,r=n("./events.js"),o=n("./externalModules.js"),i=n("./util/copyPoints.js"),s=n("./util/triggerEvent.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("eventListeners:mouseEventListeners"),d=!0,c=new Map;function f(e){if("number"==typeof e.buttons)return e.buttons;switch(e.which){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2}return 0}function m(){d=!1}function g(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){var a=r.default.MOUSE_DOUBLE_CLICK,l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var d=Object(i.default)(l);u.log("double-click: %o",f(e));var c={event:e,buttons:f(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:d,currentPoints:l,deltaPoints:{x:0,y:0},type:a};Object(s.default)(t,a,c)}}function h(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){a=setTimeout(m,200),t.removeEventListener("mousemove",v);var l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var g=Object(i.default)(l),h={event:e,buttons:f(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:g,currentPoints:l,deltaPoints:{x:0,y:0},type:r.default.MOUSE_DOWN};Object(s.default)(h.element,r.default.MOUSE_DOWN,h)&&(h.type=r.default.MOUSE_DOWN_ACTIVATE,Object(s.default)(h.element,r.default.MOUSE_DOWN_ACTIVATE,h)),document.addEventListener("mousemove",p),document.addEventListener("mouseup",b),c.set(p,"mousemove"),c.set(b,"mouseup")}function p(e){var a=r.default.MOUSE_DRAG,d={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=o.default.cornerstone.pixelToCanvas(t,d.image);var c={page:o.default.cornerstoneMath.point.subtract(d.page,g.page),image:o.default.cornerstoneMath.point.subtract(d.image,g.image),client:o.default.cornerstoneMath.point.subtract(d.client,g.client),canvas:o.default.cornerstoneMath.point.subtract(d.canvas,g.canvas)};u.log("mousemove: %o",f(e));var m={buttons:f(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:g,currentPoints:d,deltaPoints:c,type:a,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};Object(s.default)(m.element,a,m),g=Object(i.default)(d)}function b(e){clearTimeout(a);var i=r.default.MOUSE_UP;d&&(i=r.default.MOUSE_CLICK);var m={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};m.canvas=o.default.cornerstone.pixelToCanvas(t,m.image);var h={page:o.default.cornerstoneMath.point.subtract(m.page,g.page),image:o.default.cornerstoneMath.point.subtract(m.image,g.image),client:o.default.cornerstoneMath.point.subtract(m.client,g.client),canvas:o.default.cornerstoneMath.point.subtract(m.canvas,g.canvas)};u.log("mouseup: %o",f(e));var y={event:e,buttons:f(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:g,currentPoints:m,deltaPoints:h,type:i};Object(s.default)(y.element,i,y),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",b),c.delete(p),c.delete(b),t.addEventListener("mousemove",v),d=!0}}function v(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){var a=r.default.MOUSE_MOVE,l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var u=Object(i.default)(l),d={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=o.default.cornerstone.pixelToCanvas(t,d.image);var c={page:o.default.cornerstoneMath.point.subtract(d.page,u.page),image:o.default.cornerstoneMath.point.subtract(d.image,u.image),client:o.default.cornerstoneMath.point.subtract(d.client,u.client),canvas:o.default.cornerstoneMath.point.subtract(d.canvas,u.canvas)},f={viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:u,currentPoints:d,deltaPoints:c,type:a};Object(s.default)(t,a,f),u=Object(i.default)(d)}}function p(e){e.removeEventListener("mousedown",h),e.removeEventListener("mousemove",v),e.removeEventListener("dblclick",g),c.forEach(function(e,t){document.removeEventListener(e,t)}),c.clear()}t.default={enable:function(e){p(e),e.addEventListener("mousedown",h),e.addEventListener("mousemove",v),e.addEventListener("dblclick",g)},disable:p}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./eventListeners/internals/renderSegmentation.js"),o=Object(a.getModule)("segmentation");t.default=function(e){var t=o.configuration,n=o.getters.labelmaps3D(e.detail.element),a=n.activeLabelmapIndex,i=n.labelmaps3D,s=n.currentImageIdIndex;i&&(t.shouldRenderInactiveLabelmaps&&function(e,t,n,a){for(var o=0;o<t.length;o++){var i=t[o];if(o!==n&&i){var s=i.labelmaps2D[a];s&&Object(r.default)(e,i,o,s,!1)}}}(e,i,a,s),function(e,t,n,a){var o=t[n];if(o){var i=o.labelmaps2D[a];i&&Object(r.default)(e,o,n,i,!0)}}(e,i,a,s))}},"./eventListeners/preventGhostClick.js":function(e,t,n){"use strict";var a,r;function o(e,t){var n=Date.now();if(e!==a){if(n-r<=2e3)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;a=e}r=n}n.r(t);var i=o.bind(null,0),s=o.bind(null,1);function l(e,t,n){var a=n?i:s;t.forEach(function(t){e.addEventListener(t,a,{passive:!1})})}function u(e,t,n){var a=n?i:s;t.forEach(function(t){e.removeEventListener(t,a)})}var d=["mousedown","mouseup"],c=["touchstart","touchend"];function f(e){u(e,d,0),u(e,c,1)}t.default={enable:function(e){f(e),l(e,d,0),l(e,c,1)},disable:f}},"./eventListeners/touchEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,r,o,i,s,l,u,d,c,f=n("./events.js"),m=n("./externalModules.js"),g=n("./util/copyPoints.js"),h=n("./eventListeners/preventGhostClick.js"),v=n("./util/triggerEvent.js"),p=n("./toolOptions.js"),b=1,y=0,x=!1,j=!1,w="touchInput";function T(e){var t=e.currentTarget||e.srcEvent.currentTarget,n=m.default.cornerstone.getEnabledElement(t);if(n.image){var h,p,w,T;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(j=!1,clearTimeout(u)),e.type){case"tap":j=!1,clearTimeout(u),(r={page:m.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:m.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=m.default.cornerstone.pixelToCanvas(t,r.image),h=f.default.TAP,s={event:e,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:h,isTouchEvent:!0},Object(v.default)(t,h,s);break;case"doubletap":j=!1,clearTimeout(u),(r={page:m.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:m.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=m.default.cornerstone.pixelToCanvas(t,r.image),h=f.default.DOUBLE_TAP,s={event:e,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:h,isTouchEvent:!0},Object(v.default)(t,h,s);break;case"pinchstart":j=!1,clearTimeout(u),b=1;break;case"pinchmove":if(j=!1,clearTimeout(u),!0===x){b=e.scale,x=!1;break}p=(e.scale-b)/b,(a={page:e.center,image:m.default.cornerstone.pageToPixel(t,e.center.x,e.center.y)}).canvas=m.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_PINCH,s={event:e,startPoints:a,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,direction:e.scale<1?1:-1,scaleChange:p,type:h,isTouchEvent:!0},Object(v.default)(t,h,s),b=e.scale;break;case"touchstart":b=1,clearTimeout(u),clearTimeout(l),l=setTimeout(function(){(a={page:m.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:m.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=m.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_START,e.touches.length>1&&(h=f.default.MULTI_TOUCH_START),s={event:e,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:h,isTouchEvent:!0},!0===Object(v.default)(t,h,s)&&(h=f.default.TOUCH_START_ACTIVE,e.touches.length>1&&(h=f.default.MULTI_TOUCH_START_ACTIVE),s.type=h,Object(v.default)(t,h,s)),o=Object(g.default)(a)},50),j=!0,d=0,u=setTimeout(function(){j&&((r={page:m.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:m.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=m.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_PRESS,s={event:e,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:h,isTouchEvent:!0},Object(v.default)(t,h,s))},700);break;case"touchend":b=1,j=!1,clearTimeout(u),setTimeout(function(){(a={page:m.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:m.default.cornerstone.pageToPixel(t,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=m.default.cornerstone.pixelToCanvas(t,a.image),h=f.default.TOUCH_END,s={event:e,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:h,isTouchEvent:!0},Object(v.default)(t,h,s)},50);break;case"panmove":w={x:e.deltaX-c.x,y:e.deltaY-c.y},c={x:e.deltaX,y:e.deltaY},(r={page:{x:o.page.x+w.x,y:o.page.y+w.y},image:m.default.cornerstone.pageToPixel(t,o.page.x+w.x,o.page.y+w.y),client:{x:o.client.x+w.x,y:o.client.y+w.y}}).canvas=m.default.cornerstone.pixelToCanvas(t,r.image),i={page:m.default.cornerstoneMath.point.subtract(r.page,o.page),image:m.default.cornerstoneMath.point.subtract(r.image,o.image),client:m.default.cornerstoneMath.point.subtract(r.client,o.client),canvas:m.default.cornerstoneMath.point.subtract(r.canvas,o.canvas)},(d+=Math.sqrt(i.page.x*i.page.x+i.page.y*i.page.y))>5&&(j=!1,clearTimeout(u)),h=f.default.TOUCH_DRAG,e.pointers.length>1&&(h=f.default.MULTI_TOUCH_DRAG),s={viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:o,currentPoints:r,deltaPoints:i,numPointers:e.pointers.length,type:h,isTouchEvent:!0},Object(v.default)(t,h,s),o=Object(g.default)(r);break;case"panstart":c={x:e.deltaX,y:e.deltaY},(r={page:m.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:m.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=m.default.cornerstone.pixelToCanvas(t,r.image),o=Object(g.default)(r);break;case"panend":if(j=!1,clearTimeout(u),!o)return!1;(r={page:m.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:m.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=m.default.cornerstone.pixelToCanvas(t,r.image),i={page:m.default.cornerstoneMath.point.subtract(r.page,o.page),image:m.default.cornerstoneMath.point.subtract(r.image,o.image),client:m.default.cornerstoneMath.point.subtract(r.client,o.client),canvas:m.default.cornerstoneMath.point.subtract(r.canvas,o.canvas)},h=f.default.TOUCH_DRAG_END,s={event:e.srcEvent,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:o,currentPoints:r,deltaPoints:i,type:h,isTouchEvent:!0},Object(v.default)(t,h,s),2==e.pointers.length-e.changedPointers.length&&(x=!0);break;case"rotatemove":j=!1,clearTimeout(u),T=e.rotation-y,y=e.rotation,h=f.default.TOUCH_ROTATE,s={event:e.srcEvent,viewport:m.default.cornerstone.getViewport(t),image:n.image,element:t,rotation:T,type:h},Object(v.default)(t,h,s)}return!1}}function E(e){h.default.disable(e),["touchstart","touchend"].forEach(function(t){e.removeEventListener(t,T)});var t=Object(p.getToolOptions)(w,e),n=t.hammer;n&&(n.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",T),n.input.destroy()),t.hammer=null,Object(p.clearToolOptions)(w,e)}t.default={enable:function(e){E(e);var t=m.default.Hammer,n=new t.Manager(e,{inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput}),a=new t.Pan({pointers:0,direction:t.DIRECTION_ALL,threshold:0}),r=new t.Pinch({threshold:0}),o=new t.Rotate({threshold:0});r.recognizeWith(a),r.recognizeWith(o),o.recognizeWith(a);var i=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});i.recognizeWith(a),n.add([i,a,o,r]),n.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",T),h.default.enable(e),["touchstart","touchend"].forEach(function(t){e.addEventListener(t,T,{passive:!1})});var s=Object(p.getToolOptions)(w,e);s.hammer=n,Object(p.setToolOptions)(w,e,s)},disable:E}},"./eventListeners/wheelEventListener.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./util/triggerEvent.js"),i=n("./eventListeners/internals/normalizeWheel.js");function s(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image&&!(e.deltaY>-1&&e.deltaY<1)){e.preventDefault();var s=e.pageX,l=e.pageY,u=r.default.cornerstone.pageToPixel(t,s,l),d=Object(i.default)(e),c=d.spinX,f=d.spinY,m=d.pixelX,g=d.pixelY,h=f<0?-1:1,v={element:t,viewport:r.default.cornerstone.getViewport(t),detail:e,image:n.image,direction:h,spinX:c,spinY:f,pixelX:m,pixelY:g,pageX:s,pageY:l,imageX:u.x,imageY:u.y};Object(o.default)(t,a.default.MOUSE_WHEEL,v)}}function l(e){e.removeEventListener("wheel",s,{passive:!1})}t.default={enable:function(e){l(e),e.addEventListener("wheel",s,{passive:!1})},disable:l}},"./eventListeners/windowResizeHandler.js":function(e,t,n){"use strict";n.r(t),n.d(t,"forceEnabledElementResize",function(){return l});var a,r=n("./store/index.js"),o=n("./externalModules.js"),i=function(){window.removeEventListener("resize",s,!1)};function s(){a||(a=setTimeout(function(){a=null,l()},66))}var l=function(){r.state.enabledElements.forEach(function(e){o.default.cornerstone.resize(e)})};t.default={enable:function(){i(),window.addEventListener("resize",s,!1)},disable:i}},"./events.js":function(e,t,n){"use strict";n.r(t),t.default={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_COMPLETED:"cornerstonetoolsmeasurementcompleted",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll",STACK_PREFETCH_IMAGE_LOADED:"cornerstonetoolsstackprefetchimageloaded",STACK_PREFETCH_DONE:"cornerstonetoolsstackprefetchdone",LABELMAP_MODIFIED:"cornersontetoolslabelmapmodified"}},"./externalModules.js":function(e,t,n){"use strict";n.r(t);var a=window.cornerstone,r=window.cornerstoneMath,o=window.Hammer;t.default={set cornerstone(e){a=e},get cornerstone(){return a},set cornerstoneMath(e){r=e},get cornerstoneMath(){return r},set Hammer(e){o=e},get Hammer(){return o}}},"./importInternal.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js");t.default=function(e){return a.lib[e]}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/index.js");n.d(t,"AngleTool",function(){return a.AngleTool}),n.d(t,"ArrowAnnotateTool",function(){return a.ArrowAnnotateTool}),n.d(t,"BidirectionalTool",function(){return a.BidirectionalTool}),n.d(t,"CircleRoiTool",function(){return a.CircleRoiTool}),n.d(t,"CobbAngleTool",function(){return a.CobbAngleTool}),n.d(t,"EllipticalRoiTool",function(){return a.EllipticalRoiTool}),n.d(t,"FreehandRoiTool",function(){return a.FreehandRoiTool}),n.d(t,"LengthTool",function(){return a.LengthTool}),n.d(t,"ProbeTool",function(){return a.ProbeTool}),n.d(t,"RectangleRoiTool",function(){return a.RectangleRoiTool}),n.d(t,"TextMarkerTool",function(){return a.TextMarkerTool});var r=n("./tools/segmentation/index.js");n.d(t,"BrushTool",function(){return r.BrushTool}),n.d(t,"SphericalBrushTool",function(){return r.SphericalBrushTool}),n.d(t,"RectangleScissorsTool",function(){return r.RectangleScissorsTool}),n.d(t,"FreehandScissorsTool",function(){return r.FreehandScissorsTool}),n.d(t,"CircleScissorsTool",function(){return r.CircleScissorsTool}),n.d(t,"CorrectionScissorsTool",function(){return r.CorrectionScissorsTool});var o=n("./tools/index.js");n.d(t,"CrosshairsTool",function(){return o.CrosshairsTool}),n.d(t,"DoubleTapFitToWindowTool",function(){return o.DoubleTapFitToWindowTool}),n.d(t,"DragProbeTool",function(){return o.DragProbeTool}),n.d(t,"EraserTool",function(){return o.EraserTool}),n.d(t,"FreehandRoiSculptorTool",function(){return o.FreehandRoiSculptorTool}),n.d(t,"MagnifyTool",function(){return o.MagnifyTool}),n.d(t,"OverlayTool",function(){return o.OverlayTool}),n.d(t,"OrientationMarkersTool",function(){return o.OrientationMarkersTool}),n.d(t,"PanMultiTouchTool",function(){return o.PanMultiTouchTool}),n.d(t,"PanTool",function(){return o.PanTool}),n.d(t,"ReferenceLinesTool",function(){return o.ReferenceLinesTool}),n.d(t,"RotateTool",function(){return o.RotateTool}),n.d(t,"RotateTouchTool",function(){return o.RotateTouchTool}),n.d(t,"ScaleOverlayTool",function(){return o.ScaleOverlayTool}),n.d(t,"StackScrollMouseWheelTool",function(){return o.StackScrollMouseWheelTool}),n.d(t,"StackScrollMultiTouchTool",function(){return o.StackScrollMultiTouchTool}),n.d(t,"StackScrollTool",function(){return o.StackScrollTool}),n.d(t,"WwwcRegionTool",function(){return o.WwwcRegionTool}),n.d(t,"WwwcTool",function(){return o.WwwcTool}),n.d(t,"ZoomMouseWheelTool",function(){return o.ZoomMouseWheelTool}),n.d(t,"ZoomTool",function(){return o.ZoomTool}),n.d(t,"ZoomTouchPinchTool",function(){return o.ZoomTouchPinchTool});var i=n("./init.js");n.d(t,"init",function(){return i.default});var s=n("./stackTools/stackPrefetch.js");n.d(t,"stackPrefetch",function(){return s.default});var l=n("./stackTools/stackRenderers.js");n.d(t,"stackRenderers",function(){return l.default});var u=n("./stackTools/playClip.js");n.d(t,"playClip",function(){return u.playClip}),n.d(t,"stopClip",function(){return u.stopClip});var d=n("./store/index.js");n.d(t,"store",function(){return d.default}),n.d(t,"getModule",function(){return d.getModule});var c=n("./store/getToolForElement.js");n.d(t,"getToolForElement",function(){return c.default});var f=n("./store/addTool.js");n.d(t,"addTool",function(){return f.addTool}),n.d(t,"addToolForElement",function(){return f.addToolForElement});var m=n("./store/removeTool.js");n.d(t,"removeTool",function(){return m.removeTool}),n.d(t,"removeToolForElement",function(){return m.removeToolForElement});var g=n("./store/setToolOptions.js");n.d(t,"setToolOptions",function(){return g.setToolOptions}),n.d(t,"setToolOptionsForElement",function(){return g.setToolOptionsForElement});var h=n("./store/setToolMode.js");n.d(t,"setToolActive",function(){return h.setToolActive}),n.d(t,"setToolActiveForElement",function(){return h.setToolActiveForElement}),n.d(t,"setToolEnabled",function(){return h.setToolEnabled}),n.d(t,"setToolEnabledForElement",function(){return h.setToolEnabledForElement}),n.d(t,"setToolDisabled",function(){return h.setToolDisabled}),n.d(t,"setToolDisabledForElement",function(){return h.setToolDisabledForElement}),n.d(t,"setToolPassive",function(){return h.setToolPassive}),n.d(t,"setToolPassiveForElement",function(){return h.setToolPassiveForElement});var v=n("./store/isToolActiveForElement.js");n.d(t,"isToolActiveForElement",function(){return v.default});var p=n("./stateManagement/toolState.js");n.d(t,"addToolState",function(){return p.addToolState}),n.d(t,"getToolState",function(){return p.getToolState}),n.d(t,"removeToolState",function(){return p.removeToolState}),n.d(t,"clearToolState",function(){return p.clearToolState}),n.d(t,"setElementToolStateManager",function(){return p.setElementToolStateManager}),n.d(t,"getElementToolStateManager",function(){return p.getElementToolStateManager});var b=n("./stateManagement/textStyle.js");n.d(t,"textStyle",function(){return b.default});var y=n("./stateManagement/toolStyle.js");n.d(t,"toolStyle",function(){return y.default});var x=n("./stateManagement/toolColors.js");n.d(t,"toolColors",function(){return x.default});var j=n("./stateManagement/toolCoordinates.js");n.d(t,"toolCoordinates",function(){return j.default});var w=n("./stateManagement/stackSpecificStateManager.js");n.d(t,"stackSpecificStateManager",function(){return w.stackSpecificStateManager}),n.d(t,"newStackSpecificToolStateManager",function(){return w.newStackSpecificToolStateManager}),n.d(t,"addStackStateManager",function(){return w.addStackStateManager});var T=n("./stateManagement/loadHandlerManager.js");n.d(t,"loadHandlerManager",function(){return T.default});var E=n("./stateManagement/imageIdSpecificStateManager.js");n.d(t,"newImageIdSpecificToolStateManager",function(){return E.newImageIdSpecificToolStateManager}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return E.globalImageIdSpecificToolStateManager});var O=n("./stateManagement/frameOfReferenceStateManager.js");n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return O.newFrameOfReferenceSpecificToolStateManager}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return O.globalFrameOfReferenceSpecificToolStateManager});var C=n("./eventListeners/windowResizeHandler.js");n.d(t,"forceEnabledElementResize",function(){return C.forceEnabledElementResize});var M=n("./orientation/index.js");n.d(t,"orientation",function(){return M.default});var I=n("./util/SaveAs.js");n.d(t,"SaveAs",function(){return I.default});var S=n("./util/logger.js");n.d(t,"enableLogger",function(){return S.enable}),n.d(t,"disableLogger",function(){return S.disable});var P=n("./thirdParty/register.js");n.d(t,"register",function(){return P.default});var D=n("./thirdParty/registerSome.js");n.d(t,"registerSome",function(){return D.default});var _=n("./synchronization/wwwcSynchronizer.js");n.d(t,"wwwcSynchronizer",function(){return _.default});var L=n("./synchronization/updateImageSynchronizer.js");n.d(t,"updateImageSynchronizer",function(){return L.default});var k=n("./synchronization/Synchronizer.js");n.d(t,"Synchronizer",function(){return k.default});var A=n("./synchronization/stackScrollSynchronizer.js");n.d(t,"stackScrollSynchronizer",function(){return A.default});var R=n("./synchronization/stackImagePositionSynchronizer.js");n.d(t,"stackImagePositionSynchronizer",function(){return R.default});var B=n("./synchronization/stackImagePositionOffsetSynchronizer.js");n.d(t,"stackImagePositionOffsetSynchronizer",function(){return B.default});var H=n("./synchronization/stackImageIndexSynchronizer.js");n.d(t,"stackImageIndexSynchronizer",function(){return H.default});var F=n("./synchronization/panZoomSynchronizer.js");n.d(t,"panZoomSynchronizer",function(){return F.default});var U=n("./requestPool/requestPoolManager.js");n.d(t,"requestPoolManager",function(){return U.default});var N=n("./externalModules.js");n.d(t,"external",function(){return N.default});var V=n("./events.js");n.d(t,"EVENTS",function(){return V.default});var z=n("./version.js");n.d(t,"version",function(){return z.default});var q=n("./importInternal.js");n.d(t,"importInternal",function(){return q.default}),n.d(t,"import",function(){return q.default}),t.default={AngleTool:a.AngleTool,ArrowAnnotateTool:a.ArrowAnnotateTool,BidirectionalTool:a.BidirectionalTool,CircleRoiTool:a.CircleRoiTool,CobbAngleTool:a.CobbAngleTool,EllipticalRoiTool:a.EllipticalRoiTool,FreehandRoiTool:a.FreehandRoiTool,LengthTool:a.LengthTool,ProbeTool:a.ProbeTool,RectangleRoiTool:a.RectangleRoiTool,TextMarkerTool:a.TextMarkerTool,BrushTool:r.BrushTool,SphericalBrushTool:r.SphericalBrushTool,RectangleScissorsTool:r.RectangleScissorsTool,FreehandScissorsTool:r.FreehandScissorsTool,CircleScissorsTool:r.CircleScissorsTool,CorrectionScissorsTool:r.CorrectionScissorsTool,CrosshairsTool:o.CrosshairsTool,DoubleTapFitToWindowTool:o.DoubleTapFitToWindowTool,DragProbeTool:o.DragProbeTool,EraserTool:o.EraserTool,FreehandRoiSculptorTool:o.FreehandRoiSculptorTool,MagnifyTool:o.MagnifyTool,OverlayTool:o.OverlayTool,OrientationMarkersTool:o.OrientationMarkersTool,PanMultiTouchTool:o.PanMultiTouchTool,PanTool:o.PanTool,ReferenceLinesTool:o.ReferenceLinesTool,RotateTool:o.RotateTool,RotateTouchTool:o.RotateTouchTool,ScaleOverlayTool:o.ScaleOverlayTool,StackScrollMouseWheelTool:o.StackScrollMouseWheelTool,StackScrollMultiTouchTool:o.StackScrollMultiTouchTool,StackScrollTool:o.StackScrollTool,WwwcRegionTool:o.WwwcRegionTool,WwwcTool:o.WwwcTool,ZoomMouseWheelTool:o.ZoomMouseWheelTool,ZoomTool:o.ZoomTool,ZoomTouchPinchTool:o.ZoomTouchPinchTool,init:i.default,stackPrefetch:s.default,stackRenderers:l.default,playClip:u.playClip,stopClip:u.stopClip,store:d.default,getModule:d.getModule,getToolForElement:c.default,addTool:f.addTool,addToolForElement:f.addToolForElement,removeTool:m.removeTool,removeToolForElement:m.removeToolForElement,setToolOptions:g.setToolOptions,setToolOptionsForElement:g.setToolOptionsForElement,isToolActiveForElement:v.default,setToolActive:h.setToolActive,setToolActiveForElement:h.setToolActiveForElement,setToolEnabled:h.setToolEnabled,setToolEnabledForElement:h.setToolEnabledForElement,setToolDisabled:h.setToolDisabled,setToolDisabledForElement:h.setToolDisabledForElement,setToolPassive:h.setToolPassive,setToolPassiveForElement:h.setToolPassiveForElement,addToolState:p.addToolState,getToolState:p.getToolState,removeToolState:p.removeToolState,clearToolState:p.clearToolState,setElementToolStateManager:p.setElementToolStateManager,getElementToolStateManager:p.getElementToolStateManager,textStyle:b.default,toolStyle:y.default,toolColors:x.default,toolCoordinates:j.default,stackSpecificStateManager:w.stackSpecificStateManager,newStackSpecificToolStateManager:w.newStackSpecificToolStateManager,addStackStateManager:w.addStackStateManager,loadHandlerManager:T.default,newImageIdSpecificToolStateManager:E.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:E.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:O.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:O.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:C.forceEnabledElementResize,orientation:M.default,SaveAs:I.default,enableLogger:S.enable,disableLogger:S.disable,importInternal:q.default,import:q.default,register:P.default,registerSome:D.default,wwwcSynchronizer:_.default,updateImageSynchronizer:L.default,Synchronizer:k.default,stackScrollSynchronizer:A.default,stackImagePositionSynchronizer:R.default,stackImagePositionOffsetSynchronizer:B.default,stackImageIndexSynchronizer:H.default,panZoomSynchronizer:F.default,requestPoolManager:U.default,external:N.default,EVENTS:V.default,version:z.default}},"./init.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./store/internals/addEnabledElement.js"),i=n("./store/internals/removeEnabledElement.js"),s=n("./eventListeners/windowResizeHandler.js");function l(){!function(){var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_DISABLED;e.events.removeEventListener(e.EVENTS.ELEMENT_ENABLED,o.default),e.events.removeEventListener(t,i.default)}();var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_DISABLED;e.events.addEventListener(e.EVENTS.ELEMENT_ENABLED,o.default),e.events.addEventListener(t,i.default)}function u(){var e=r.default.modules;Object.keys(e).forEach(function(t){"function"==typeof e[t].onRegisterCallback&&e[t].onRegisterCallback()})}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(),u();var t=Object(r.getModule)("globalConfiguration");Array.isArray(e)?e.forEach(function(e){var t=e.moduleName,n=e.configuration,a=Object(r.getModule)(t);a&&(a.configuration=Object.assign({},a.configuration,n))}):t.configuration=Object.assign({},t.configuration,e),t.configuration.autoResizeViewports&&s.default.enable()}},"./lib.js":function(e,t,n){"use strict";n.r(t),n.d(t,"lib",function(){return $});var a=n("./tools/base/BaseTool.js"),r=n("./tools/base/BaseAnnotationTool.js"),o=n("./tools/base/BaseBrushTool.js"),i=n("./manipulators/index.js"),s=n("./util/findAndMoveHelpers.js"),l=n("./mixins/index.js"),u=n("./tools/cursors/index.js"),d=n("./drawing/index.js"),c=n("./util/clip.js"),f=n("./util/debounce.js"),m=n("./util/deepmerge.js"),g=n("./util/getDefault.js"),h=n("./util/getPixelSpacing.js"),v=n("./util/isEmptyObject.js"),p=n("./util/isObject.js"),b=n("./util/isPointInImage.js"),y=n("./util/isPointInPolygon.js"),x=n("./util/throttle.js"),j=n("./util/wait.js"),w=n("./util/getKeyPressData.js"),T=n("./drawing/drawTextBox.js"),E=n("./drawing/drawArrow.js"),O=n("./drawing/drawLink.js"),C=n("./drawing/drawLinkedTextBox.js"),M=n("./drawing/drawHandles.js"),I=n("./util/getActiveTool.js"),S=n("./util/getLuminance.js"),P=n("./util/getROITextBoxCoords.js"),D=n("./util/copyPoints.js"),_=n("./util/calculateSUV.js"),L=n("./util/setContextToDisplayFontSize.js"),k=n("./util/scrollToIndex.js"),A=n("./util/scroll.js"),R=n("./util/roundToDecimal.js"),B=n("./util/pointProjector.js"),H=n("./util/lineSegDistance.js"),F=n("./util/logger.js"),U=n("./util/pointInsideBoundingBox.js"),N=n("./util/makeUnselectable.js"),V=n("./util/getRGBPixels.js"),z=n("./util/getMaxSimultaneousRequests.js"),q=n("./util/angleBetweenPoints.js"),W=n("./util/numbersWithCommas.js"),G=n("./tools/cursors/MouseCursor.js"),Y=n("./util/ellipse/index.js"),X=n("./util/freehand/index.js"),J=n("./util/segmentation/index.js"),Z=n("./util/zoom/index.js"),K=n("./util/triggerEvent.js"),Q=n("./util/convertToVector3.js"),$={"base/BaseTool":a.default,"base/BaseAnnotationTool":r.default,"base/BaseBrushTool":o.default,"tools/cursors/MouseCursor":G.default,"tools/cursors":u,"manipulators/anyHandlesOutsideImage":i.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":i.getHandleNearImagePoint,"manipulators/handleActivator":i.handleActivator,"manipulators/moveAllHandles":i.moveAllHandles,"manipulators/moveHandle":i.moveHandle,"manipulators/moveNewHandle":i.moveNewHandle,"manipulators/moveHandleNearImagePoint":s.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":s.findHandleDataNearImagePoint,"manipulators/moveAnnotation":s.moveAnnotation,"mixins/activeOrDisabledBinaryTool":l.default.activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":l.default.enabledOrDisabledBinaryTool,"drawing/getNewContext":d.getNewContext,"drawing/draw":d.draw,"drawing/path":d.path,"drawing/setShadow":d.setShadow,"drawing/drawLine":d.drawLine,"drawing/drawLines":d.drawLines,"drawing/drawJoinedLines":d.drawJoinedLines,"drawing/drawCircle":d.drawCircle,"drawing/drawEllipse":d.drawEllipse,"drawing/drawRect":d.drawRect,"drawing/fillOutsideRect":d.fillOutsideRect,"drawing/drawTextBox":T.default,"drawing/drawArrow":E.default,"drawing/fillBox":d.fillBox,"drawing/fillTextLines":d.fillTextLines,"drawing/drawLink":O.default,"drawing/drawLinkedTextBox":C.default,"drawing/drawHandles":M.default,"drawing/textBoxWidth":T.textBoxWidth,"util/getActiveTool":I.default,"util/getLuminance":S.default,"util/getROITextBoxCoords":P.default,"util/copyPoints":D.default,"util/calculateSUV":_.default,"util/setContextToDisplayFontSize":L.default,"util/scrollToIndex":k.default,"util/scroll":A.default,"util/roundToDecimal":R.default,"util/projectPatientPointToImagePlane":B.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":B.imagePointToPatientPoint,"util/planePlaneIntersection":B.planePlaneIntersection,"util/pointInsideBoundingBox":U.default,"util/makeUnselectable":N.default,"util/getRGBPixels":V.default,"util/getDefaultSimultaneousRequests":z.getDefaultSimultaneousRequests,"util/getMaxSimultaneousRequests":z.getMaxSimultaneousRequests,"util/getBrowserInfo":z.getBrowserInfo,"util/isMobileDevice":z.isMobileDevice,"util/angleBetweenPoints":q.default,"util/numbersWithCommas":W.default,"util/lineSegDistance":H.default,"util/triggerEvent":K.default,"util/convertToVector3":Q.default,"util/clip":c.clip,"util/clipToBox":c.clipToBox,"util/debounce":f.default,"util/deepmerge":m.default,"util/getDefault":g.default,"util/getPixelSpacing":h.default,"util/isEmptyObject":v.default,"util/isObject":p.default,"util/isPointInImage":b.default,"util/isPointInPolygon":y.default,"util/getLogger":F.getLogger,"util/throttle":x.default,"util/wait":j.wait,"util/waitForEnabledElementImageToLoad":j.waitForEnabledElementImageToLoad,"util/getKeyPressData":w.default,"util/ellipseUtils":Y.default,"util/freehandUtils":X.default,"util/segmentationUtils":J,"util/zoomUtils":Z.default}},"./manipulators/anyHandlesOutsideImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=e.image,r={left:0,top:0,width:n.width,height:n.height},o=!1;return Object.keys(t).forEach(function(e){var n=t[e];!0!==n.allowedOutsideImage&&!1===a.default.cornerstoneMath.point.insideRect(n,r)&&(o=!0)}),o}},"./manipulators/getHandleNearImagePoint.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./util/pointInsideBoundingBox.js"),s=function(e,t,n,a){if(e.hasOwnProperty("pointNearHandle")){if(e.pointNearHandle(t,e,n))return!0}else if(!0===e.hasBoundingBox){if(Object(i.default)(e,n))return!0}else{var r=o.default.cornerstone.pixelToCanvas(t,e);if(o.default.cornerstoneMath.point.distance(r,n)<=a)return!0}return!1};t.default=function e(t,n,a,o){var i;if(n){if(Array.isArray(n))for(var l=Object.keys(n),u=0;u<l.length;u++){var d=n[l[u]];if(d.hasOwnProperty("x")&&d.hasOwnProperty("y")&&s(d,t,a,o)){i=d;break}}else if("object"===r()(n))for(var c=Object.keys(n),f=0;f<c.length;f++){var m=c[f];if(Array.isArray(n[m])){if(i=e(t,n[m],a,o))break}else{var g=n[m];if(s(g,t,a,o)){i=g;break}}}return i}}},"./manipulators/handleActivator.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n,r){r||(r=6);var o=function(e){var t;return Object.keys(e).forEach(function(n){var a=e[n];!0!==a.active||(t=a)}),t}(t),i=Object(a.default)(e,t,n,r);return o!==i&&(void 0!==i&&(i.active=!0),void 0!==o&&(o.active=!1),!0)}},"./manipulators/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/anyHandlesOutsideImage.js");n.d(t,"anyHandlesOutsideImage",function(){return a.default});var r=n("./manipulators/getHandleNearImagePoint.js");n.d(t,"getHandleNearImagePoint",function(){return r.default});var o=n("./manipulators/handleActivator.js");n.d(t,"handleActivator",function(){return o.default});var i=n("./manipulators/moveAllHandles.js");n.d(t,"moveAllHandles",function(){return i.default});var s=n("./manipulators/moveHandle.js");n.d(t,"moveHandle",function(){return s.default});var l=n("./manipulators/moveNewHandle.js");n.d(t,"moveNewHandle",function(){return l.default})},"./manipulators/moveAllHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),d=n("./util/getActiveTool.js"),c=n("./tools/base/BaseAnnotationTool.js"),f=n("./util/logger.js"),m=Object(f.getLogger)("manipulators:moveAllHandles"),g=Object(u.getModule)("manipulatorState"),h={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},v={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,u=i.detail,f=u.element,m=u.image,g=u.buttons,h=i.detail.deltaPoints.image,v=h.x,p=h.y;t.active=!0,t.invalidated=!0;for(var b=Object.keys(t.handles),y=0;y<b.length;y++){var x=b[y],j=t.handles[x];!0!==j.movesIndependently&&j.hasOwnProperty("x")&&j.hasOwnProperty("y")&&(j.x+=v,j.y+=p,n.preventHandleOutsideImage&&Object(l.clipToBox)(j,m))}r.default.cornerstone.updateImage(f);var w=Object(d.default)(f,g,o);w instanceof c.default&&w.updateCachedStats(m,f,t);var T=a.default.MEASUREMENT_MODIFIED,E={toolName:e,toolType:e,element:f,measurementData:t};Object(s.default)(f,T,E),i.preventDefault(),i.stopPropagation()}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=a.dragHandler,o=a.upOrEndHandler,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;x(e,t,n,{dragHandler:r,upOrEndHandler:o},i,s,!1)}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=r.dragHandler,l=r.upOrEndHandler,u=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,c=u.detail,f=c.element;g.setters.removeActiveManipulatorForElement(f),n.deleteIfHandleOutsideImage&&Object(o.default)(c,t.handles)&&Object(i.removeToolState)(f,e,t),x(t,n,a,{dragHandler:s,upOrEndHandler:l},f,d,!0)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=a.dragHandler,i=a.upOrEndHandler,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,d=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];e.active=!1,e.invalidated=!0,u.state.isToolLocked=!1,h[n].forEach(function(e){s.removeEventListener(e,o)}),v[n].forEach(function(e){s.removeEventListener(e,i)}),"function"==typeof t.doneMovingCallback&&(m.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(d)),"function"==typeof l&&l(d),r.default.cornerstone.updateImage(s)}t.default=function(e,t,n,a){var r=e.element,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",s=arguments.length>6?arguments[6]:void 0;o=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},o);var l=p.bind(this,t,n,o,i),d=function e(a){y(t,n,o,i,{dragHandler:l,upOrEndHandler:e},a,s)};g.setters.addActiveManipulatorForElement(r,b.bind(null,n,o,i,{dragHandler:l,upOrEndHandler:d},r,s)),n.active=!0,u.state.isToolLocked=!0,h[i].forEach(function(e){r.addEventListener(e,l)}),v[i].forEach(function(e){r.addEventListener(e,d)})}},"./manipulators/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),d=n("./util/getActiveTool.js"),c=n("./tools/base/BaseAnnotationTool.js"),f=n("./util/logger.js"),m=Object(f.getLogger)("manipulators:moveHandle"),g=Object(u.getModule)("manipulatorState"),h={value:!1},v={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},p={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function b(e,t,n,o,i,u){var f=u.detail,m=f.image,g=f.element,v=f.buttons,p=f.currentPoints.page,b=r.default.cornerstone.pageToPixel(g,p.x,"touch"===i?p.y+-57:p.y);h.value=!1,n.active=!0,n.hasMoved=!0,n.x=b.x,n.y=b.y,t.invalidated=!0,o.preventHandleOutsideImage&&Object(l.clipToBox)(n,m),r.default.cornerstone.updateImage(g);var y=Object(d.default)(g,v,i);y instanceof c.default&&y.updateCachedStats(m,g,t);var x=a.default.MEASUREMENT_MODIFIED,j={toolName:e,toolType:e,element:g,measurementData:t};Object(s.default)(g,x,j)}function y(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,s=i.dragHandler,l=i.upOrEndHandler,u=arguments.length>7?arguments[7]:void 0;j(e,t,n,a,r,o,{dragHandler:s,upOrEndHandler:l},u,!1)}function x(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,s=i.dragHandler,l=i.upOrEndHandler,u=arguments.length>7?arguments[7]:void 0,d=t.element;g.setters.removeActiveManipulatorForElement(d),j(e,t,n,a,r,o,{dragHandler:s,upOrEndHandler:l},u,!0)}function j(e,t,n,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,c=d.dragHandler,f=d.upOrEndHandler,g=arguments.length>7?arguments[7]:void 0,b=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],y=t.element;a.active=!1,a.moving=!1,n.active=!1,n.invalidated=!0,h.value=!1,u.state.isToolLocked=!1,v[l].forEach(function(e){y.removeEventListener(e,c)}),p[l].forEach(function(e){y.removeEventListener(e,f)}),s.deleteIfHandleOutsideImage&&Object(o.default)(t,n.handles)&&Object(i.removeToolState)(y,e,n),"function"==typeof s.doneMovingCallback&&(m.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),s.doneMovingCallback(b)),"function"==typeof g&&g(b),r.default.cornerstone.updateImage(y)}function w(e,t,n,a){if(t.value){var o=Math.abs(e.y-a.y),i=o/10;if(o<1)return e.y=a.y,void(t.value=!1);e.y>a.y?e.y-=i:e.y<a.y&&(e.y+=i),r.default.cornerstone.updateImage(n.element),r.default.cornerstone.requestAnimationFrame(function(){w(e,t,n,a)})}}t.default=function(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",s=arguments.length>6?arguments[6]:void 0;o=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},o);var l=e.element,d=b.bind(this,t,n,a,o,i),c=function r(){x(t,e,n,a,o,i,{dragHandler:d,upOrEndHandler:r},s)};if(g.setters.addActiveManipulatorForElement(l,y.bind(null,t,e,n,a,o,i,{dragHandler:d,upOrEndHandler:c},s)),a.active=!0,a.moving=!0,n.active=!0,u.state.isToolLocked=!0,v[i].forEach(function(e){l.addEventListener(e,d)}),p[i].forEach(function(e){l.addEventListener(e,c)}),"touch"===i){h.value=!0;var f=r.default.cornerstone.getEnabledElement(l),m=-57,j={x:e.currentPoints.page.x,y:e.currentPoints.page.y+m},T=r.default.cornerstone.pageToPixel(l,j.x,j.y);w(a,h,f,T)}}},"./manipulators/moveNewHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),d=n("./util/getActiveTool.js"),c=n("./tools/base/BaseAnnotationTool.js"),f=n("./util/logger.js"),m=Object(f.getLogger)("manipulators:moveNewHandle"),g=Object(u.getModule)("manipulatorState"),h={mouse:[a.default.MOUSE_MOVE,a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},v={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_PINCH,a.default.TAP]};function p(e,t,n,o,i,u){var f=u.detail,m=f.currentPoints,g=f.image,h=f.element,v=f.buttons;o.hasMoved=!0;var p=m.page,b=r.default.cornerstone.pageToPixel(h,"touch"===i?p.x+-57:p.x,"touch"===i?p.y+-57:p.y);t.invalidated=!0,n.active=!0,n.x=b.x,n.y=b.y,o&&o.preventHandleOutsideImage&&Object(l.clipToBox)(n,g),r.default.cornerstone.updateImage(h);var y=Object(d.default)(h,v,i);y instanceof c.default&&y.updateCachedStats(g,h,t);var x=a.default.MEASUREMENT_MODIFIED,j={toolName:e,toolType:e,element:h,measurementData:t};Object(s.default)(h,x,j)}function b(e,t,n,o,i){var s=o.moveHandler,l=o.moveEndHandler,d=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];h[e].forEach(function(e){n.removeEventListener(e,s)}),v[e].forEach(function(e){n.removeEventListener(e,l)}),n.removeEventListener(a.default.TOUCH_START,j),u.state.isToolLocked=!1,"function"==typeof i&&i(d),"function"==typeof t.doneMovingCallback&&(m.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(d)),r.default.cornerstone.updateImage(n)}function y(e,t,n,a,s,u,d,c){var f=u.moveHandler,m=u.moveEndHandler,h=d.detail,v=h.element,p=!0;if(!1!==a.hasMoved){var y=h.currentPoints.page,x=r.default.cornerstone.pageToPixel(v,"touch"===s?y.x+-57:y.x,"touch"===s?y.y+-57:y.y);t.active=!1,t.invalidated=!0,n.active=!1,n.moving=!1,n.x=x.x,n.y=x.y,g.setters.removeActiveManipulatorForElement(v),a.preventHandleOutsideImage&&Object(l.clipToBox)(n,d.detail.image),a.deleteIfHandleOutsideImage&&Object(o.default)(d.detail,t.handles)&&(t.cancelled=!0,p=!1,Object(i.removeToolState)(v,e,t)),b(s,a,v,{moveHandler:f,moveEndHandler:m},c,p)}}function x(e,t,n,a,r,o,i){var s=r.moveHandler,l=r.moveEndHandler;e.active=!1,e.invalidated=!0,t.active=!1,b(a,n,o,{moveHandler:s,moveEndHandler:l},i,!1)}function j(e){return e.stopImmediatePropagation(),!1}t.default=function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",s=arguments.length>6?arguments[6]:void 0;(o=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},o)).hasMoved=!1;var l=e.element;function d(e){p(t,n,r,o,i,e)}function c(e){y(t,n,r,o,i,{moveHandler:d,moveEndHandler:c},e,s)}n.active=!0,r.moving=!0,r.active=!0,u.state.isToolLocked=!0,h[i].forEach(function(e){l.addEventListener(e,d)}),l.addEventListener(a.default.TOUCH_START,j),v[i].forEach(function(e){l.addEventListener(e,c)}),g.setters.addActiveManipulatorForElement(l,x.bind(null,n,r,o,i,{moveHandler:d,moveEndHandler:c},l,s))}},"./mixins/activeOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},enabledCallback:function(e){Object(a.setToolActiveForElement)(e,this.name)}}},"./mixins/enabledOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},activeCallback:function(e){Object(a.setToolEnabledForElement)(e,this.name)}}},"./mixins/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./mixins/activeOrDisabledBinaryTool.js"),r=n("./mixins/enabledOrDisabledBinaryTool.js"),o=n("./mixins/segmentation/circleSegmentationMixin.js"),i=n("./mixins/segmentation/polylineSegmentationMixin.js"),s=n("./mixins/segmentation/freehandSegmentationMixin.js"),l=n("./mixins/segmentation/rectangleSegmentationMixin.js"),u=n("./mixins/segmentation/renderBrushMixin.js");t.default={activeOrDisabledBinaryTool:a.default,enabledOrDisabledBinaryTool:r.default,circleSegmentationMixin:o.default,polylineSegmentationMixin:i.default,freehandSegmentationMixin:s.default,rectangleSegmentationMixin:l.default,renderBrushMixin:u.default}},"./mixins/segmentation/circleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/index.js"),r=n("./externalModules.js"),o=n("./util/isEmptyObject.js"),i=n("./store/index.js"),s=n("./util/segmentation/index.js"),l=Object(i.getModule)("segmentation"),u=l.getters,d=l.setters;function c(){this.handles={start:{},end:{}}}function f(e){var t=e.detail.element,n=e.detail.currentPoints.image;return Object(o.default)(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),r.default.cornerstone.updateImage(t),!0}function m(e){var t=e.detail,n=t.element;this.handles.end=t.currentPoints.image,r.default.cornerstone.updateImage(n)}function g(e){e.detail.handles=this.handles;var t=e.detail.element,n=u.labelmap2D(t),a=n.labelmap2D,o=n.labelmap3D,i=n.currentImageIdIndex,l=a.pixelData,c=l.slice();this.applyActiveStrategy(e,{points:{start:{x:this.handles.start.x,y:this.handles.start.y},end:{x:this.handles.end.x,y:this.handles.end.y}},pixelData:l,segmentIndex:o.activeSegmentIndex,segmentationMixinType:"circleSegmentationMixin"});var f={imageIdIndex:i,diff:Object(s.getDiffBetweenPixelData)(c,l)};d.pushState(this.element,[f]),d.updateSegmentsOnLabelmap2D(a),r.default.cornerstone.updateImage(t),this._resetHandles()}t.default={postTouchStartCallback:f,postMouseDownCallback:f,mouseClickCallback:f,touchDragCallback:m,mouseDragCallback:m,mouseMoveCallback:m,touchEndCallback:g,mouseUpCallback:g,initializeMixin:c,renderToolData:function(e){var t=this,n=e.detail,o=n.element,i=u.brushColor(o,!0),s=Object(a.getNewContext)(n.canvasContext.canvas),l=r.default.cornerstoneMath.point.distance;Object(a.draw)(s,function(e){if(!t.handles)return null;var n=r.default.cornerstone.pixelToCanvas(o,t.handles.start),s=r.default.cornerstone.pixelToCanvas(o,t.handles.end),u=l(n,s);Object(a.drawCircle)(e,o,t.handles.start,u,{color:i})})},_resetHandles:c,_applyStrategy:g}},"./mixins/segmentation/freehandSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./util/logger.js"),l=n("./drawing/index.js"),u=n("./util/segmentation/index.js"),d=Object(s.getLogger)("tools:ScissorsTool"),c=Object(i.getModule)("segmentation"),f=c.getters,m=c.setters;function g(e){var t=e.detail.element,n=e.detail.currentPoints.image,a=this.handles.points;if(!a.length)return d.warn("Something went wrong, empty handles detected."),null;a.push({x:n.x,y:n.y,lines:[]}),this.currentHandle+=1,o.default.cornerstone.updateImage(t)}function h(e){var t=e.detail.element;this._addPoint(e.detail),o.default.cornerstone.updateImage(t)}function v(e){var t=this.handles.points,n=e.detail.element,a=f.labelmap2D(n),r=a.labelmap2D,i=a.labelmap3D,s=a.currentImageIdIndex,l=r.pixelData,d=l.slice();this.applyActiveStrategy(e,{points:t,pixelData:l,segmentIndex:i.activeSegmentIndex,segmentationMixinType:"freehandSegmentationMixin"});var c={imageIdIndex:s,diff:Object(u.getDiffBetweenPixelData)(d,l)};m.pushState(this.element,[c]),m.updateSegmentsOnLabelmap2D(r),o.default.cornerstone.updateImage(n),this._resetHandles()}function p(){this.handles={points:[]},this.currentHandle=0}t.default={postTouchStartCallback:g,postMouseDownCallback:g,mouseClickCallback:g,touchDragCallback:h,mouseDragCallback:h,mouseMoveCallback:h,touchEndCallback:v,mouseUpCallback:v,initializeMixin:p,renderToolData:function(e){var t=e.detail,n=t.element,a=f.brushColor(n,!0),o=Object(l.getNewContext)(t.canvasContext.canvas),i=this.handles.points;i.length<2||Object(l.draw)(o,function(e){for(var t=0;t<i.length;t++){var o=r()(i[t].lines);t===i.length-1&&o.push(i[0]),Object(l.drawJoinedLines)(e,n,i[t],o,{color:a})}})},_resetHandles:p,_addPoint:function(e){var t=this.handles.points;t.length&&t[this.currentHandle-1].lines.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),t.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),this.currentHandle+=1,o.default.cornerstone.updateImage(e.element)},_applyStrategy:v}},"./mixins/segmentation/polylineSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./drawing/index.js"),i=n("./store/index.js"),s=n("./mixins/segmentation/freehandSegmentationMixin.js"),l=Object(i.getModule)("segmentation").getters,u=Object.assign({},s.default,{renderToolData:function(e){var t=this,n=e.detail,a=n.element,i=l.brushColor(a,!0),s=Object(o.getNewContext)(n.canvasContext.canvas),u=this.handles;Object(o.draw)(s,function(e){if(u.points.length>1)for(var n=0;n<u.points.length;n++){var s=r()(u.points[n].lines);Object(o.drawJoinedLines)(e,a,t.handles.points[n],s,{color:i})}})}});t.default=u},"./mixins/segmentation/rectangleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/index.js"),r=n("./externalModules.js"),o=n("./util/isEmptyObject.js"),i=n("./store/index.js"),s=n("./util/segmentation/index.js"),l=Object(i.getModule)("segmentation"),u=l.getters,d=l.setters;function c(e){var t=e.detail.element,n=e.detail.currentPoints.image;return Object(o.default)(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),r.default.cornerstone.updateImage(t),!0}function f(e){var t=e.detail,n=t.element;this.handles.end=t.currentPoints.image,r.default.cornerstone.updateImage(n)}function m(e){e.detail.handles=this.handles;var t=e.detail.element,n=u.labelmap2D(t),a=n.labelmap2D,o=n.labelmap3D,i=n.currentImageIdIndex,l=a.pixelData,c=l.slice();this.applyActiveStrategy(e,{points:[{x:this.handles.start.x,y:this.handles.start.y},{x:this.handles.end.x,y:this.handles.end.y}],pixelData:l,segmentIndex:o.activeSegmentIndex,segmentationMixinType:"rectangleSegmentationMixin"});var f={imageIdIndex:i,diff:Object(s.getDiffBetweenPixelData)(c,l)};d.pushState(this.element,[f]),d.updateSegmentsOnLabelmap2D(a),r.default.cornerstone.updateImage(t),this._resetHandles()}function g(){this.handles={start:{},end:{}}}t.default={postTouchStartCallback:c,postMouseDownCallback:c,mouseClickCallback:c,touchDragCallback:f,mouseDragCallback:f,mouseMoveCallback:f,touchEndCallback:m,mouseUpCallback:m,initializeMixin:g,renderToolData:function(e){var t=this,n=e.detail,r=n.element,o=u.brushColor(r,!0),i=Object(a.getNewContext)(n.canvasContext.canvas);Object(a.draw)(i,function(e){Object(a.drawRect)(e,r,t.handles.start,t.handles.end,{color:o})})},_resetHandles:g,_applyStrategy:m}},"./mixins/segmentation/renderBrushMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js");t.default={renderBrush:function(e){var t,n=a.default.cornerstone,o=Object(r.getModule)("segmentation"),i=o.getters,s=o.configuration,l=e.detail,u=l.viewport;if(this._drawing?t=this._lastImageCoords:this._mouseUpRender?(t=this._lastImageCoords,this._mouseUpRender=!1):t=r.default.state.mousePositionImage,t){var d=l.image,c=t.x,f=t.y;if(!(c<0||c>d.columns||f<0||f>d.rows)){var m=s.radius,g=l.canvasContext,h=l.element,v=i.brushColor(h,this._drawing);g.setTransform(1,0,0,1,0,0);var p=m*u.scale,b=n.pixelToCanvas(h,t);g.beginPath(),g.strokeStyle=v,g.ellipse(b.x,b.y,p,p,0,0,2*Math.PI),g.stroke()}}}}},"./orientation/getOrientationString.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/convertToVector3.js");t.default=function(e){for(var t=Object(r.default)(e),n="",o=t.x<0?"R":"L",i=t.y<0?"A":"P",s=t.z<0?"F":"H",l=new a.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),u=1e-4,d=0;d<3;d++)if(l.x>u&&l.x>l.y&&l.x>l.z)n+=o,l.x=0;else if(l.y>u&&l.y>l.x&&l.y>l.z)n+=i,l.y=0;else if(l.z>u&&l.z>l.x&&l.z>l.y)n+=s,l.z=0;else if(l.x>u&&l.y>u&&l.x===l.y)n+=o+i,l.x=0,l.y=0;else if(l.x>u&&l.z>u&&l.x===l.z)n+=o+s,l.x=0,l.z=0;else{if(!(l.y>u&&l.z>u&&l.y===l.z))break;n+=i+s,l.y=0,l.z=0}return n}},"./orientation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./orientation/getOrientationString.js"),r=n("./orientation/invertOrientationString.js");t.default={getOrientationString:a.default,invertOrientationString:r.default}},"./orientation/invertOrientationString.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.replace("H","f");return(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},"./requestPool/requestPoolManager.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/getMaxSimultaneousRequests.js"),o={interaction:[],thumbnail:[],prefetch:[]},i={interaction:0,thumbnail:0,prefetch:0},s={interaction:6,thumbnail:6,prefetch:5},l=!1;function u(){l&&setTimeout(function(){c()},20)}function d(e){var t=a.default.cornerstone,n=e.type;i[n]++,l=!0;var r=e.imageId,o=e.doneCallback,s=e.failCallback,d=t.imageCache.getImageLoadObject(r);if(d)d.promise.then(function(e){i[n]--,o(e),u()},function(e){i[n]--,s(e),u()});else{var c=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e),f=Object.assign({},e.options,{priority:c,type:e.type});(!0===e.preventCache?t.loadImage(r,f):t.loadAndCacheImage(r,f)).then(function(e){i[n]--,o(e),u()},function(e){i[n]--,s(e),u()})}}function c(){var e=Object(r.getMaxSimultaneousRequests)();s={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=e-(i.interaction+i.thumbnail+i.prefetch),n=0;n<t;n++){var a=o.interaction.length&&i.interaction<s.interaction?o.interaction.shift():o.thumbnail.length&&i.thumbnail<s.thumbnail?o.thumbnail.shift():o.prefetch.length&&i.prefetch<s.prefetch?o.prefetch.shift():(o.interaction.length||o.thumbnail.length||o.prefetch.length||(l=!1),!1);a&&d(a)}}t.default={addRequest:function(e,t,n,r,i,s,u){var d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!o.hasOwnProperty(n))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var c={type:n,imageId:t,preventCache:r,doneCallback:i,failCallback:s,options:d},f=a.default.cornerstone.imageCache.getImageLoadObject(t);f?f.promise.then(function(e){i(e)},function(e){s(e)}):(u?o[n].unshift(c):o[n].push(c),l=!0)}},clearRequestStack:function(e){if(!o.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");o[e]=[]},startGrabbing:c,getRequestPool:function(){return o}}},"./stackTools/fusionRenderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./externalModules.js"),l=n("./stateManagement/toolState.js"),u=function(){function e(){r()(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return i()(e,[{key:"render",value:function(e,t){var n=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");t||(t=Object(l.getToolState)(e,"stack").data);var a=s.default.cornerstone,r=t[0],o=r.imageIds[this.currentImageIdIndex],i=t.slice(1,t.length);a.loadAndCacheImage(o).then(function(t){var s=n.layerIds[0];s?a.setLayerImage(e,t,s):(s=a.addLayer(e,t,r.options),n.layerIds.push(s)),a.displayImage(e,t),i.forEach(function(t,r){var i=n.findImageFn(t.imageIds,o),l=n.layerIds[r+1];l||(l=a.addLayer(e,void 0,t.options),n.layerIds.push(l)),i?a.loadAndCacheImage(i).then(function(t){a.setLayerImage(e,t,l),a.updateImage(e)}):(a.setLayerImage(e,void 0,l),a.setActiveLayer(e,s),a.updateImage(e))})})}}]),e}()},"./stackTools/playClip.js":function(e,t,n){"use strict";n.r(t),n.d(t,"playClip",function(){return d}),n.d(t,"stopClip",function(){return c});var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l="playClip";function u(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function d(e,t){var n,d;if(void 0===e)throw new Error("playClip: element must not be undefined");var c=Object(i.getToolState)(e,"stack");if(c&&c.data&&c.data.length){var f,m=r.default.cornerstone;if(c.data.length>1){var g=Object(i.getToolState)(e,"stackRenderer");g&&g.data&&g.data.length&&(f=g.data[0])}var h=c.data[0],v=Object(i.getToolState)(e,l);v&&v.data&&v.data.length?u(n=v.data[0]):(n={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},Object(i.addToolState)(e,l,n)),(t<0||t>0)&&(n.framesPerSecond=Number(t),n.reverse=n.framesPerSecond<0,n.ignoreFrameTimeVector=!0),!0!==n.ignoreFrameTimeVector&&n.frameTimeVector&&n.frameTimeVector.length===h.imageIds.length&&(d=function(e,t){var n,a,r,o=0,i=e.length,s=[];for(s.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),n=1;n<i;n++)r=Number(e[n])/t|0,s.push(r),1===n?a=r:r!==a&&(s.isTimeVarying=!0),o+=r;return s.length>0&&s.push(r=s.isTimeVarying?o/s.length|0:s[0]),s}(n.frameTimeVector,n.speed));var p=function(){var t,r,i,l=h.currentImageIdIndex,d=h.imageIds.length;if(n.reverse?l--:l++,!n.loop&&(l<0||l>=d))return u(n),void function(e){var t={element:e};Object(s.default)(e,a.default.CLIP_STOPPED,t)}(e);l>=d&&(l=0),l<0&&(l=d-1),l!==h.currentImageIdIndex&&(t=o.default.getStartLoadHandler(e),r=o.default.getEndLoadHandler(e),i=o.default.getErrorLoadingHandler(e),t&&t(e),(!0===h.preventCache?m.loadImage(h.imageIds[l]):m.loadAndCacheImage(h.imageIds[l])).then(function(t){try{h.currentImageIdIndex=l,f?(f.currentImageIdIndex=l,f.render(e,c.data)):m.displayImage(e,t),r&&r(e,t)}catch(n){return}},function(t){i&&i(e,h.imageIds[l],t)}))};d&&d.length>0&&d.isTimeVarying?(n.usingFrameTimeVector=!0,n.intervalId=setTimeout(function e(){n.intervalId=setTimeout(e,d[h.currentImageIdIndex]),p()},0)):(n.usingFrameTimeVector=!1,n.intervalId=setInterval(p,1e3/Math.abs(n.framesPerSecond)))}}function c(e){var t=Object(i.getToolState)(e,l);t&&t.data&&t.data.length&&u(t.data[0])}},"./stackTools/stackPrefetch.js":function(e,t,n){"use strict";n.r(t);var a,r=n("./externalModules.js"),o=n("./requestPool/requestPoolManager.js"),i=n("./stateManagement/loadHandlerManager.js"),s=n("./stateManagement/toolState.js"),l=n("./util/getMaxSimultaneousRequests.js"),u=n("./util/logger.js"),d=n("./util/triggerEvent.js"),c=n("./events.js"),f=Object(u.getLogger)("stackTools:stackPrefetch"),m="stackPrefetch",g="prefetch",h={maxImagesToPrefetch:1/0,preserveExistingPool:!1};function v(e,t){e=Math.round(e)||0;var n=[],a=(t=Math.round(t)||0)-e+1;if(a<=0)return n;for(;a--;)n[a]=t--;return n}var p=function(e){return Math.max.apply(null,e)},b=function(e){return Math.min.apply(null,e)};function y(e){var t=Object(s.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0],a=Object(s.getToolState)(e,m);if(a){var l=a.data[0]||{};if(l.indicesToRequest&&l.indicesToRequest.length||(l.enabled=!1),!1!==l.enabled&&(a.data[0].indicesToRequest.sort(function(e,t){return e-t}),l.indicesToRequest.slice().forEach(function(e){var t=n.imageIds[e];t&&r.default.cornerstone.imageCache.getImageLoadObject(t)&&R(e)}),l.indicesToRequest.length)){h.preserveExistingPool||o.default.clearRequestStack(g);for(var u,v,y,x,j,w,T=(v=n.currentImageIdIndex,y=[],x=[],(u=l.indicesToRequest).forEach(function(e){e<v?y.push(e):e>v&&x.push(e)}),{low:u.indexOf(p(y)),high:u.indexOf(b(x))}),E=i.default.getErrorLoadingHandler(e),O=T.low,C=T.high,M=[];O>=0||C<l.indicesToRequest.length;){var I=n.currentImageIdIndex,S=!(I-l.indicesToRequest[O]>h.maxImagesToPrefetch)&&O>=0,P=!(l.indicesToRequest[C]-I>h.maxImagesToPrefetch)&&C<l.indicesToRequest.length;if(!P&&!S)break;S&&(w=l.indicesToRequest[O--],M.push(j=n.imageIds[w])),P&&(w=l.indicesToRequest[C++],M.push(j=n.imageIds[w]))}var D=!0,_=!1,L=void 0;try{for(var k,A=M.reverse()[Symbol.iterator]();!(D=(k=A.next()).done);D=!0)o.default.addRequest(e,k.value,g,!1,B,H,!0)}catch(F){_=!0,L=F}finally{try{D||null==A.return||A.return()}finally{if(_)throw L}}o.default.startGrabbing()}}}function R(e){var t=l.indicesToRequest.indexOf(e);t>-1&&l.indicesToRequest.splice(t,1)}function B(t){f.log("prefetch done: %s",t.imageId);var a=n.imageIds.indexOf(t.imageId);R(a),Object(d.default)(e,c.default.STACK_PREFETCH_IMAGE_LOADED,{element:e,imageId:t.imageId,imageIndex:a,stackPrefetch:l,stack:n}),l.indicesToRequest&&l.indicesToRequest.length>0||Object(d.default)(e,c.default.STACK_PREFETCH_DONE,{element:e,stackPrefetch:l,stack:n})}function H(t){f.log("prefetch errored: %o",t),E&&E(e,j,t,"stackPrefetch")}}function x(e){return function(t){var n,a=t.detail;try{n=Object(s.getToolState)(e,"stack")}catch(i){return}if(n&&n.data&&n.data.length){var r=n.data[0].imageIds.indexOf(a.imageId);if(!(r<0)){var o=Object(s.getToolState)(e,m);o&&o.data&&o.data.length&&o.data[0].indicesToRequest.push(r)}}}}function j(e){clearTimeout(a),a=setTimeout(function(){var t=e.target;try{y(t)}catch(n){return}},10)}t.default={enable:function(e){Object(s.getToolState)(e,m).data=[];var t=Object(s.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];if(!0!==n.preventCache){var a={indicesToRequest:v(0,n.imageIds.length-1),enabled:!0,direction:1},o=a.indicesToRequest.indexOf(n.currentImageIdIndex);a.indicesToRequest.splice(o,1),Object(s.addToolState)(e,m,a),y(e),e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,j),e.addEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,j);var i=x(e);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,i),r.default.cornerstone.events.addEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,i)}else f.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(e){clearTimeout(a),e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,j);var t=x(e);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,t);var n=Object(s.getToolState)(e,m);n&&n.data.length&&(n.data[0].enabled=!1,o.default.clearRequestStack(g))},getConfiguration:function(){return h},setConfiguration:function(e){h=e,e.maxSimultaneousRequests&&Object(l.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}}},"./stackTools/stackRenderers.js":function(e,t,n){"use strict";n.r(t);var a=n("./stackTools/fusionRenderer.js"),r={};r.FusionRenderer=a.default,t.default=r},"./stateManagement/frameOfReferenceStateManager.js":function(e,t,n){"use strict";function a(){var e={};return{get:function(t,n){if(!1!==e.hasOwnProperty(t)){var a=e[t];if(!1!==a.hasOwnProperty(n))return a[n]}},add:function(t,n,a){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(n)&&(r[n]={data:[]}),r[n].data.push(a)},remove:function(t,n,a){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(n)){for(var o=r[n],i=-1,s=0;s<o.data.length;s++)o.data[s]===a&&(i=s);-1!==i&&o.data.splice(i,1)}}}}}n.r(t),n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return a}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return r});var r=a()},"./stateManagement/imageIdSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"newImageIdSpecificToolStateManager",function(){return r}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return o});var a=n("./externalModules.js");function r(){var e={};function t(t,n,a){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(n)&&(r[n]={data:[]}),r[n].data.push(a)}function n(t,n){if(!1!==e.hasOwnProperty(t)){var a=e[t];if(!1!==a.hasOwnProperty(n))return a[n]}}function r(t,n,a){e[t][n]=a}function o(t){!1!==e.hasOwnProperty(t)&&delete e[t]}return{get:function(e,t){var r=a.default.cornerstone.getEnabledElement(e);if(r.image)return n(r.image.imageId,t)},add:function(e,n,r){var o=a.default.cornerstone.getEnabledElement(e);o.image&&t(o.image.imageId,n,r)},set:function(e,t,n){var o=a.default.cornerstone.getEnabledElement(e);o.image&&r(o.image.imageId,t,n)},clear:function(e){var t=a.default.cornerstone.getEnabledElement(e);t.image&&o(t.image.imageId)},getImageIdToolState:n,addImageIdToolState:t,setImageIdToolState:r,clearImageIdToolState:o,saveImageIdToolState:function(t){return e[t]},restoreImageIdToolState:function(t,n){e[t]=n},saveToolState:function(){return e},restoreToolState:function(t){e=t},toolState:e}}var o=r()},"./stateManagement/loadHandlerManager.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r={},o={},i={};function s(e){if(!e)return"DEFAULT";var t=a.default.cornerstone.getEnabledElement(e).uuid;if(!t)throw new Error("Something went wrong when getting uuid from element");return t}t.default={setStartLoadHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=s(t);r[n]=e},getStartLoadHandler:function(e){var t=s(e);return r[t]||r.DEFAULT},setEndLoadHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=s(t);o[n]=e},getEndLoadHandler:function(e){var t=s(e);return o[t]||o.DEFAULT},setErrorLoadingHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=s(t);i[n]=e},getErrorLoadingHandler:function(e){var t=s(e);return i[t]||i.DEFAULT},removeHandlers:function(e){var t=s(e);delete r[t],delete o[t],delete i[t]}}},"./stateManagement/stackSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"stackSpecificStateManager",function(){return l}),n.d(t,"newStackSpecificToolStateManager",function(){return o}),n.d(t,"addStackStateManager",function(){return s});var a=n("./stateManagement/imageIdSpecificStateManager.js"),r=n("./stateManagement/toolState.js");function o(e,t){var n={};return{get:function(a,r){return e.indexOf(r)>=0?(!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r]):t.get(a,r)},add:function(a,r,o){if(!(e.indexOf(r)>=0))return t.add(a,r,o);!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r].data.push(o)},saveToolState:function(){return n},restoreToolState:function(e){n=e},toolState:n}}var i=[];function s(e,t){var n=Object(r.getElementToolStateManager)(e);n||(n=a.globalImageIdSpecificToolStateManager);var s=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(s=s.concat(t));var l=o(s,n);i.push(l),Object(r.setElementToolStateManager)(e,l)}var l={newStackSpecificToolStateManager:o,addStackStateManager:s}},"./stateManagement/textStyle.js":function(e,t,n){"use strict";n.r(t);var a=15,r="".concat(a,"px Arial"),o="transparent";t.default={setFont:function(e){r=e},getFont:function(){return r},setFontSize:function(e){a=e},getFontSize:function(){return a},setBackgroundColor:function(e){o=e},getBackgroundColor:function(){return o}}},"./stateManagement/toolColors.js":function(e,t,n){"use strict";n.r(t);var a="white",r="greenyellow",o="transparent";t.default={setFillColor:function(e){o=e},getFillColor:function(){return o},setToolColor:function(e){a=e},getToolColor:function(){return a},setActiveColor:function(e){r=e},getActiveColor:function(){return r},getColorIfActive:function(e){return e.color?e.color:e.active?r:a}}},"./stateManagement/toolCoordinates.js":function(e,t,n){"use strict";var a;n.r(t),t.default={setCoords:function(e){a=e.currentPoints.canvas},getCoords:function(){return a}}},"./stateManagement/toolState.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addToolState",function(){return u}),n.d(t,"getToolState",function(){return d}),n.d(t,"removeToolState",function(){return c}),n.d(t,"clearToolState",function(){return f}),n.d(t,"setElementToolStateManager",function(){return m}),n.d(t,"getElementToolStateManager",function(){return l});var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/imageIdSpecificStateManager.js"),i=n("./util/triggerEvent.js"),s=n("./util/uuidv4.js");function l(e){var t=r.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=o.globalImageIdSpecificToolStateManager),t.toolStateManager}function u(e,t,n){var r=l(e);n.uuid=n.uuid||Object(s.default)(),r.add(e,t,n);var o=a.default.MEASUREMENT_ADDED,u={toolName:t,toolType:t,element:e,measurementData:n};Object(i.default)(e,o,u)}function d(e,t){return l(e).get(e,t)}function c(e,t,n){var r=l(e).get(e,t);if(r&&r.data&&r.data.length){for(var o=-1,s=0;s<r.data.length;s++)r.data[s]===n&&(o=s);if(-1!==o){r.data.splice(o,1);var u=a.default.MEASUREMENT_REMOVED,d={toolName:t,toolType:t,element:e,measurementData:n};Object(i.default)(e,u,d)}}}function f(e,t){var n=l(e).get(e,t);void 0!==n&&(n.data=[])}function m(e,t){r.default.cornerstone.getEnabledElement(e).toolStateManager=t}},"./stateManagement/toolStyle.js":function(e,t,n){"use strict";n.r(t);var a=1,r=2;t.default={setToolWidth:function(e){a=e},getToolWidth:function(){return a},setActiveWidth:function(e){r=e},getActiveWidth:function(){return r}}},"./store/addTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addTool",function(){return l}),n.d(t,"addToolForElement",function(){return s});var a=n("./store/index.js"),r=n("./store/getToolForElement.js"),o=n("./util/logger.js"),i=Object(o.getLogger)("addTool"),s=function(e,t,n){var o=new t(n);Object(r.default)(e,o.name)?i.warn("%s has already been added to the target element",o.name):(o.element=e,a.default.state.tools.push(o))},l=function(e,t){u(e,t),a.default.state.enabledElements.forEach(function(n){s(n,e,t)})},u=function(e,t){if(Object(a.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var n=new e(t);void 0!==a.default.state.globalTools[n.name]?i.warn("%s has already been added globally",n.name):a.default.state.globalTools[n.name]={tool:e,props:t,activeBindings:[]}}}},"./store/filterToolsUsableWithMultiPartTools.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/base/BaseAnnotationTool.js"),r=n("./tools/base/BaseBrushTool.js");t.default=function(e){return e.filter(function(e){return!(e.isMultiPartTool||e instanceof a.default||e instanceof r.default)})}},"./store/getActiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return t.filter(function(t){return t.element===e&&"active"===t.mode&&(void 0===n||t.options["is".concat(n,"Active")])})}},"./store/getInteractiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return t.filter(function(t){return t.element===e&&("active"===t.mode||"passive"===t.mode)})}},"./store/getToolForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js");t.default=function(e,t){return a.state.tools.find(function(n){return n.element===e&&n.name===t})}},"./store/getToolsWithDataForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolState.js");t.default=function(e,t){return t.filter(function(t){var n=Object(a.getToolState)(e,t.name);return n&&n.data.length>0})}},"./store/getToolsWithMoveableHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",s="mouse"===i?a.state.clickProximity:a.state.touchProximity;return t.filter(function(t){for(var a=Object(r.getToolState)(e,t.name),i=0;i<a.data.length;i++)if(void 0!==Object(o.default)(e,a.data[i].handles,n,s))return!0;return!1})}},"./store/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",function(){return u}),n.d(t,"getters",function(){return d}),n.d(t,"modules",function(){return c}),n.d(t,"getModule",function(){return f});var a=n("./store/modules/segmentationModule/index.js"),r=n("./store/modules/manipulatorStateModule.js"),o=n("./store/modules/cursorModule.js"),i=n("./store/modules/globalConfigurationModule.js"),s=n("./externalModules.js"),l=n("./util/logger.js"),u=(Object(l.getLogger)("store:modules:storeLogger"),{globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,svgCursorUrl:null}),d={mouseTools:function(){return u.tools.filter(function(e){return e.supportedInteractionTypes.includes("Mouse")})},touchTools:function(){return u.tools.filter(function(e){return e.supportedInteractionTypes.includes("Touch")})},enabledElementByUID:function(e){return u.enabledElements.find(function(t){return s.default.cornerstone.getEnabledElement(t).uuid===e})}},c={segmentation:a.default,cursor:o.default,globalConfiguration:i.default,manipulatorState:r.default};function f(e){return c[e]}t.default={modules:c,state:u,getters:d}},"./store/internals/addEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),r=n("./eventDispatchers/index.js"),o=n("./store/addTool.js"),i=n("./store/setToolMode.js"),s=n("./store/index.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("internals:addEnabledElement");t.default=function(e){u.log("EVENT:ELEMENT_ENABLED");var t=e.detail.element;r.imageRenderedEventDispatcher.enable(t),r.newImageEventDispatcher.enable(t);var n=Object(s.getModule)("globalConfiguration").configuration;n.mouseEnabled&&(a.mouseEventListeners.enable(t),a.wheelEventListener.enable(t),r.mouseToolEventDispatcher.enable(t)),n.touchEnabled&&(a.touchEventListeners.enable(t),r.touchToolEventDispatcher.enable(t)),d(t)};var d=function(e){s.default.state.enabledElements.push(e),s.default.modules&&function(e){var t=s.default.modules;Object.keys(t).forEach(function(n){"function"==typeof t[n].enabledElementCallback&&t[n].enabledElementCallback(e)})}(e),function(e){Object(s.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&Object.keys(s.default.state.globalTools).forEach(function(t){var n=s.default.state.globalTools[t],a=n.tool,r=n.props;Object(o.addToolForElement)(e,a,r)})}(e),function(e){if(Object(s.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var t={active:i.setToolActiveForElement,passive:i.setToolPassiveForElement,enabled:i.setToolEnabledForElement,disabled:i.setToolDisabledForElement};s.default.state.globalToolChangeHistory.forEach(function(n){var a=n.args.slice(0);a.unshift(e),t[n.mode].apply(null,a)})}}(e)}},"./store/internals/removeEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),r=n("./eventDispatchers/index.js"),o=n("./store/index.js"),i=n("./util/logger.js"),s=n("./stateManagement/loadHandlerManager.js"),l=n("./store/setToolMode.js"),u=Object(i.getLogger)("internals:removeEnabledElement");t.default=function(e){u.log("EVENT:ELEMENT_DISABLED");var t=e.detail.element,n=Object(o.getModule)("globalConfiguration").configuration;r.imageRenderedEventDispatcher.disable(t),r.newImageEventDispatcher.disable(t),n.mouseEnabled&&(a.mouseEventListeners.disable(t),a.wheelEventListener.disable(t),r.mouseToolEventDispatcher.disable(t)),n.touchEnabled&&(a.touchEventListeners.disable(t),r.touchToolEventDispatcher.disable(t)),d(t),c(t),f(t)};var d=function(e){o.default.state.tools.forEach(function(t){t.element===e&&Object(l.setToolDisabledForElement)(t.element,t.name)}),o.default.state.tools=o.default.state.tools.filter(function(t){return t.element!==e})},c=function(e){o.default.modules&&function(e){var t=o.default.modules;Object.keys(t).forEach(function(n){"function"==typeof t[n].removeEnabledElementCallback&&t[n].removeEnabledElementCallback(e)})}(e);var t=o.default.state.enabledElements.findIndex(function(t){return t===e});t>-1?o.default.state.enabledElements.splice(t,1):u.warn("unable to remove element")},f=function(e){s.default.removeHandlers(e)}},"./store/isToolActiveForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/getToolForElement.js");t.default=function(e,t){return"active"===Object(a.default)(e,t).mode}},"./store/modules/cursorModule.js":function(e,t,n){"use strict";n.r(t),n("./externalModules.js");var a={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:'\n    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>\n    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>\n  '};t.default={configuration:a,getters:{defaultOptions:function(){return a}},setters:{defaultOptions:function(e){Object.assign(a,e)}}}},"./store/modules/globalConfigurationModule.js":function(e,t,n){"use strict";n.r(t),t.default={configuration:{mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1,autoResizeViewports:!0,lineDash:[4,4]}}},"./store/modules/manipulatorStateModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r={activeManipulators:{}};function o(e){var t=a.default.cornerstone.getEnabledElement(e);delete r.activeManipulators[t.uuid]}function i(e){var t=r.activeManipulators,n=t[e];"function"==typeof n&&n(),delete t[e]}function s(e){o(e.detail.element)}t.default={setters:{addActiveManipulatorForElement:function(e,t){var n=a.default.cornerstone.getEnabledElement(e);r.activeManipulators[n.uuid]=t},removeActiveManipulatorForElement:o,cancelActiveManipulatorsForElement:function(e){i(a.default.cornerstone.getEnabledElement(e).uuid)},cancelActiveManipulators:function(){Object.keys(r.activeManipulators).forEach(function(e){return i(e)})}},state:r,enabledElementCallback:function(e){var t=a.default.cornerstone.EVENTS.NEW_IMAGE;e.removeEventListener(t,s),e.addEventListener(t,s)},removeEnabledElementCallback:function(e){e.removeEventListener(a.default.cornerstone.EVENTS.NEW_IMAGE,s),o(e)}}},"./store/modules/segmentationModule/activeLabelmapIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveLabelmapIndex",function(){return l}),n.d(t,"setActiveLabelmapIndex",function(){return u});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/addLabelmap3D.js"),i=n("./store/modules/segmentationModule/state.js"),s=n("./externalModules.js");function l(e){var t=Object(a.default)(e);if(t){var n=Object(r.getToolState)(t,"stack"),o=i.default.series[n.data[0].imageIds[0]];if(o)return o.activeLabelmapIndex}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(a.default)(e);if(n){var l=s.default.cornerstone,u=Object(r.getToolState)(n,"stack"),d=u.data[0],c=l.getEnabledElement(n),f=c.image,m=f.rows,g=f.columns,h=d.imageIds.length,v=m*g*h,p=d.imageIds[0],b=i.default.series[p];b?(b.activeLabelmapIndex=t,b.labelmaps3D[t]||Object(o.default)(b,t,v)):(i.default.series[p]={activeLabelmapIndex:t,labelmaps3D:[]},b=i.default.series[p],Object(o.default)(b,t,v)),l.updateImage(n)}}},"./store/modules/segmentationModule/activeSegmentIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveSegmentIndex",function(){return s}),n.d(t,"setActiveSegmentIndex",function(){return l}),n.d(t,"incrementActiveSegmentIndex",function(){return u}),n.d(t,"decrementActiveSegmentIndex",function(){return d});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./store/index.js");function s(e,t){var n=Object(a.default)(e);if(n){var i=Object(r.getToolState)(n,"stack"),s=o.default.series[i.data[0].imageIds[0]];if(s){var l=s.labelmaps3D[t=void 0===t?s.activeLabelmapIndex:t];if(l)return l.activeSegmentIndex}return 1}}function l(e,t){var n=Object(a.default)(e);if(n){var s=Object(r.getToolState)(n,"stack"),l=o.default.series[s.data[0].imageIds[0]];if(l){var u=l.labelmaps3D[l.activeLabelmapIndex],d=Object(i.getModule)("segmentation").configuration;t<=0?t=1:t>d.segmentsPerLabelmap&&(t=d.segmentsPerLabelmap),u.activeSegmentIndex=t}}}function u(e){var t=Object(a.default)(e);t&&c(t,"increase")}function d(e){var t=Object(a.default)(e);t&&c(t,"decrease")}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"increase",n=Object(i.getModule)("segmentation"),a=n.configuration,s=Object(r.getToolState)(e,"stack"),l=s.data[0],u=l.imageIds[0],d=o.default.series[u];if(d){var c=d.activeLabelmapIndex,f=d.labelmaps3D[c];switch(t){case"increase":f.activeSegmentIndex++,f.activeSegmentIndex>a.segmentsPerLabelmap&&(f.activeSegmentIndex=1);break;case"decrease":f.activeSegmentIndex--,f.activeSegmentIndex<=0&&(f.activeSegmentIndex=a.segmentsPerLabelmap)}}}},"./store/modules/segmentationModule/addLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/modules/segmentationModule/arrayTypes.js"),r=n("./store/index.js"),o=a.default.UINT_16_ARRAY,i=a.default.FLOAT_32_ARRAY;function s(e,t,n,a,s){var l,u=Object(r.getModule)("segmentation").configuration,d=a*s,c=d*n;switch(u.arrayType){case o:l=new Uint16Array(e.labelmaps3D[t].buffer,2*c,d);break;case i:l=new Float32Array(e.labelmaps3D[t].buffer,4*c,d);break;default:throw new Error("Unsupported Array Type ".concat(u.arrayType))}e.labelmaps3D[t].labelmaps2D[n]={pixelData:l,segmentsOnLabelmap:[]}}},"./store/modules/segmentationModule/addLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/modules/segmentationModule/arrayTypes.js"),r=n("./store/index.js"),o=a.default.UINT_16_ARRAY,i=a.default.FLOAT_32_ARRAY;function s(e,t,n){var a,s=Object(r.getModule)("segmentation").configuration;switch(s.arrayType){case o:a=2;break;case i:a=4;break;default:throw new Error("Unsupported Array Type ".concat(s.arrayType))}e.labelmaps3D[t]={buffer:new ArrayBuffer(n*a),labelmaps2D:[],metadata:[],activeSegmentIndex:1,colorLUTIndex:0,segmentsHidden:[],undo:[],redo:[]}}},"./store/modules/segmentationModule/arrayTypes.js":function(e,t,n){"use strict";n.r(t),t.default={UINT_16_ARRAY:0,FLOAT_32_ARRAY:1}},"./store/modules/segmentationModule/colorLUT.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u}),n.d(t,"setColorLUTIndexForLabelmap3D",function(){return d}),n.d(t,"getColorForSegmentIndexColorLUT",function(){return c}),n.d(t,"setColorForSegmentIndexOfColorLUT",function(){return f}),n.d(t,"getColorLUT",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./util/logger.js"),i=n("./store/modules/segmentationModule/state.js"),s=n("./store/index.js"),l=Object(o.getLogger)("store:modules:segmentationModule:setColorLUT");function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(s.getModule)("segmentation"),a=n.configuration,o=a.segmentsPerLabelmap;t?(g(t,o),t.length<o&&(t=[].concat(r()(t),r()(h(o-t.length))))):t=t||h(o),t.unshift([0,0,0,0]),i.default.colorLutTables[e]=t}function d(e,t){e.colorLUTIndex=t}function c(e,t){return m(e)[t]}function f(e,t,n){m(e)[t]=n}function m(e){return"number"==typeof e?i.default.colorLutTables[e]:i.default.colorLutTables[e.colorLUTIndex]}function g(e,t){e.length<t?l.warn("The provided colorLUT only provides ".concat(e.length," labels, whereas segmentsPerLabelmap is set to ").concat(t,". Autogenerating the rest.")):e.length>t&&l.warn("segmentsPerLabelmap is set to ".concat(t,", and the provided colorLUT provides ").concat(e.length,". Using the first ").concat(t," colors from the LUT."))}function h(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:255,t=[],n=0;n<e;n++)t.push(x(p(),y()));return t}var v=222.5;function p(){return(v+=137.5)>=360&&(v-=360),v}var b=.6;function y(){return(b+=.07)>.82&&(b=b-.82+.3),b}function x(e){var t,n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.6,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,s=(1-Math.abs(2*o-1))*r,l=s*(1-Math.abs(e/60%2-1)),u=o-s/2;return e<60?(t=s,n=l,a=0):e<120?(t=l,n=s,a=0):e<180?(t=0,n=s,a=l):e<240?(t=0,n=l,a=s):e<300?(t=l,n=0,a=s):e<360&&(t=s,n=0,a=l),[255*(t+u),255*(n+u),255*(a+u),i]}},"./store/modules/segmentationModule/defaultConfiguration.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/modules/segmentationModule/arrayTypes.js");t.default={renderOutline:!0,renderFill:!0,shouldRenderInactiveLabelmaps:!0,radius:10,minRadius:1,maxRadius:50,fillAlpha:.2,fillAlphaInactive:.1,outlineAlpha:.7,outlineAlphaInactive:.35,outlineWidth:3,storeHistory:!0,segmentsPerLabelmap:65535,arrayType:a.default.UINT_16_ARRAY}},"./store/modules/segmentationModule/deleteSegment.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./externalModules.js");function s(e,t,n){if(t){var s=Object(a.default)(e);if(s){var l=Object(r.getToolState)(s,"stack"),u=o.default.series[l.data[0].imageIds[0]];if(u){var d=u.labelmaps3D[n=void 0===n?u.activeLabelmapIndex:n];if(d){delete d.metadata[t];for(var c=d.labelmaps2D,f=0;f<c.length;f++){var m=c[f];if(m&&m.segmentsOnLabelmap.includes(t)){var g=m.pixelData,h=m.segmentsOnLabelmap.indexOf(t);m.segmentsOnLabelmap.splice(h,1);for(var v=0;v<g.length;v++)g[v]===t&&(g[v]=0)}}i.default.cornerstone.updateImage(s)}}}}}},"./store/modules/segmentationModule/getBrushColor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l});var a=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),o=n("./store/modules/segmentationModule/getElement.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:getBrushColor");function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(o.default)(e);if(n){var i=Object(a.getToolState)(n,"stack");if(i){var l,u=i.data[0],d=u.imageIds[0],c=r.default.series[d];if(c){var f=c.activeLabelmapIndex,m=c.labelmaps3D[f],g=m.activeSegmentIndex;l=r.default.colorLutTables[m.colorLUTIndex][g]}else l=r.default.colorLutTables[0][1];return t?"rgba(".concat(l[0],", ").concat(l[1],", ").concat(l[2],", 1.0 )"):"rgba(".concat(l[0],", ").concat(l[1],", ").concat(l[2],", 0.8 )")}s.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}},"./store/modules/segmentationModule/getElement.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./store/index.js");function r(e){return e instanceof HTMLElement?e:a.getters.enabledElementByUID(e)}},"./store/modules/segmentationModule/getLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v}),n.d(t,"getLabelmap2DByImageIdIndex",function(){return p});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),i=n("./store/modules/segmentationModule/addLabelmap3D.js"),s=n("./store/modules/segmentationModule/addLabelmap2D.js"),l=n("./externalModules.js"),u=n("./store/modules/segmentationModule/state.js"),d=n("./store/modules/segmentationModule/arrayTypes.js"),c=n("./store/index.js"),f=n("./util/logger.js"),m=d.default.UINT_16_ARRAY,g=d.default.FLOAT_32_ARRAY,h=Object(f.getLogger)("store:modules:segmentationModule:getLabelmap2D");function v(e){var t=Object(a.default)(e);if(t){var n=l.default.cornerstone,o=Object(r.getToolState)(t,"stack");if(o){var d,c=o.data[0],f=n.getEnabledElement(t),m=c.currentImageIdIndex,g=f.image,v=g.rows,p=g.columns,b=c.imageIds.length,y=c.imageIds[0],x=u.default.series[y];if(x){if(!x.labelmaps3D[d=x.activeLabelmapIndex]){var j=v*p*b;Object(i.default)(x,d,j)}x.labelmaps3D[d].labelmaps2D[m]||Object(s.default)(x,d,m,v,p)}else{u.default.series[y]={activeLabelmapIndex:d=0,labelmaps3D:[]},x=u.default.series[y];var w=v*p*b;Object(i.default)(x,d,w),Object(s.default)(x,d,m,v,p)}var T=x.labelmaps3D[d];return{labelmap2D:T.labelmaps2D[m],labelmap3D:T,currentImageIdIndex:m,activeLabelmapIndex:d}}h.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function p(e,t,n,a){if(!e.labelmaps2D[t]){var r,i=Object(c.getModule)("segmentation").configuration,s=n*a,l=s*t;switch(i.arrayType){case m:r=new Uint16Array(e.buffer,2*l,s);break;case g:r=new Float32Array(e.buffer,4*l,s);break;default:throw new Error("Unsupported Array Type ".concat(i.arrayType))}e.labelmaps2D[t]={pixelData:r,segmentsOnLabelmap:Object(o.default)(r)}}return e.labelmaps2D[t]}},"./store/modules/segmentationModule/getLabelmapBuffers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLabelmapBuffers",function(){return c}),n.d(t,"getActiveLabelmapBuffer",function(){return f});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/getLabelmaps3D.js"),i=n("./store/modules/segmentationModule/state.js"),s=n("./store/modules/segmentationModule/arrayTypes.js"),l=n("./store/index.js"),u=s.default.UINT_16_ARRAY,d=s.default.FLOAT_32_ARRAY;function c(e,t){var n=Object(a.default)(e);if(n){var r=Object(o.default)(n).labelmaps3D;if(!r)return[];var s,c,f=Object(l.getModule)("segmentation").configuration;switch(f.arrayType){case u:s="Uint16Array",c="2";break;case d:s="Float32Array",c="4";break;default:throw new Error("Unsupported Array Type ".concat(f.arrayType))}var m=i.default.colorLutTables;if(void 0!==t){var g=r[t];return g?{labelmapIndex:t,bytesPerVoxel:c,type:s,buffer:g.buffer,colorLUT:m[g.colorLUTIndex]}:void 0}for(var h=[],v=0;v<r.length;v++){var p=r[v];p&&h.push({labelmapIndex:v,bytesPerVoxel:2,buffer:p.buffer,colorLUT:m[p.colorLUTIndex]})}return h}}function f(e){var t=Object(a.default)(e);if(t){var n=Object(r.getToolState)(t,"stack"),o=i.default.series[n.data[0].imageIds[0]];if(o)return c(t,o.activeLabelmapIndex)}}},"./store/modules/segmentationModule/getLabelmapStats.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u}),n.d(t,"_calculateLabelmapStats",function(){return d});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./externalModules.js"),s=n("./util/logger.js"),l=Object(s.getLogger)("store:modules:segmentationModule:getLabelmapStats");function u(e,t,n){var s=i.default.cornerstone,u=Object(a.default)(e);if(!u)return null;var c=Object(r.getToolState)(u,"stack").data[0].imageIds,f=c[0];return new Promise(function(e){var a=o.default.series[f];a||e(null);var r=function(e){for(var t=[],n=i.default.cornerstone.metaData,a=!0,r=0;r<e.length;r++){var o=n.get("imagePlaneModule",e[r]);if(!o){a=!1;break}t.push(o)}return{sufficientMetadata:a,imagePlanes:t}}(c),u=r.imagePlanes;r.sufficientMetadata||(l.warn("Insufficient imagePlaneModule information to calculate volume statistics."),e(null));for(var m=a.labelmaps3D[n=void 0===n?a.activeLabelmapIndex:n],g=[],h=0;h<c.length;h++)g.push(s.loadAndCacheImage(c[h]));Promise.all(g).then(function(n){var a=d(m,n,u,t);e(a)})})}function d(e,t,n,a){for(var r=function(e,t,n,a){for(var r=t[0],o=r.rowPixelSpacing,i=r.columnPixelSpacing,s=e.labelmaps2D,l=[],u=0;u<s.length;u++){var d=s[u];if(d&&d.segmentsOnLabelmap.includes(a)){for(var f=c(t,n,u)*o*i,m=d.pixelData,g=t[u].getPixelData(),h=[],v=0;v<m.length;v++)m[v]===a&&h.push(g[v]);l.push({voxelInMM3:f,values:h})}}return l}(e,t,n,a),o=0,i=r[0].values[0],s=i,l=0,u=0;u<r.length;u++){var d=r[u];l+=(p=d.voxelInMM3)*(h=d.values).length;var f=0;h.forEach(function(e){e>i?i=e:e<s&&(s=e),f+=e}),o+=f*p}o/=l;for(var m=0,g=0;g<r.length;g++){var h,v=r[g],p=v.voxelInMM3,b=0;(h=v.values).forEach(function(e){b+=Math.pow(e-o,2)}),m+=b*p}return m/=l,m=Math.sqrt(m),{volume:l,mean:o,stdDev:m,max:i,min:s}}function c(e,t,n){var a=e.length,r=t[n].imagePositionPatient;if(0===n)return f(r,t[n+1].imagePositionPatient);if(n===a-1)return f(r,t[n-1].imagePositionPatient);var o=t[n+1].imagePositionPatient;return(f(r,t[n-1].imagePositionPatient)+f(r,o))/2}function f(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}},"./store/modules/segmentationModule/getLabelmaps3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l}),n.d(t,"getLabelmap3D",function(){return u});var a=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/getElement.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:getLabelmaps3D");function l(e){var t=Object(r.default)(e);if(t){var n=Object(a.getToolState)(t,"stack");if(n){var i,l,u=n.data[0],d=o.default.series[u.imageIds[0]];return d&&(i=d.labelmaps3D,l=d.activeLabelmapIndex),{labelmaps3D:i,activeLabelmapIndex:l,currentImageIdIndex:u.currentImageIdIndex}}s.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function u(e,t){var n=l(e);return n.labelmaps3D[t=void 0!==t?t:n.activeLabelmapIndex]}},"./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l});var a=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),o=n("./util/isPointInImage.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:getSegmentOfActiveLabelmapAtEvent");function l(e){var t=e.detail,n=t.element,i=t.image,l=t.currentPoints;if(l){var u=i.width,d=i.height;if(n){var c=Object(a.getToolState)(n,"stack").data[0],f=r.default.series[c.imageIds[0]],m=f.labelmaps3D[f.activeLabelmapIndex];if(m){var g=m.labelmaps2D[c.currentImageIdIndex];if(g){var h=g.pixelData,v=l.image,p=v.x,b=v.y;if(p=Math.floor(p),b=Math.floor(b),Object(o.default)({x:p,y:b},d,u)){var y=h[b*u+p];if(0===y)return;return{segmentIndex:y,metadata:m.metadata[y]}}}}}}else s.warn("Not a cornerstone input event.")}},"./store/modules/segmentationModule/getSegmentsOnPixeldata.js":function(e,t,n){"use strict";function a(e){for(var t=new Set(e).values(),n=[],a=!1;!a;){var r=t.next();(a=r.done)||n.push(r.value)}return n}n.r(t),n.d(t,"default",function(){return a})},"./store/modules/segmentationModule/history.js":function(e,t,n){"use strict";n.r(t),n.d(t,"pushState",function(){return s}),n.d(t,"undo",function(){return l}),n.d(t,"redo",function(){return u});var a=n("./store/modules/segmentationModule/getLabelmaps3D.js"),r=n("./util/logger.js"),o=n("./externalModules.js"),i=Object(r.getLogger)("util:segmentation:labelmap3DHistory");function s(e,t,n){var r=Object(a.getLabelmap3D)(e,n);r.undo.push(t),r.redo=[]}function l(e,t){var n=Object(a.getLabelmap3D)(e,t),r=n.undo,s=n.redo;if(r.length){var l=r.pop();d(n,l,1),s.push(l),o.default.cornerstone.updateImage(e)}else i.warn("No undos left.")}function u(e,t){var n=Object(a.getLabelmap3D)(e,t),r=n.undo,s=n.redo;if(s.length){var l=s.pop();d(n,l,2),r.push(l),o.default.cornerstone.updateImage(e)}else i.warn("No redos left.")}function d(e,t,n){var a=e.labelmaps2D;t.forEach(function(e){for(var t=e.diff,r=a[e.imageIdIndex].pixelData,o=0;o<t.length;o++){var i=t[o];r[i[0]]=i[n]}})}},"./store/modules/segmentationModule/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/modules/segmentationModule/metadata.js"),r=n("./store/modules/segmentationModule/activeLabelmapIndex.js"),o=n("./store/modules/segmentationModule/activeSegmentIndex.js"),i=n("./store/modules/segmentationModule/segmentVisibility.js"),s=n("./store/modules/segmentationModule/getLabelmapBuffers.js"),l=n("./store/modules/segmentationModule/setLabelmap3D.js"),u=n("./store/modules/segmentationModule/getLabelmapStats.js"),d=n("./store/modules/segmentationModule/getLabelmaps3D.js"),c=n("./store/modules/segmentationModule/getLabelmap2D.js"),f=n("./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js"),m=n("./store/modules/segmentationModule/colorLUT.js"),g=n("./store/modules/segmentationModule/getBrushColor.js"),h=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),v=n("./store/modules/segmentationModule/deleteSegment.js"),p=n("./store/modules/segmentationModule/state.js"),b=n("./store/modules/segmentationModule/defaultConfiguration.js"),y=n("./store/modules/segmentationModule/history.js"),x=n("./store/modules/segmentationModule/setRadius.js");t.default={state:p.default,configuration:b.default,onRegisterCallback:function(){Object(m.default)(0)},getters:{metadata:a.getMetadata,labelmap3D:d.getLabelmap3D,labelmaps3D:d.default,activeLabelmapIndex:r.getActiveLabelmapIndex,activeSegmentIndex:o.getActiveSegmentIndex,isSegmentVisible:i.isSegmentVisible,labelmap2D:c.default,labelmap2DByImageIdIndex:c.getLabelmap2DByImageIdIndex,labelmapStats:u.default,segmentOfActiveLabelmapAtEvent:f.default,brushColor:g.default,labelmapBuffers:s.getLabelmapBuffers,activeLabelmapBuffer:s.getActiveLabelmapBuffer,colorLUT:m.getColorLUT,colorForSegmentIndexColorLUT:m.getColorForSegmentIndexColorLUT},setters:{metadata:a.setMetadata,labelmap3DForElement:l.setLabelmap3DForElement,labelmap3DByFirstImageId:l.setLabelmap3DByFirstImageId,incrementActiveSegmentIndex:o.incrementActiveSegmentIndex,decrementActiveSegmentIndex:o.decrementActiveSegmentIndex,activeSegmentIndex:o.setActiveSegmentIndex,toggleSegmentVisibility:i.toggleSegmentVisibility,updateSegmentsOnLabelmap2D:function(e){e.segmentsOnLabelmap=Object(h.default)(e.pixelData)},deleteSegment:v.default,colorLUT:m.default,colorLUTIndexForLabelmap3D:m.setColorLUTIndexForLabelmap3D,colorForSegmentIndexOfColorLUT:m.setColorForSegmentIndexOfColorLUT,activeLabelmapIndex:r.setActiveLabelmapIndex,radius:x.default,pushState:y.pushState,undo:y.undo,redo:y.redo}}},"./store/modules/segmentationModule/metadata.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getMetadata",function(){return d}),n.d(t,"setMetadata",function(){return c});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./store/modules/segmentationModule/addLabelmap3D.js"),o=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),s=n("./util/logger.js"),l=n("./store/modules/segmentationModule/state.js"),u=Object(s.getLogger)("store:modules:segmentationModule:metadata");function d(e,t,n){var r=Object(a.default)(e);if(r){var i=Object(o.getToolState)(r,"stack"),s=l.default.series[i.data[0].imageIds[0]];if(s){if(s.labelmaps3D[t=void 0===t?s.activeLabelmapIndex:t]){var d=s.labelmaps3D[t];return void 0===n?d.metadata:d.metadata[n]}u.warn("No labelmap3D of labelmap index ".concat(t," on stack."))}else u.warn("brushStackState is undefined")}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,u=Object(a.default)(e);if(u){var d=i.default.cornerstone,c=Object(o.getToolState)(u,"stack"),f=c.data[0],m=f.imageIds[0],g=l.default.series[m];if(g||(l.default.series[m]={labelmapIndex:t,labelmaps3D:[]},g=l.default.series[m]),!g.labelmaps3D[t]){var h=d.getEnabledElement(u),v=h.image,p=v.rows,b=v.columns,y=f.imageIds.length,x=p*b*y;Object(r.default)(g,t,x)}var j=g.labelmaps3D[t];j.metadata[n]=s}}},"./store/modules/segmentationModule/segmentVisibility.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isSegmentVisible",function(){return l}),n.d(t,"toggleSegmentVisibility",function(){return u});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:segmentVisibility");function l(e,t,n){if(t){var i=Object(a.default)(e);if(i){var l=Object(r.getToolState)(i,"stack"),u=o.default.series[l.data[0].imageIds[0]];if(u){if(u.labelmaps3D[n=void 0===n?u.activeLabelmapIndex:n])return!u.labelmaps3D[n].segmentsHidden[t];s.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else s.warn("brushStackState is undefined")}}}function u(e,t,n){if(t){var i=Object(a.default)(e);if(i){var l=Object(r.getToolState)(i,"stack"),u=o.default.series[l.data[0].imageIds[0]];if(u){if(u.labelmaps3D[n=void 0===n?u.activeLabelmapIndex:n]){var d=u.labelmaps3D[n].segmentsHidden;return d[t]=!d[t],!d[t]}s.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else s.warn("brushStackState is undefined")}}}},"./store/modules/segmentationModule/setLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setLabelmap3DByFirstImageId",function(){return m}),n.d(t,"setLabelmap3DForElement",function(){return f});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),s=n("./util/segmentation/index.js"),l=n("./store/modules/segmentationModule/arrayTypes.js"),u=n("./store/index.js"),d=l.default.UINT_16_ARRAY,c=l.default.FLOAT_32_ARRAY;function f(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=Object(a.default)(e);if(u){var d=Object(r.getToolState)(u,"stack"),c=d.data[0].imageIds.length,f=d.data[0].imageIds[0];m(f,t,n,o,c,i,l),Object(s.triggerLabelmapModifiedEvent)(u,n)}}function m(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,f=Object(u.getModule)("segmentation"),m=f.configuration,g=o.default.series[e];g||(o.default.series[e]={activeLabelmapIndex:n,labelmaps3D:[]},g=o.default.series[e]),g.labelmaps3D[n]={buffer:t,labelmaps2D:[],metadata:a,activeSegmentIndex:1,colorLUTIndex:l,segmentsHidden:[],undo:[],redo:[]};for(var h=g.labelmaps3D[n].labelmaps2D,v=t.byteLength/r,p=0;p<r;p++){var b=void 0;switch(m.arrayType){case d:b=new Uint16Array(t,v*p,v/2);break;case c:b=new Float32Array(t,v*p,v/4);break;default:throw new Error("Unsupported Array Type ".concat(m.arrayType))}var y=s?s[p]:Object(i.default)(b);y&&y.some(function(e){return e})&&(h[p]={pixelData:b,segmentsOnLabelmap:y})}}},"./store/modules/segmentationModule/setRadius.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./store/index.js");function r(e){var t=Object(a.getModule)("segmentation").configuration;t.radius=Math.min(Math.max(e,t.minRadius),t.maxRadius)}},"./store/modules/segmentationModule/state.js":function(e,t,n){"use strict";n.r(t),t.default={series:{},colorLutTables:[]}},"./store/removeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"removeTool",function(){return o}),n.d(t,"removeToolForElement",function(){return r});var a=n("./store/index.js"),r=function(e,t){var n=a.default.state.tools.findIndex(function(n){return n.element===e&&n.name===t});n>=0&&a.default.state.tools.splice(n,1)},o=function(e){i(e),a.default.state.enabledElements.forEach(function(t){r(t,e)})},i=function(e){Object(a.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&a.default.state.globalTools[e]&&delete a.default.state.globalTools[e]}},"./store/setToolCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolCursor",function(){return o}),n.d(t,"resetToolCursor",function(){return i}),n.d(t,"hideToolCursor",function(){return s});var a=n("./store/index.js"),r=a.modules.globalConfiguration;function o(e,t){if(r.configuration.showSVGCursors){var n=t.getIconWithPointerSVG(),o=t.mousePoint,i=window.URL.createObjectURL(n);e.style.cursor="url('".concat(i,"') ").concat(o,", auto"),a.state.svgCursorUrl=i}}function i(e){l(e,"initial")}function s(e){r.configuration.showSVGCursors&&l(e,"none")}function l(e,t){a.state.svgCursorUrl&&window.URL.revokeObjectURL(a.state.svgCursorUrl),a.state.svgCursorUrl=null,e.style.cursor=t}},"./store/setToolMode.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolActive",function(){return f}),n.d(t,"setToolActiveForElement",function(){return c}),n.d(t,"setToolDisabled",function(){return g}),n.d(t,"setToolDisabledForElement",function(){return m}),n.d(t,"setToolEnabled",function(){return v}),n.d(t,"setToolEnabledForElement",function(){return h}),n.d(t,"setToolPassive",function(){return b}),n.d(t,"setToolPassiveForElement",function(){return p}),n.d(t,"setToolMode",function(){return x}),n.d(t,"setToolModeForElement",function(){return y}),n.d(t,"_getNormalizedOptions",function(){return E}),n.d(t,"_mergeMouseButtonMask",function(){return O});var a=n("./events.js"),r=n("./util/triggerEvent.js"),o=n("./store/getToolForElement.js"),i=n("./store/setToolCursor.js"),s=n("./util/logger.js"),l=n("./store/index.js"),u=Object(l.getModule)("globalConfiguration"),d=Object(s.getLogger)("store:setToolMode"),c=function(e,t,n,a){void 0===a&&Array.isArray(n)&&(a=n,n=null);var r=Object(o.default)(e,t);r&&(function(e,t,n,a){t.supportedInteractionTypes.forEach(function(r){if(void 0===a||a.includes(r)){var o=T[r];o?o(t,e,n):d.warn("Unable to resolve input conflicts for type %s",r)}}),l.default.state.tools.filter(function(t){return t.element===e&&"active"===t.mode&&t.supportedInteractionTypes.length>0}).forEach(function(t){var n=!1;t.supportedInteractionTypes.forEach(function(e){t.options["is".concat(e,"Active")]&&(n=!0)}),n||(d.log("Setting tool %s's to PASSIVE",t.name),p(e,t.name))})}(e,r,n,a),r.supportedInteractionTypes.forEach(function(e){void 0===a||a.includes(e)?n["is".concat(e,"Active")]=!0:n["is".concat(e,"Active")]=!1}),u.configuration.showSVGCursors&&r.supportedInteractionTypes.includes("Mouse")&&function(e,t,n){("number"==typeof t?[t]:t.mouseButtonMask).includes(1)&&(n.svgCursor?Object(i.setToolCursor)(n.element,n.svgCursor):n.hideDefaultCursor?Object(i.hideToolCursor)(e):Object(i.resetToolCursor)(e))}(e,n,r)),y("active",null,e,t,n)},f=function(e,t,n){w("active",e,t,n),l.default.state.enabledElements.forEach(function(a){c(a,e,t,n)})},m=y.bind(null,"disabled",null),g=x.bind(null,"disabled",null),h=y.bind(null,"enabled",null),v=x.bind(null,"enabled",null),p=y.bind(null,"passive",a.default.TOOL_DEACTIVATED),b=x.bind(null,"passive",a.default.TOOL_DEACTIVATED);function y(e,t,n,a,i){var s=Object(o.default)(n,a);if(s){if(i=E(i),Array.isArray(i.mouseButtonMask)&&0!==i.mouseButtonMask.length&&Array.isArray(s.options.mouseButtonMask)&&(i.mouseButtonMask=O(i.mouseButtonMask,s.options.mouseButtonMask)),s.mode=e,s.mergeOptions(i),s["".concat(e,"Callback")]&&s["".concat(e,"Callback")](n,i),t){var l={options:i,toolName:a,toolType:a,type:t};Object(r.default)(n,t,l)}}else d.warn('Unable to find tool "%s" for enabledElement',a)}function x(e,t,n,a){w(e,n,a),l.default.state.enabledElements.forEach(function(r){y(e,t,r,n,a)})}function j(e,t,n){var a="is".concat(e,"Active"),r=l.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options[a]});r&&(d.log("Setting tool %s's %s to false",r.name,a),r.options[a]=!1)}function w(e,t,n,a){if(u.configuration.globalToolSyncEnabled){var r={mode:e,args:[t,n]};a&&r.push(a),l.default.state.globalToolChangeHistory.push(r),l.default.state.globalToolChangeHistory.length>50&&l.default.state.globalToolChangeHistory.shift();var o=l.default.state.globalTools[t];if(o)if("active"===e){var i=function(e,t,n){void 0===n&&Array.isArray(t)&&(n=t,t=null);var a=[],r=l.default.state.globalTools[e];if(r){var o=new r.tool(r.props);o.supportedInteractionTypes.forEach(function(e){if(void 0===n||n.includes(e))if("Mouse"===e){var r=E(t).mouseButtonMask;Array.isArray(r)&&r.length>0?r.forEach(function(t){return a.push("".concat(e,"-").concat(t))}):Array.isArray(r)&&0===r.length&&a.push("".concat(e,"-DELETE"))}else a.push("MultiTouch"===e?"".concat(e,"-").concat(o.configuration.touchPointers):e)})}return a}(t,n,a);Object.keys(l.default.state.globalTools).forEach(function(e){var t=l.default.state.globalTools[e];t.activeBindings=t.activeBindings.filter(function(e){return!i.includes(e)})}),i.some(function(e){return e.includes("Mouse-DELETE")})&&(o.activeBindings=o.activeBindings.filter(function(e){return!e.includes("Mouse")}),i=i.filter(function(e){return!e.includes("Mouse")})),o.activeBindings=o.activeBindings.concat(i)}else o.activeBindings=[];else d.warn("setToolMode call for tool not available globally: ".concat(t))}}var T={Mouse:function(e,t,n){var a=E(n).mouseButtonMask;if(Array.isArray(a)&&a.length>0){var r=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMouseActive&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.some(function(e){return a.includes(e)})});r&&(r.options.mouseButtonMask=r.options.mouseButtonMask.filter(function(e){return!a.includes(e)}),0===r.options.mouseButtonMask.length&&(r.options.isMouseActive=!1))}},MouseWheel:j.bind(void 0,"MouseWheel"),Touch:function(e,t){var n=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive}),a=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMultiTouchActive&&1===e.configuration.touchPointers});n&&(d.log("Setting tool %s's isTouchActive to false",n.name),n.options.isTouchActive=!1),a&&(d.log("Setting tool %s's isTouchActive to false",a.name),a.options.isMultiTouchActive=!1)},TouchPinch:j.bind(void 0,"TouchPinch"),TouchRotate:j.bind(void 0,"TouchRotate"),DoubleTap:j.bind(void 0,"DoubleTap"),MultiTouch:function(e,t){var n,a=l.default.state.tools.find(function(n){return n.element===t&&"active"===n.mode&&!0===n.options.isMultiTouchActive&&n.configuration.touchPointers===e.configuration.touchPointers});1===e.configuration.touchPointers&&(n=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive})),a&&(d.log("Setting tool %s's isMultiTouchActive to false",a.name),a.options.isMultiTouchActive=!1),n&&(d.log("Setting tool %s's isTouchActive to false",n.name),n.options.isTouchActive=!1)}};function E(e){return Array.isArray(e)?e={mouseButtonMask:e}:e!==Object(e)&&(e={mouseButtonMask:[e]}),e.hasOwnProperty("mouseButtonMask")||(e.mouseButtonMask=[]),Array.isArray(e.mouseButtonMask)||(e.mouseButtonMask=[e.mouseButtonMask]),e.mouseButtonMask=e.mouseButtonMask.filter(function(e){return"number"==typeof e&&0!==e}),e}function O(e,t){return e.concat(t).reduce(function(e,t){return-1===e.indexOf(t)&&e.push(t),e},[])}},"./store/setToolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolOptions",function(){return i}),n.d(t,"setToolOptionsForElement",function(){return o});var a=n("./store/getToolForElement.js"),r=n("./store/index.js"),o=function(e,t,n){var r=Object(a.default)(e,t);r&&r.mergeOptions(n)},i=function(e,t){r.state.enabledElements.forEach(function(n){o(n,e,t)})}},"./synchronization/Synchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/convertToVector3.js"),o=n("./toolOptions.js");function i(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})}t.default=function(e,t){var n=this,s=[],l=[],u=!1,d={},c=t;function f(e){var t=e.detail.element;n.remove(t),Object(o.clearToolOptionsByElement)(t)}this.enabled=!0,this.setHandler=function(e){c=e},this.getHandler=function(){return c},this.getDistances=function(){if(s.length&&l.length){var e=a.default.cornerstone;d.distances={},d.imageIds={sourceElements:[],targetElements:[]},s.forEach(function(t){var n=e.getEnabledElement(t);if(n&&n.image){var a=n.image.imageId,o=e.metaData.get("imagePlaneModule",a);if(o&&o.imagePositionPatient){var i=Object(r.default)(o.imagePositionPatient);d.hasOwnProperty(n)||(d.distances[a]={},d.imageIds.sourceElements.push(a),l.forEach(function(n){var o=e.getEnabledElement(n);if(o&&o.image){var s=o.image.imageId;if(d.imageIds.targetElements.push(s),t!==n&&a!==s&&!d.distances[a].hasOwnProperty(s)){var l=e.metaData.get("imagePlaneModule",s);if(l&&l.imagePositionPatient){var u=Object(r.default)(l.imagePositionPatient);d.distances[a][s]=u.clone().sub(i)}}}}),Object.keys(d.distances[a]).length||delete d.distances[a])}}})}},this.fireEvent=function(e,t){!n.enabled||!s.length||!l.length||(u=!0,l.forEach(function(a){var r=l.indexOf(a);if(-1!==r){var o=d.imageIds.targetElements[r],i=s.indexOf(e);if(-1!==i){var u,f=d.imageIds.sourceElements[i];f===o?u=0:void 0!==d.distances[f]&&(u=d.distances[f][o]),c(n,e,a,t,u)}}}),u=!1)},this.onEvent=function(e){!0!==u&&n.fireEvent(e.currentTarget,e.detail)},this.addSource=function(t){-1===s.indexOf(t)&&(s.push(t),e.split(" ").forEach(function(e){t.addEventListener(e,n.onEvent)}),n.getDistances(),n.updateDisableHandlers())},this.addTarget=function(e){-1===l.indexOf(e)&&(l.push(e),n.getDistances(),c(n,e,e,0),n.updateDisableHandlers())},this.add=function(e){n.addSource(e),n.addTarget(e)},this.removeSource=function(t){var a=s.indexOf(t);-1!==a&&(s.splice(a,1),e.split(" ").forEach(function(e){t.removeEventListener(e,n.onEvent)}),n.getDistances(),n.fireEvent(t),n.updateDisableHandlers())},this.removeTarget=function(e){var t=l.indexOf(e);-1!==t&&(l.splice(t,1),n.getDistances(),c(n,e,e,0),n.updateDisableHandlers())},this.remove=function(e){n.removeTarget(e),n.removeSource(e)},this.getSourceElements=function(){return s},this.getTargetElements=function(){return l},this.displayImage=function(e,t,n){u=!0,a.default.cornerstone.displayImage(e,t,n),u=!1},this.setViewport=function(e,t){u=!0,a.default.cornerstone.setViewport(e,t),u=!1},this.updateDisableHandlers=function(){i(s.concat(l)).forEach(function(e){e.removeEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,f),e.addEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,f)})},this.destroy=function(){i(s.concat(l)).forEach(function(e){n.remove(e)})}}},"./synchronization/panZoomSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var r=a.default.cornerstone,o=r.getViewport(t),i=r.getViewport(n);i.scale===o.scale&&i.translation.x===o.translation.x&&i.translation.y===o.translation.y||(i.scale=o.scale,i.translation.x=o.translation.x,i.translation.y=o.translation.y,e.setViewport(n,i))}}},"./synchronization/stackImageIndexSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n){if(n!==t){var s=a.default.cornerstone,l=Object(r.getToolState)(t,"stack").data[0],u=Object(r.getToolState)(n,"stack").data[0],d=l.currentImageIdIndex;if((d=Object(i.default)(d,0,u.imageIds.length-1))!==u.currentImageIdIndex){var c=o.default.getStartLoadHandler(n),f=o.default.getEndLoadHandler(n),m=o.default.getErrorLoadingHandler(n);c&&c(n),(!0===u.preventCache?s.loadImage(u.imageIds[d]):s.loadAndCacheImage(u.imageIds[d])).then(function(t){var a=s.getViewport(n);u.currentImageIdIndex=d,e.displayImage(n,t,a),f&&f(n,t)},function(e){m&&m(n,u.imageIds[d],e)})}}}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n,s,l){if(n!==t){var u=a.default.cornerstone,d=Object(r.getToolState)(t,"stack").data[0],c=u.metaData.get("imagePlaneModule",d.imageIds[d.currentImageIdIndex]);if(void 0!==c&&void 0!==c.imagePositionPatient){var f=Object(i.default)(c.imagePositionPatient),m=Object(r.getToolState)(n,"stack").data[0],g=Number.MAX_VALUE,h=-1;if(l){var v=f.clone().add(l);if(m.imageIds.forEach(function(e,t){var n=u.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient),r=v.distanceToSquared(a);r<g&&(g=r,h=t)}}),h!==m.currentImageIdIndex&&-1!==h){var p=o.default.getStartLoadHandler(n),b=o.default.getEndLoadHandler(n),y=o.default.getErrorLoadingHandler(n);m.currentImageIdIndex=h;var x=m.imageIds[h];p&&p(n),(!0===m.preventCache?u.loadImage(x):u.loadAndCacheImage(x)).then(function(t){var a=u.getViewport(n);m.currentImageIdIndex===h&&(e.displayImage(n,t,a),b&&b(n,t))},function(e){y&&y(n,m.imageIds[h],e)})}}}}}},"./synchronization/stackImagePositionSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n){if(n!==t){var s=a.default.cornerstone,l=Object(r.getToolState)(t,"stack").data[0],u=s.metaData.get("imagePlaneModule",l.imageIds[l.currentImageIdIndex]);if(void 0!==u&&void 0!==u.imagePositionPatient){var d=Object(i.default)(u.imagePositionPatient),c=Object(r.getToolState)(n,"stack").data[0],f=Number.MAX_VALUE,m=-1;if(c.imageIds.forEach(function(e,t){var n=s.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient).distanceToSquared(d);a<f&&(f=a,m=t)}}),m!==c.currentImageIdIndex){var g=o.default.getStartLoadHandler(n),h=o.default.getEndLoadHandler(n),v=o.default.getErrorLoadingHandler(n);c.currentImageIdIndex=m;var p=c.imageIds[m];g&&g(n),-1!==m&&(!0===c.preventCache?s.loadImage(p):s.loadAndCacheImage(p)).then(function(t){var a=s.getViewport(n);c.currentImageIdIndex===m&&(e.displayImage(n,t,a),h&&h(n,t))},function(e){v&&v(n,c.imageIds[m],e)})}}}}},"./synchronization/stackScrollSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n,s){if(t!==n&&s&&s.direction){var l=a.default.cornerstone,u=Object(r.getToolState)(n,"stack").data[0],d=u.currentImageIdIndex+s.direction;if(d=Object(i.default)(d,0,u.imageIds.length-1),u.currentImageIdIndex!==d){var c=o.default.getStartLoadHandler(n),f=o.default.getEndLoadHandler(n),m=o.default.getErrorLoadingHandler(n);u.currentImageIdIndex=d;var g=u.imageIds[d];c&&c(n),(!0===u.preventCache?l.loadImage(g):l.loadAndCacheImage(g)).then(function(t){var a=l.getViewport(n);u.currentImageIdIndex===d&&(e.displayImage(n,t,a),f&&f(n,t))},function(e){m&&m(n,u.imageIds[d],e)})}}}},"./synchronization/updateImageSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){n!==t&&a.default.cornerstone.updateImage(n)}},"./synchronization/wwwcSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var r=a.default.cornerstone,o=r.getViewport(t),i=r.getViewport(n);i.voi.windowWidth===o.voi.windowWidth&&i.voi.windowCenter===o.voi.windowCenter&&i.invert===o.invert||(i.voi.windowWidth=o.voi.windowWidth,i.voi.windowCenter=o.voi.windowCenter,i.invert=o.invert,e.setViewport(n,i))}}},"./thirdParty/register.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./thirdParty/registerModule.js"),i=n("./thirdParty/registerMixin.js"),s=n("./thirdParty/registerItem.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("thirdParty:register");function d(e,t,n){return e?t?"object"===r()(n)||"function"==typeof n||(u.warn("The %s is a %s, it should be an Object or a function.",n,r()(n)),!1):(u.warn("The %s must have a name in order to register.",e),!1):(u.warn("The type must be given in order to register."),!1)}t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(d(e,t,n))switch(e){case"module":Object(o.default)(t,n,a);break;case"mixin":Object(i.default)(t,n,a);break;default:Object(s.default)(e,t,n,a)}}},"./thirdParty/registerItem.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),r=n("./util/logger.js"),o=Object(r.getLogger)("thirdParty:registerType");function i(e){return void 0!==a.lib[e]}t.default=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s="".concat(e,"/").concat(t),l=i(s);!l||r?(l&&o.warn("Overwriting %s",s),a.lib[s]=n):o.warn("%s is already registered",s)}},"./thirdParty/registerMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),r=n("./mixins/index.js"),o=n("./util/logger.js"),i=Object(o.getLogger)("thirdParty:registerMixin");function s(e){return void 0!==r.default[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=s(e);!o||n?(o&&i.warn("Overwriting mixins/%s",e),r.default[e]=t,a.lib["mixins/".concat(e)]=r.default[e]):i.warn("mixins/%s is already registered",e)}},"./thirdParty/registerModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./util/logger.js"),o=Object(r.getLogger)("thirdParty:registerModule");function i(e){return void 0!==a.modules[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=i(e);!r||n?(r&&o.warn("Overwriting module %s",e),a.modules[e]=t,"function"==typeof a.modules[e].onRegisterCallback&&a.modules[e].onRegisterCallback()):o.warn("A module with the name %s is already registered",e)}},"./thirdParty/registerSome.js":function(e,t,n){"use strict";n.r(t);var a=n("./thirdParty/register.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach(function(e){var n=e.type,r=e.name,o=e.item;Object(a.default)(n,r,o,t)})}},"./toolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getToolOptions",function(){return r}),n.d(t,"setToolOptions",function(){return o}),n.d(t,"clearToolOptions",function(){return i}),n.d(t,"clearToolOptionsByToolType",function(){return s}),n.d(t,"clearToolOptionsByToolName",function(){return l}),n.d(t,"clearToolOptionsByElement",function(){return u});var a={};function r(e,t){if(!a[e])return{};var n=a[e].find(function(e){return e.element===t});return n?n.options:{}}function o(e,t,n){if(a[e]){var r=a[e].findIndex(function(e){return e.element===t});-1===r?a[e].push({element:t,options:n}):a[e][r].options=Object.assign(a[e][r].options||{},n)}else a[e]=[{element:t,options:n}]}function i(e,t){var n=a[e];n&&(a[e]=n.filter(function(e){return e.element!==t}))}function s(e){return l(e)}function l(e){delete a[e]}function u(e){for(var t in a)a[t]=a[t].filter(function(t){return t.element!==e})}},"./tools/CrosshairsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./tools/base/BaseTool.js"),v=n("./externalModules.js"),p=n("./stateManagement/loadHandlerManager.js"),b=n("./stateManagement/toolState.js"),y=n("./util/pointProjector.js"),x=n("./util/convertToVector3.js"),j=n("./toolOptions.js"),w=n("./tools/cursors/index.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:w.crosshairsCursor};return(e=l()(this,d()(t).call(this,n,a))).preMouseDownCallback=e._chooseLocation.bind(f()(e)),e.mouseDragCallback=e._chooseLocation.bind(f()(e)),e.touchDragCallback=e._chooseLocation.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_chooseLocation",value:function(e){var t=e.detail,n=t.element;e.stopImmediatePropagation();var a=Object(b.getToolState)(n,this.name);if(a){var r=n,o=v.default.cornerstone.getEnabledElement(r),i=v.default.cornerstone.metaData.get("imagePlaneModule",o.image.imageId);if(i){var s=t.currentPoints.image,l=Object(y.imagePointToPatientPoint)(s,i);a.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==r){var t=Number.MAX_VALUE,n=-1,a=Object(b.getToolState)(e,"stack");if(void 0!==a){var o=a.data[0];if(o.imageIds.forEach(function(e,a){var r=v.default.cornerstone.metaData.get("imagePlaneModule",e);if(r&&r.imagePositionPatient&&r.rowCosines&&r.columnCosines){var o=Object(x.default)(r.imagePositionPatient),i=Object(x.default)(r.rowCosines),s=Object(x.default)(r.columnCosines).clone().cross(i.clone()),u=Math.abs(s.clone().dot(o)-s.clone().dot(l));u<t&&(t=u,n=a)}}),n!==o.currentImageIdIndex&&-1!==n&&void 0!==o.imageIds[n]){var i=p.default.getStartLoadHandler(e),s=p.default.getEndLoadHandler(e),u=p.default.getErrorLoadingHandler(e);i&&i(e),(!0===o.preventCache?v.default.cornerstone.loadImage(o.imageIds[n]):v.default.cornerstone.loadAndCacheImage(o.imageIds[n])).then(function(t){var a=v.default.cornerstone.getViewport(e);o.currentImageIdIndex=n,v.default.cornerstone.displayImage(e,t,a),s&&s(e,t)},function(t){u&&u(e,o.imageIds[n],t)})}}}})}}}},{key:"activeCallback",value:function(e,t){var n=t.mouseButtonMask,a=t.synchronizationContext;Object(j.setToolOptions)(this.name,e,{mouseButtonMask:n}),Object(b.clearToolState)(e,this.name),Object(b.addToolState)(e,this.name,{synchronizationContext:a})}}]),t}(h.default)},"./tools/DoubleTapFitToWindowTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"doubleTapCallback",value:function(e){m.default.cornerstone.fitToWindow(e.detail.element)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/DragProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./stateManagement/textStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./util/getRGBPixels.js"),x=n("./util/calculateSUV.js"),j=n("./drawing/index.js"),w=n("./drawing/drawTextBox.js"),T=n("./tools/cursors/index.js"),E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"DragProbe",strategies:{default:O,minimal:C},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.probeCursor};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._movingEventCallback.bind(f()(e)),e.touchEndCallback=e._endMovingEventCallback.bind(f()(e)),e.mouseDragCallback=e._movingEventCallback.bind(f()(e)),e.mouseUpCallback=e._endMovingEventCallback.bind(f()(e)),e.dragEventData={},e}return g()(t,e),i()(t,[{key:"_movingEventCallback",value:function(e){var t=e.detail,n=t.element;this.dragEventData=t,h.default.cornerstone.updateImage(n)}},{key:"_endMovingEventCallback",value:function(e){var t=e.detail.element;this.dragEventData={},h.default.cornerstone.updateImage(t)}},{key:"renderToolData",value:function(e){this.dragEventData.currentPoints&&e&&e.detail&&Boolean(Object.keys(this.dragEventData.currentPoints).length)&&(e.detail.currentPoints=this.dragEventData.currentPoints,this.applyActiveStrategy(e))}}]),t}(v.default);function O(e){var t=this.configuration,n=h.default.cornerstone,a=e.detail,r=a.element,o=a.image,i=a.currentPoints,s=a.canvasContext,l=Object(j.getNewContext)(s.canvas),u=b.default.getActiveColor(),d=p.default.getFontSize(),c=Math.round(i.image.x),f=Math.round(i.image.y);c<0||f<0||c>=o.columns||f>=o.rows||Object(j.draw)(l,function(e){Object(j.setShadow)(e,t);var a,s,l="".concat(c,", ").concat(f);if(o.color)a=Object(y.default)(r,c,f,1,1),s="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]," A: ").concat(a[3]);else{var m=(a=n.getStoredPixels(r,c,f,1,1))[0],g=m*o.slope+o.intercept,h=Object(x.default)(o,m);s="SP: ".concat(m," MO: ").concat(parseFloat(g.toFixed(3))),h&&(s+=" SUV: ".concat(parseFloat(h.toFixed(3))))}var v={x:i.canvas.x+5,y:i.canvas.y-5};Object(w.default)(e,s,v.x,v.y+d+5,u),Object(w.default)(e,l,v.x,v.y,u)})}function C(e){var t=this.configuration,n=h.default.cornerstone,a=e.detail,r=a.element,o=a.image,i=a.currentPoints,s=a.canvasContext,l=a.isTouchEvent,u=Object(j.getNewContext)(s.canvas),d=b.default.getActiveColor(),c=i.page.y-p.default.getFontSize()/2;l&&(c=i.page.y-4*p.default.getFontSize());var f=n.pageToPixel(r,i.page.x,c);f.x<0||f.y<0||f.x>=o.columns||f.y>=o.rows||Object(j.draw)(u,function(e){Object(j.setShadow)(e,t);var a,i=n.metaData.get("generalSeriesModule",o.imageId),s=i&&i.modality,u="";if(o.color)a=Object(y.default)(r,f.x,f.y,1,1),u="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]);else{var c=(a=n.getStoredPixels(r,f.x,f.y,1,1))[0],m=parseFloat((c*o.slope+o.intercept).toFixed(2));if("CT"===s)u+="HU: ".concat(m);else if("PT"===s){u+=m;var g=Object(x.default)(o,c);g&&(u+=" SUV: ".concat(parseFloat(g.toFixed(2))))}else u+=m}var h=n.pixelToCanvas(r,f),v={x:12,y:-(p.default.getFontSize()+10)/2},b=Object(w.textBoxWidth)(e,u,5);l&&(v={x:-b/2,y:-p.default.getFontSize()-10-12}),Object(j.drawCircle)(e,r,h,6,{color:d},"canvas"),Object(w.default)(e,u,h.x+v.x,h.y+v.y,d)})}},"./tools/EraserTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./stateManagement/toolState.js"),b=n("./store/index.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:y.eraserCursor};return(e=l()(this,d()(t).call(this,n,a))).preMouseDownCallback=e._deleteAllNearbyTools.bind(f()(e)),e.preTouchStartCallback=e._deleteAllNearbyTools.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_deleteAllNearbyTools",value:function(e){var t=e.detail.currentPoints.canvas,n=e.detail.element;return b.state.tools.forEach(function(e){var a=Object(p.getToolState)(n,e.name);a&&a.data.forEach(function(a){"function"==typeof e.pointNearTool&&e.pointNearTool(n,a,t)&&(Object(p.removeToolState)(n,e.name,a),h.default.cornerstone.updateImage(n))})}),!0}}]),t}(v.default)},"./tools/FreehandRoiSculptorTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return I});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./events.js"),v=n("./externalModules.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/drawHandles.js"),y=n("./store/index.js"),x=n("./stateManagement/toolState.js"),j=n("./util/clip.js"),w=n("./store/getToolForElement.js"),T=n("./tools/base/BaseTool.js"),E=n("./store/setToolCursor.js"),O=n("./tools/cursors/index.js"),C=n("./util/freehand/index.js"),M=C.default.FreehandHandleData,I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"FreehandRoiSculptor",referencedToolName:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:S(),svgCursor:O.freehandRoiSculptorCursor};return(e=l()(this,d()(t).call(this,n,a))).updateOnMouseMove=!0,e.isMultiPartTool=!0,e.referencedToolName=e.initialConfiguration.referencedToolName,e._active=!1,e.activeMouseUpCallback=e.activeMouseUpCallback.bind(f()(e)),e.activeTouchEndCallback=e.activeTouchEndCallback.bind(f()(e)),e.activeMouseDragCallback=e.activeMouseDragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=e.detail;if(null===this.configuration.currentTool)return!1;var n=t.element,a=this.configuration;if(!Object(x.getToolState)(n,this.referencedToolName).data[a.currentTool])return!1;if(this._active){var r=t.canvasContext.canvas.getContext("2d"),o={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(b.default)(r,t,this.configuration.mouseLocation.handles,o)}else this.configuration.showCursorOnHover&&!this._recentTouchEnd&&this._renderHoverCursor(e)}},{key:"doubleClickCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),v.default.cornerstone.updateImage(t.element)}},{key:"doubleTapCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),v.default.cornerstone.updateImage(t.element)}},{key:"preTouchStartCallback",value:function(e){return this._initialiseSculpting(e),!0}},{key:"preMouseDownCallback",value:function(e){if(this.options.mouseButtonMask.includes(e.detail.buttons))return this._initialiseSculpting(e),!0}},{key:"activeMouseDragCallback",value:function(e){var t=this.configuration;if(this._active){var n=e.detail,a=Object(x.getToolState)(n.element,this.referencedToolName);if(a){var r=a.data[t.currentTool].handles.points;this._getMouseLocation(n),this._sculpt(n,r),v.default.cornerstone.updateImage(n.element)}}}},{key:"activeMouseUpCallback",value:function(e){this._activeEnd(e)}},{key:"activeTouchEndCallback",value:function(e){this._activeEnd(e),this._deselectAllTools(e),this._recentTouchEnd=!0}},{key:"_activeEnd",value:function(e){var t=e.detail,n=t.element,a=this.configuration;this._active=!1,y.state.isMultiPartToolActive=!1,this._getMouseLocation(t),this._invalidateToolData(t),a.mouseUpRender=!0,this._deactivateSculpt(n),v.default.cornerstone.updateImage(t.element),function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}(e)}},{key:"_renderHoverCursor",value:function(e){var t,n=e.detail,a=n.element,r=n.canvasContext.canvas.getContext("2d"),o=Object(x.getToolState)(a,this.referencedToolName).data[this.configuration.currentTool];this._recentTouchEnd=!1,this.configuration.mouseUpRender?(t=this.configuration.mouseLocation.handles.start,this.configuration.mouseUpRender=!1):t=y.state.mousePositionImage;var i=Object(w.default)(a,this.referencedToolName).distanceFromPointCanvas(a,o,t);if(this.configuration.mouseLocation.handles.start.x=t.x,this.configuration.mouseLocation.handles.start.y=t.y,this.configuration.limitRadiusOutsideRegion){var s=i;i=this._limitCursorRadiusCanvas(n,i),s>this.configuration.hoverCursorFadeDistance*i&&(r.globalAlpha=this.configuration.hoverCursorFadeAlpha)}var l={fill:null,color:this.configuration.hoverColor,handleRadius:i};Object(b.default)(r,n,this.configuration.mouseLocation.handles,l),this.configuration.limitRadiusOutsideRegion&&(r.globalAlpha=1)}},{key:"newImageCallback",value:function(e){this._deselectAllTools(e)}},{key:"enabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"passiveCallback",value:function(e){this._deselectAllTools(e)}},{key:"disabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"_selectFreehandTool",value:function(e){var t=this.configuration,n=e.element,a=this._getClosestFreehandToolOnElement(n,e);void 0!==a&&(t.currentTool=a,Object(E.hideToolCursor)(n))}},{key:"_activateFreehandTool",value:function(e,t){var n=Object(x.getToolState)(e,this.referencedToolName).data;this.configuration.currentTool=t;for(var a=0;a<n.length;a++)n[a].active=a===t}},{key:"_initialiseSculpting",value:function(e){var t=e.detail,n=this.configuration,a=t.element;null===n.currentTool&&(this._selectFreehandTool(t),null===n.currentTool)||(this._active=!0,y.state.isMultiPartToolActive=!0,this._configureToolSize(t),this._getMouseLocation(t),this._activateFreehandTool(a,n.currentTool),this._activateSculpt(a),v.default.cornerstone.updateImage(t.element))}},{key:"_sculpt",value:function(e,t){var n=this.configuration;this._sculptData={element:e.element,image:e.image,mousePoint:e.currentPoints.image,points:t,toolSize:this._toolSizeImage,minSpacing:n.minSpacing,maxSpacing:Math.max(this._toolSizeImage,2*n.minSpacing)};var a=this._pushHandles();void 0!==a.first&&(this._insertNewHandles(a),this._consolidateHandles())}},{key:"_pushHandles",value:function(){for(var e=this._sculptData,t=e.points,n=e.mousePoint,a=e.toolSize,r={},o=0;o<t.length;o++){var i=v.default.cornerstoneMath.point.distance(t[o],n);i>a||(this._pushOneHandle(o,i),void 0===r.first?(r.first=o,r.last=o):r.last=o)}return r}},{key:"_pushOneHandle",value:function(e,t){var n=this._sculptData,a=n.points,r=n.mousePoint,o=n.toolSize,i=n.image,s=a[e],l={x:r.x+o*((s.x-r.x)/t),y:r.y+o*((s.y-r.y)/t)};Object(j.clipToBox)(l,i),s.x=l.x,s.y=l.y;var u=this.constructor._getPreviousHandleIndex(e,a.length);a[u].lines.pop(),a[u].lines.push(s)}},{key:"_insertNewHandles",value:function(e){for(var t=this._findNewHandleIndicies(e),n=0,a=0;a<t.length;a++)this._insertHandleRadially(t[a]+1+n),n++}},{key:"_findNewHandleIndicies",value:function(e){for(var t=this._sculptData,n=t.points,a=t.maxSpacing,r=[],o=e.first;o<=e.last;o++)this._checkSpacing(o,n,r,a);var i=this.constructor._getNextHandleIndex(e.last,n.length);if(i!==e.first){this._checkSpacing(i,n,r,a);var s=this.constructor._getPreviousHandleIndex(e.first,n.length);s!==i&&this._checkSpacing(s,n,r,a)}return r}},{key:"_checkSpacing",value:function(e,t,n,a){var r=this.constructor._getNextHandleIndex(e,t.length);v.default.cornerstoneMath.point.distance(t[e],t[r])>a&&n.push(e)}},{key:"_insertHandleRadially",value:function(e){var t=this._sculptData.points,n=e-1,a=this.constructor._getNextHandleIndexBeforeInsert(e,t.length),r=this._getInsertPosition(e,n,a),o=new M(r);t.splice(e,0,o),t[n].lines.pop(),t[n].lines.push(t[e]),C.default.addLine(t,e)}},{key:"_consolidateHandles",value:function(){if(!(this._sculptData.points.length<=3)){var e=this._findCloseHandlePairs();this._mergeCloseHandles(e)}}},{key:"_findCloseHandlePairs",value:function(){for(var e=this._sculptData,t=e.points,n=e.minSpacing,a=[],r=t.length,o=0;o<r;o++){var i=this.constructor._getNextHandleIndex(o,t.length);v.default.cornerstoneMath.point.distance(t[o],t[i])<n&&(a.push([o,i]),0===o&&(r-=1),o++)}return a}},{key:"_mergeCloseHandles",value:function(e){for(var t=0,n=0;n<e.length;n++){var a=this.constructor._getCorrectedPair(e[n],t);this._combineHandles(a),t++}var r=this._findCloseHandlePairs();r.length&&this._mergeCloseHandles(r)}},{key:"_combineHandles",value:function(e){var t=this._sculptData,n=t.points,a=t.image,r={x:(n[e[0]].x+n[e[1]].x)/2,y:(n[e[0]].y+n[e[1]].y)/2};Object(j.clipToBox)(r,a),n[e[0]].x=r.x,n[e[0]].y=r.y;var o=this.constructor._getNextHandleIndex(e[1],n.length);n[e[0]].lines.pop(),n[e[0]].lines.push(n[o]),n.splice(e[1],1)}},{key:"_configureToolSize",value:function(e){var t=e.element,n=this.configuration,a=n.currentTool,r=e.currentPoints.image,o=Object(x.getToolState)(t,this.referencedToolName).data[a],i=Object(w.default)(t,this.referencedToolName),s=i.distanceFromPoint(t,o,r),l=i.distanceFromPointCanvas(t,o,r);n.limitRadiusOutsideRegion&&(s=this._limitCursorRadiusImage(e,s),l=this._limitCursorRadiusCanvas(e,l)),this._toolSizeImage=s,this._toolSizeCanvas=l}},{key:"_getMouseLocation",value:function(e){var t=this.configuration;t.mouseLocation.handles.start.x=e.currentPoints.image.x,t.mouseLocation.handles.start.y=e.currentPoints.image.y,Object(j.clipToBox)(t.mouseLocation.handles.start,e.image)}},{key:"_activateSculpt",value:function(e){this._deactivateSculpt(e),e.addEventListener(h.default.MOUSE_UP,this.activeMouseUpCallback),e.addEventListener(h.default.MOUSE_CLICK,this.activeMouseUpCallback),e.addEventListener(h.default.MOUSE_DRAG,this.activeMouseDragCallback),e.addEventListener(h.default.TOUCH_END,this.activeTouchEndCallback),e.addEventListener(h.default.TOUCH_TAP,this.activeTouchEndCallback),e.addEventListener(h.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_deactivateSculpt",value:function(e){e.removeEventListener(h.default.MOUSE_UP,this.activeMouseUpCallback),e.removeEventListener(h.default.MOUSE_CLICK,this.activeMouseUpCallback),e.removeEventListener(h.default.MOUSE_DRAG,this.activeMouseDragCallback),e.removeEventListener(h.default.TOUCH_END,this.activeTouchEndCallback),e.removeEventListener(h.default.TOUCH_TAP,this.activeTouchEndCallback),e.removeEventListener(h.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_invalidateToolData",value:function(e){var t=this.configuration,n=e.element;Object(x.getToolState)(n,this.referencedToolName).data[t.currentTool].invalidated=!0}},{key:"_deselectAllTools",value:function(e){var t=this.configuration,n=Object(x.getToolState)(this.element,this.referencedToolName);if(t.currentTool=null,n)for(var a=0;a<n.data.length;a++)n.data[a].active=!1;Object(E.setToolCursor)(this.element,this.svgCursor),v.default.cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function(e,t){return this._limitCursorRadius(e,t,!0)}},{key:"_limitCursorRadiusImage",value:function(e,t){return this._limitCursorRadius(e,t,!1)}},{key:"_limitCursorRadius",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.element,r=e.image,o=this.configuration,i=Object(x.getToolState)(a,this.referencedToolName),s=i.data[o.currentTool],l=1;if(n){var u=v.default.cornerstone.pixelToCanvas(a,{x:0,y:0}),d=v.default.cornerstone.pixelToCanvas(a,{x:r.width,y:r.height}),c=(d.x-u.x)*(d.y-u.y);l=c/(r.width*r.height)}var f=s.area*l,m=Math.pow(f/Math.PI,.5);return Math.min(t,m)}},{key:"_getClosestFreehandToolOnElement",value:function(e,t){var n=Object(w.default)(e,this.referencedToolName),a=Object(x.getToolState)(e,this.referencedToolName);if(a){for(var r=a.data,o=t.currentPoints.image,i={distance:1/0,toolIndex:null},s=0;s<r.length;s++){var l=n.distanceFromPoint(e,r[s],o);-1!==l&&l<i.distance&&(i.distance=l,i.toolIndex=s)}return i.toolIndex}}},{key:"_getInsertPosition",value:function(e,t,n){var a,r=this._sculptData,o=r.points,i=r.toolSize,s=r.mousePoint,l=r.image,u={x:(o[t].x+o[n].x)/2,y:(o[t].y+o[n].y)/2},d=v.default.cornerstoneMath.point.distance(s,u);if(d<i){var c={x:(u.x-s.x)/d,y:(u.y-s.y)/d};a={x:s.x+i*c.x,y:s.y+i*c.y}}else a=u;return Object(j.clipToBox)(a,l),a}},{key:"minSpacing",get:function(){return this.configuration.minSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");this.configuration.minSpacing=e}},{key:"maxSpacing",get:function(){return this.configuration.maxSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");this.configuration.maxSpacing=e}},{key:"showCursorOnHover",get:function(){return this.configuration.showCursorOnHover},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");this.configuration.showCursorOnHover=e,v.default.cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function(){return this.configuration.limitRadiusOutsideRegion},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");this.configuration.limitRadiusOutsideRegion=e,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function(){return this.configuration.hoverCursorFadeAlpha},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");e=Math.max(Math.min(e,1),0),this.configuration.hoverCursorFadeAlpha=e,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function(){return this.configuration.hoverCursorFadeDistance},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");e=Math.max(e,1),this.configuration.hoverCursorFadeDistance=e,v.default.cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function(e,t){var n=[e[0]-t,e[1]-t];return n[1]<0&&(n[1]=0),n}},{key:"_getNextHandleIndex",value:function(e,t){return e===t-1?0:e+1}},{key:"_getPreviousHandleIndex",value:function(e,t){return 0===e?t-1:e-1}},{key:"_getNextHandleIndexBeforeInsert",value:function(e,t){return e===t?0:e}}]),t}(T.default);function S(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:p.default.getActiveColor(),hoverColor:p.default.getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2}}},"./tools/MagnifyTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=n("./drawing/index.js"),p=n("./tools/base/BaseTool.js"),b=n("./store/setToolCursor.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:y.magnifyCursor};return(e=l()(this,d()(t).call(this,n,a))).zoomCanvas=void 0,e.zoomElement=void 0,e.activeCallback=e._createMagnificationCanvas.bind(f()(e)),e.enabledCallback=e._createMagnificationCanvas.bind(f()(e)),e.disabledCallback=e._destroyMagnificationCanvas.bind(f()(e)),e.postTouchStartCallback=e._addMagnifyingGlass.bind(f()(e)),e.touchDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.touchEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.touchDragEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.postMouseDownCallback=e._addMagnifyingGlass.bind(f()(e)),e.mouseDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.mouseUpCallback=e._removeMagnifyingGlass.bind(f()(e)),e.mouseClickCallback=e._removeMagnifyingGlass.bind(f()(e)),e.newImageCallback=e._drawMagnificationTool.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_addMagnifyingGlass",value:function(e){var t=this;this._removeZoomElement(),this._drawZoomedElement(e),window.requestAnimationFrame(function(){return t._drawMagnificationTool(e)}),Object(b.hideToolCursor)(e.detail.element),e.preventDefault(),e.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function(e){this._drawMagnificationTool(e),e.preventDefault(),e.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function(e){var t=e.detail.element;Object(b.setToolCursor)(this.element,this.svgCursor),t.querySelector(".magnifyTool").style.display="none",this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function(e){var t=e.detail.element,n=t.querySelector(".magnifyTool");if(n||this._createMagnificationCanvas(t),void 0!==this.zoomCanvas){var a=t.querySelector("canvas:not(.magnifyTool)"),r=Object(v.getNewContext)(n),o=h.default.cornerstone.pixelToCanvas(e.detail.element,e.detail.currentPoints.image),i=Math.min(this.configuration.magnifySize,a.width,a.height),s=this.configuration.magnificationLevel;n.width=i,n.height=i,o.x=Math.max(o.x,.5*i/s),o.x=Math.min(o.x,a.width-.5*i/s),o.y=Math.max(o.y,.5*i/s),o.y=Math.min(o.y,a.height-.5*i/s);var l={x:o.x*s-.5*i,y:o.y*s-.5*i};l.x=Math.max(l.x,0),l.y=Math.max(l.y,0),r.drawImage(this.zoomCanvas,l.x,l.y,i,i,0,0,i,i);var u={top:Math.max(o.y-.5*i-(e.detail.isTouchEvent?120:0),0),left:Math.max(o.x-.5*i,0)},d=n.getBoundingClientRect();u.top=Math.min(u.top,a.height-d.height),u.left=Math.min(u.left,a.width-d.width),n.style.top="".concat(u.top,"px"),n.style.left="".concat(u.left,"px"),n.style.display="block"}}},{key:"_drawZoomedElement",value:function(e){var t=e.detail.enabledElement;void 0===t&&(t=h.default.cornerstone.getEnabledElement(e.detail.element));var n=this.configuration.magnificationLevel,a=t.canvas,r=t.image;this.zoomElement||(this.zoomElement=document.createElement("div"),this.zoomElement.width=a.width*n,this.zoomElement.height=a.height*n,h.default.cornerstone.enable(this.zoomElement,t.options));var o=h.default.cornerstone.getEnabledElement(this.zoomElement),i=h.default.cornerstone.getViewport(t.element);this.zoomCanvas=o.canvas,this.zoomCanvas.width=a.width*n,this.zoomCanvas.height=a.height*n,o.viewport=Object.assign({},i),i.scale*=n,h.default.cornerstone.displayImage(this.zoomElement,r),h.default.cornerstone.setViewport(this.zoomElement,i)}},{key:"_removeZoomElement",value:function(){void 0!==this.zoomElement&&(h.default.cornerstone.disable(this.zoomElement),this.zoomElement=void 0,this.zoomCanvas=void 0)}},{key:"_createMagnificationCanvas",value:function(e){if(null===e.querySelector(".magnifyTool")){var t=document.createElement("canvas");t.classList.add("magnifyTool"),t.width=this.configuration.magnifySize,t.height=this.configuration.magnifySize,t.style.position="absolute",t.style.display="none",e.appendChild(t)}}},{key:"_destroyMagnificationCanvas",value:function(e){var t=e.querySelector(".magnifyTool");t&&e.removeChild(t)}}]),t}(p.default)},"./tools/OrientationMarkersTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return y});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),h=n("./orientation/index.js"),v=n("./drawing/index.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/drawTextBox.js"),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"OrientationMarkers",configuration:{drawAllMarkers:!0},mixins:["enabledOrDisabledBinaryTool"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){var t=m.default.cornerstone;t.getEnabledElement(e).image&&t.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(v.getNewContext)(t.canvasContext.canvas),a=t.element,r=w(a);if(r){var o=T(a,r),i=p.default.getToolColor(),s={top:Object(b.textBoxWidth)(n,r.top,0),left:Object(b.textBoxWidth)(n,r.left,0),right:Object(b.textBoxWidth)(n,r.right,0),bottom:Object(b.textBoxWidth)(n,r.bottom,0),height:Object(b.textBoxWidth)(n,"M",0)};x(n,r,o,s,i),this.configuration.drawAllMarkers&&j(n,r,o,s,i)}}}]),t}(g.default),x=function(e,t,n,a,r){Object(b.default)(e,t.top,n.top.x-a.top/2,n.top.y,r),Object(b.default)(e,t.left,n.left.x-a.left/2,n.left.y,r)},j=function(e,t,n,a,r){Object(b.default)(e,t.right,n.right.x-a.right,n.right.y,r),Object(b.default)(e,t.bottom,n.bottom.x-a.bottom/2,n.bottom.y-a.height,r)},w=function(e){var t=m.default.cornerstone,n=t.getEnabledElement(e),a=t.metaData.get("imagePlaneModule",n.image.imageId);if(a&&a.rowCosines&&a.columnCosines){var r=h.default.getOrientationString(a.rowCosines),o=h.default.getOrientationString(a.columnCosines),i=h.default.invertOrientationString(r);return{top:h.default.invertOrientationString(o),bottom:o,left:i,right:r}}},T=function(e){var t=m.default.cornerstone.getEnabledElement(e);return{top:m.default.cornerstone.pixelToCanvas(e,{x:t.image.width/2,y:5}),bottom:m.default.cornerstone.pixelToCanvas(e,{x:t.image.width/2,y:t.image.height-15}),left:m.default.cornerstone.pixelToCanvas(e,{x:5,y:t.image.height/2}),right:m.default.cornerstone.pixelToCanvas(e,{x:t.image.width-10,y:t.image.height/2})}}},"./tools/OverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Overlay",configuration:{},mixins:["enabledOrDisabledBinaryTool"]},o=Object.assign(a,n);return(e=l()(this,d()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){m.default.cornerstone.getEnabledElement(e).image&&m.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=t.image,a=t.viewport,r=t.canvasContext;if(t&&t.enabledElement&&n){var o=m.default.cornerstone.metaData.get("overlayPlaneModule",n.imageId);if(o&&o.overlays&&o.overlays.length){var i=a.displayedArea.columnPixelSpacing||1,s=a.displayedArea.rowPixelSpacing||1,l=Math.abs(a.displayedArea.brhc.x-a.displayedArea.tlhc.x)*i,u=Math.abs(a.displayedArea.brhc.y-a.displayedArea.tlhc.y)*s;o.overlays.forEach(function(e){if(!1!==e.visible){var t=document.createElement("canvas");t.width=l,t.height=u;var n=t.getContext("2d");n.fillStyle=e.fillStyle||"white","R"===e.type&&(n.fillRect(0,0,t.width,t.height),n.globalCompositeOperation="xor");for(var a=0,o=0;o<e.rows;o++)for(var i=0;i<e.columns;i++)e.pixelData[a++]>0&&n.fillRect(i,o,1,1);var s=!isNaN(parseFloat(e.x))&&isFinite(e.x)?e.x:0,d=!isNaN(parseFloat(e.y))&&isFinite(e.y)?e.y:0;r.drawImage(t,s,d)}})}}}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/PanMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}};return(e=l()(this,d()(t).call(this,n,a))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport;if(t.numPointers===this.configuration.touchPointers){var r=this._getTranslation(t);this._applyTranslation(a,r),h.default.cornerstone.setViewport(n,a)}}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,r=t.scale,o=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?r*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(o*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/r,y:a.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/PanTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return b});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./tools/cursors/index.js"),b=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:p.panCursor};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._dragCallback.bind(f()(e)),e.mouseDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=this._getTranslation(t);this._applyTranslation(a,r),h.default.cornerstone.setViewport(n,a)}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,r=t.scale,o=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?r*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(o*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/r,y:a.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(v.default)},"./tools/ReferenceLinesTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var a=n("../node_modules/@babel/runtime/regenerator/index.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/createClass.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=n.n(m),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),v=n.n(h),p=n("./externalModules.js"),b=n("./tools/base/BaseTool.js"),y=n("./drawing/index.js"),x=n("./tools/referenceLines/renderActiveReferenceLine.js"),j=n("./util/wait.js"),w=n("./util/logger.js"),T=Object(w.getLogger)("tools:ReferenceLinesTool"),E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l()(this,t);var a={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:x.default}};return(e=f()(this,g()(t).call(this,n,a))).renderer=null,e.synchronizationContext=null,e}var n;return v()(t,e),d()(t,[{key:"enabledCallback",value:(n=i()(r.a.mark(function e(t){var n,a,o=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(o.length>1&&void 0!==o[1]?o[1]:{}).synchronizationContext,a=this.configuration.renderer,e.next=4,Object(j.waitForEnabledElementImageToLoad)(t);case 4:if(e.sent&&a&&n){e.next=8;break}return T.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render.")),e.abrupt("return");case 8:this.renderer=a,this.synchronizationContext=n,this.forceImageUpdate(t);case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){p.default.cornerstone.getEnabledElement(e).image&&p.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=this,n=e.detail;if(this.renderer&&this.synchronizationContext){var a=this.synchronizationContext.getSourceElements(),r=Object(y.getNewContext)(n.canvasContext.canvas);p.default.cornerstone.setToPixelCoordinateSystem(n.enabledElement,r),a.forEach(function(a){a!==e.currentTarget&&t.renderer(r,n,e.currentTarget,a)})}}}]),t}(b.default)},"./tools/RotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),h=n("./util/angleBetweenPoints.js"),v=n("./tools/cursors/index.js"),p=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"Rotate",strategies:{default:b,horizontal:y,vertical:x},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{roundAngles:!1,flipHorizontal:!1,flipVertical:!1,rotateScale:1},svgCursor:v.rotateCursor};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){this.dragCallback(e)}},{key:"mouseDragCallback",value:function(e){this.dragCallback(e)}},{key:"postMouseDownCallback",value:function(e){this.initialRotation=e.detail.viewport.rotation}},{key:"dragCallback",value:function(e){e.detail.viewport.initialRotation=this.initialRotation,this.applyActiveStrategy(e),m.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(g.default);function b(e){var t=this.configuration,n=t.roundAngles,a=t.rotateScale,r=e.detail,o=r.element,i=r.viewport,s=r.startPoints,l=r.currentPoints,u=i.initialRotation?i.initialRotation:i.rotation,d=o.getBoundingClientRect(o),c=i.scale,f=i.translation,m={x:d.left+o.clientWidth/2+f.x*c,y:d.top+o.clientHeight/2+f.y*c},g=Object(h.default)(m,s.client,l.client);g.angle*=a,n&&(g.angle=Math.ceil(g.angle)),g.direction<0&&(g.angle=-g.angle),i.rotation=u+g.angle}function y(e){var t=this.configuration,n=t.flipHorizontal,a=e.detail,r=a.viewport,o=r.initialRotation,i=(a.currentPoints.client.x-a.startPoints.client.x)*t.rotateScale;t.roundAngles&&(i=Math.round(Math.abs(i))*(i>0?1:-1)),n&&(i=-i),r.rotation=o+i}function x(e){var t=this.configuration,n=t.flipVertical,a=e.detail,r=a.viewport,o=r.initialRotation,i=(a.currentPoints.client.y-a.startPoints.client.y)*t.rotateScale;t.roundAngles&&(i=Math.round(Math.abs(i))*(i>0?1:-1)),n&&(i=-i),r.rotation=o+i}},"./tools/RotateTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchRotateCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport;a.rotation+=t.rotation,m.default.cornerstone.setViewport(n,a)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/ScaleOverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),h=n("./drawing/index.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./util/logger.js"),y=Object(b.getLogger)("tools:ScaleOverlayTool"),x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){m.default.cornerstone.getEnabledElement(e).image&&m.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(h.getNewContext)(t.canvasContext.canvas),a=t.image,r=t.viewport,o=t.element,i=a.rowPixelSpacing,s=a.columnPixelSpacing,l=m.default.cornerstone.metaData.get("imagePlaneModule",a.imageId);if(l&&(i=l.rowPixelSpacing||l.rowImagePixelSpacing,s=l.columnPixelSpacing||l.colImagePixelSpacing),i&&s){var u={width:n.canvas.width,height:n.canvas.height},d=10/i*r.scale,c=10/s*r.scale,f=j(u,.25,.05),g=j(u,.05,.15);if(u.width&&u.height&&f&&g){var b=p.default.getToolColor(),x=v.default.getToolWidth(),E=Object.assign({},{hscaleBounds:f,vscaleBounds:g,verticalMinorTick:d,horizontalMinorTick:c,verticalLine:{start:{x:g.bottomRight.x,y:g.topLeft.y},end:{x:g.bottomRight.x,y:g.bottomRight.y}},horizontalLine:{start:{x:f.topLeft.x,y:f.bottomRight.y},end:{x:f.bottomRight.x,y:f.bottomRight.y}},color:b,lineWidth:x},this.configuration);Object(h.draw)(n,function(e){Object(h.setShadow)(e,E),Object(h.drawLine)(e,o,E.verticalLine.start,E.verticalLine.end,{color:E.color,lineWidth:E.lineWidth},"canvas"),w(e,o,E),Object(h.drawLine)(e,o,E.horizontalLine.start,E.horizontalLine.end,{color:E.color,lineWidth:E.lineWidth},"canvas"),T(e,o,E)})}}else y.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"))}}]),t}(g.default),j=function(e,t,n){var a=t*Math.min(1e3,e.width),r=n*Math.min(1e3,e.height),o={left:a,top:r,width:e.width-2*a,height:e.height-2*r};return{topLeft:{x:o.left,y:o.top},bottomRight:{x:o.left+o.width,y:o.top+o.height}}},w=function(e,t,n){for(var a=0;n.verticalLine.start.y+a*n.verticalMinorTick<=n.vscaleBounds.bottomRight.y;){var r=n.color,o=n.lineWidth,i={x:n.verticalLine.start.x,y:n.verticalLine.start.y+a*n.verticalMinorTick},s={x:0,y:n.verticalLine.start.y+a*n.verticalMinorTick};s.x=a%5==0?n.verticalLine.start.x-n.majorTickLength:n.verticalLine.start.x-n.minorTickLength,Object(h.drawLine)(e,t,i,s,{color:r,lineWidth:o},"canvas"),a++}},T=function(e,t,n){for(var a=0;n.horizontalLine.start.x+a*n.horizontalMinorTick<=n.hscaleBounds.bottomRight.x;){var r=n.color,o=n.lineWidth,i={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:n.horizontalLine.start.y},s={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:0};s.y=a%5==0?n.horizontalLine.start.y-n.majorTickLength:n.horizontalLine.start.y-n.minorTickLength,Object(h.drawLine)(e,t,i,s,{color:r,lineWidth:o},"canvas"),a++}}},"./tools/StackScrollMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return h});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./tools/base/BaseTool.js"),g=n("./util/scroll.js"),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.direction,a=t.element,r=this.configuration,o=r.loop,i=r.allowSkipping,s=r.invert?-n:n;Object(g.default)(a,s,o,i)}}]),t}(m.default)},"./tools/StackScrollMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return y});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./tools/base/BaseTool.js"),v=n("./util/scroll.js"),p=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}};return(e=l()(this,d()(t).call(this,n,a))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail;if(t.numPointers===this.configuration.touchPointers){var n=t.element,a=t.deltaPoints,r=this.configuration,o=r.loop,i=r.allowSkipping,s=Object(b.getToolOptions)(this.name,n),l=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(!l)return;if(Math.abs(u)>=l){var d=Math.round(u/l);Object(v.default)(n,d,o,i),s.deltaY=u%l}else s.deltaY=u;Object(b.setToolOptions)(this.name,n,s)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(p.getToolState)(e,"stack");if(t&&t.data&&t.data.length)return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(t.data[0].imageIds.length,8))}}]),t}(h.default)},"./tools/StackScrollTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./tools/base/BaseTool.js"),v=n("./util/scroll.js"),p=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:y.stackScrollCursor};return(e=l()(this,d()(t).call(this,n,a))).mouseDragCallback=e._dragCallback.bind(f()(e)),e.touchDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.deltaPoints,r=this.configuration,o=r.loop,i=r.allowSkipping,s=Object(b.getToolOptions)(this.name,n),l=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(l){if(Math.abs(u)>=l){var d=Math.round(u/l);Object(v.default)(n,d,o,i),s.deltaY=u%l}else s.deltaY=u;Object(b.setToolOptions)(this.name,n,s)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(p.getToolState)(e,"stack");if(t&&t.data&&t.data.length)return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(t.data[0].imageIds.length,8))}}]),t}(h.default)},"./tools/WwwcRegionTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return w});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./drawing/index.js"),b=n("./util/clip.js"),y=n("./util/getLuminance.js"),x=n("./stateManagement/toolColors.js"),j=n("./tools/cursors/index.js"),w=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:j.wwwcRegionCursor};return(e=l()(this,d()(t).call(this,n,a)))._resetHandles(),e.postTouchStartCallback=e._startOutliningRegion.bind(f()(e)),e.touchDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.touchEndCallback=e._applyStrategy.bind(f()(e)),e.postMouseDownCallback=e._startOutliningRegion.bind(f()(e)),e.mouseClickCallback=e._startOutliningRegion.bind(f()(e)),e.mouseDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseMoveCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseUpCallback=e._applyStrategy.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,r=x.default.getColorIfActive({active:!0}),o=Object(p.getNewContext)(n.canvasContext.canvas);Object(p.draw)(o,function(e){Object(p.drawRect)(e,a,t.handles.start,t.handles.end,{color:r})})}},{key:"_startOutliningRegion",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.image;return T(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),h.default.cornerstone.updateImage(t),!0}},{key:"_setHandlesAndUpdate",value:function(e){var t=e.detail.element;this.handles.end=e.detail.currentPoints.image,h.default.cornerstone.updateImage(t)}},{key:"_applyStrategy",value:function(e){T(this.handles.start)||T(this.handles.end)||(e.detail.handles=this.handles,E(e,this.configuration),this._resetHandles())}},{key:"_resetHandles",value:function(){this.handles={start:{},end:{}}}}]),t}(v.default),T=function(e){return 0===Object.keys(e).length&&e.constructor===Object},E=function(e,t){var n=e.detail,a=n.image,r=n.element,o=e.detail.handles,i=o.start,s=o.end,l=Math.min(i.x,s.x),u=Math.min(i.y,s.y),d=Math.abs(i.x-s.x),c=Math.abs(i.y-s.y);l=Object(b.default)(l,0,a.width),u=Object(b.default)(u,0,a.height),d=Math.floor(Math.min(d,Math.abs(a.width-l))),c=Math.floor(Math.min(c,Math.abs(a.height-u)));var f=Object(y.default)(r,l,u,d,c),m=O(f,a.minPixelValue,a.maxPixelValue),g=n.viewport;void 0===t.minWindowWidth&&(t.minWindowWidth=10),g.voi.windowWidth=Math.max(Math.abs(m.max-m.min),t.minWindowWidth),g.voi.windowCenter=m.mean,g.voiLUT=void 0,h.default.cornerstone.setViewport(r,g),h.default.cornerstone.updateImage(r)},O=function(e,t,n){var a=e.length,r=n,o=t,i=0;if(a<2)return{min:r,max:o,mean:(t+n)/2};for(var s=0;s<a;s++){var l=e[s];r=Math.min(r,l),o=Math.max(o,l),i+=l}return{min:r,max:o,mean:i/a}}},"./tools/WwwcTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),h=n("./tools/cursors/index.js"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"Wwwc",strategies:{basicLevelingStrategy:p},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:h.wwwcCursor};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseDragCallback",value:function(e){this.applyActiveStrategy(e),m.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}},{key:"touchDragCallback",value:function(e){e.stopImmediatePropagation(),this.applyActiveStrategy(e),m.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(g.default);function p(e){var t=e.detail,n=(t.image.maxPixelValue*t.image.slope+t.image.intercept-(t.image.minPixelValue*t.image.slope+t.image.intercept))/1024,a=t.deltaPoints.page.x*n,r=t.deltaPoints.page.y*n;0===this.configuration.orientation?(t.viewport.voi.windowWidth+=a,t.viewport.voi.windowCenter+=r):(t.viewport.voi.windowWidth+=r,t.viewport.voi.windowCenter+=a),t.viewport.voiLUT=void 0}},"./tools/ZoomMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),h=n("./util/zoom/index.js"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=t.spinY,o=this.configuration,i=o.maxScale,s=o.minScale,l=o.invert?r/4:-r/4,u=Object(h.changeViewportScale)(a,l,{maxScale:i,minScale:s});m.default.cornerstone.setViewport(n,u)}}]),t}(g.default)},"./tools/ZoomTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),h=n("./util/clip.js"),v=n("./util/zoom/index.js"),p=n("./tools/cursors/index.js"),b=v.default.correctShift,y=v.default.changeViewportScale,x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"Zoom",strategies:{default:w,translate:T,zoomToCenter:E},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:p.zoomCursor};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){j.call(this,e)}},{key:"mouseDragCallback",value:function(e){j.call(this,e)}}]),t}(g.default),j=function(e){if(!e.detail.deltaPoints.page.y)return!1;this.applyActiveStrategy(e,this.configuration),m.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)};function w(e){var t=this.configuration,n=e.detail.deltaPoints.page.y,a=e.detail,r=a.element,o=a.viewport,i=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],s=i[0],l=i[1],u=i[2],d=i[3],c=y(o,t.invert?-n/100:n/100,{maxScale:t.maxScale,minScale:t.minScale});m.default.cornerstone.setViewport(r,c);var f=m.default.cornerstone.pageToPixel(r,s,l),g={x:u-f.x,y:d-f.y};g=b(g,c),o.translation.x-=g.x,o.translation.y-=g.y}function T(e){var t=this.configuration,n=t.preventZoomOutsideImage,a=e.detail.deltaPoints.page.y,r=t.invert?-a/100:a/100,o=e.detail.image,i=[e.detail.startPoints.image.x,e.detail.startPoints.image.y],s=i[0],l=i[1],u=y(e.detail.viewport,r,{maxScale:t.maxScale,minScale:t.minScale}),d={x:0,y:0},c=.01;if(r<0)u.scale<3&&(Math.abs(u.translation.x)<c?u.translation.x=0:d.x=u.translation.x/8,Math.abs(u.translation.y)<c?u.translation.y=0:d.y=u.translation.y/8);else{n&&Object(h.clipToBox)(e.detail.startPoints.image,o);var f={x:o.width/2-s,y:o.height/2-l};f=b(f,u);var m={x:u.translation.x-f.x,y:u.translation.y-f.y};Math.abs(m.x)<c?u.translation.x=f.x:d.x=m.x/8,Math.abs(m.y)<c?u.translation.y=f.y:d.y=m.y/8}u.translation.x-=d.x,u.translation.y-=d.y}function E(e){var t=this.configuration,n=e.detail.deltaPoints.page.y;y(e.detail.viewport,t.invert?-n/100:n/100,{maxScale:t.maxScale,minScale:t.minScale})}},"./tools/ZoomTouchPinchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),h=n("./util/zoom/index.js").default.correctShift,v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchPinchCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],o=r[0],i=r[1],s=r[2],l=r[3],u=this.configuration,d=u.maxScale,c=u.minScale;a.scale+=t.scaleChange*a.scale,d&&a.scale>d?a.scale=d:c&&a.scale<c&&(a.scale=c),m.default.cornerstone.setViewport(n,a);var f=m.default.cornerstone.pageToPixel(n,o,i),g={x:s-f.x,y:l-f.y};g=h(g,a),a.translation.x-=g.x,a.translation.y-=g.y,m.default.cornerstone.setViewport(n,a)}}]),t}(g.default)},"./tools/annotation/AngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return D});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./manipulators/index.js"),y=n("./drawing/index.js"),x=n("./drawing/drawLinkedTextBox.js"),j=n("./drawing/drawTextBox.js"),w=n("./drawing/drawHandles.js"),T=n("./util/lineSegDistance.js"),E=n("./util/roundToDecimal.js"),O=n("./tools/cursors/index.js"),C=n("./util/triggerEvent.js"),M=n("./events.js"),I=n("./util/getPixelSpacing.js"),S=n("./util/throttle.js"),P=n("./store/index.js"),D=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:O.angleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=l()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e.throttledUpdateCachedStats=Object(S.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&(Object(T.default)(e,t.handles.start,t.handles.middle,n)<25||Object(T.default)(e,t.handles.middle,t.handles.end,n)<25)}},{key:"updateCachedStats",value:function(e,t,n){var a=L(e,n.handles.middle,n.handles.start),r=L(e,n.handles.end,n.handles.middle),o=L(e,n.handles.end,n.handles.start),i=_(a),s=_(r),l=_(o),u=Math.acos((Math.pow(i,2)+Math.pow(s,2)-Math.pow(l,2))/(2*i*s));u*=180/Math.PI,n.rAngle=Object(E.default)(u,2),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.enabledElement,r=this.configuration,o=r.handleRadius,i=r.drawHandlesOnHover,s=r.hideHandlesIfMoving,l=r.renderDashed,u=Object(h.getToolState)(e.currentTarget,this.name),d=Object(P.getModule)("globalConfiguration").configuration.lineDash;if(u)for(var c=Object(y.getNewContext)(n.canvasContext.canvas),f=n.image,g=n.element,b=Object(I.default)(f),T=b.rowPixelSpacing,E=b.colPixelSpacing,O=v.default.getToolWidth(),C=function(e){var r=u.data[e];if(!1===r.visible)return"continue";Object(y.draw)(c,function(e){Object(y.setShadow)(e,t.configuration);var u=p.default.getColorIfActive(r),c=m.default.cornerstone.pixelToCanvas(n.element,r.handles.start),h=m.default.cornerstone.pixelToCanvas(n.element,r.handles.middle),v={color:u};l&&(v.lineDash=d),Object(y.drawJoinedLines)(e,n.element,r.handles.start,[r.handles.middle,r.handles.end],v);var b={color:u,handleRadius:o,drawHandlesIfActive:i,hideHandlesIfMoving:s};if(t.configuration.drawHandles&&Object(w.default)(e,n,r.handles,b),!0===r.invalidated&&(r.rAngle?t.throttledUpdateCachedStats(f,g,r):t.updateCachedStats(f,g,r)),r.rAngle){var C,M=function(e,t,n){var a=t&&n?"":" (isotropic)";return e.rAngle.toString()+String.fromCharCode(parseInt("00B0",16))+a}(r,T,E);if(!r.handles.textBox.hasMoved){C={x:h.x,y:h.y};var I=Object(j.textBoxWidth)(e,M,5);h.x<c.x?C.x-=15+I+10:C.x+=15;var P=m.default.cornerstone.internal.getTransform(a);P.invert();var D=P.transformPoint(C.x,C.y);r.handles.textBox.x=D.x,r.handles.textBox.y=D.y}Object(x.default)(e,n.element,r.handles.textBox,M,r.handles,S,u,O,0,!0)}})},M=0;M<u.data.length;M++)C(M);function S(e){return[e.start,e.middle,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this;if(!this.preventNewMeasurement){this.preventNewMeasurement=!0,e.preventDefault(),e.stopPropagation();var a=e.detail,r=this.createNewMeasurement(a),o=e.detail.element;Object(h.addToolState)(o,this.name,r),m.default.cornerstone.updateImage(o),Object(b.moveNewHandle)(a,this.name,r,r.handles.middle,this.options,t,function(e){if(r.active=!1,!e)return Object(h.removeToolState)(o,n.name,r),void(n.preventNewMeasurement=!1);r.handles.end.active=!0,m.default.cornerstone.updateImage(o),Object(b.moveNewHandle)(a,n.name,r,r.handles.end,n.options,t,function(e){e?(r.active=!1,m.default.cornerstone.updateImage(o)):Object(h.removeToolState)(o,n.name,r),n.preventNewMeasurement=!1,m.default.cornerstone.updateImage(o);var t={toolName:n.name,toolType:n.name,element:o,measurementData:r};Object(C.default)(o,M.default.MEASUREMENT_COMPLETED,t)})})}}}]),t}(g.default);function _(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function L(e,t,n){var a=Object(I.default)(e);return{x:(t.x-n.x)*(a.colPixelSpacing||1),y:(t.y-n.y)*(a.rowPixelSpacing||1)}}},"./tools/annotation/ArrowAnnotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return D});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),h=n("./events.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/textStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./manipulators/index.js"),x=n("./util/pointInsideBoundingBox.js"),j=n("./util/lineSegDistance.js"),w=n("./util/triggerEvent.js"),T=n("./stateManagement/toolState.js"),E=n("./drawing/drawLinkedTextBox.js"),O=n("./drawing/index.js"),C=n("./drawing/drawArrow.js"),M=n("./drawing/drawHandles.js"),I=n("./drawing/drawTextBox.js"),S=n("./tools/cursors/index.js"),P=n("./store/index.js"),D=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:_,changeTextCallback:L,drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,arrowFirst:!0,renderDashed:!1,allowEmptyLabel:!1},svgCursor:S.arrowAnnotateCursor};return(e=l()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&Object(j.default)(e,t.handles.start,t.handles.end,n)<25}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,r=n.enabledElement,o=this.configuration,i=o.handleRadius,s=o.drawHandlesOnHover,l=o.hideHandlesIfMoving,u=o.renderDashed,d=Object(T.getToolState)(a,this.name);if(d){var c,f=e.detail.canvasContext.canvas,g=Object(O.getNewContext)(f),h=v.default.getToolWidth();u&&(c=Object(P.getModule)("globalConfiguration").configuration.lineDash);for(var y=function(n){var o=d.data[n];if(!1===o.visible)return"continue";Object(O.draw)(g,function(n){Object(O.setShadow)(n,t.configuration);var u=b.default.getColorIfActive(o),d=m.default.cornerstone.pixelToCanvas(a,o.handles.start),f=m.default.cornerstone.pixelToCanvas(a,o.handles.end);t.configuration.arrowFirst?Object(C.default)(n,f,d,u,h,c):Object(C.default)(n,d,f,u,h,c);var g={color:u,handleRadius:i,drawHandlesIfActive:s,hideHandlesIfMoving:l};t.configuration.drawHandles&&Object(M.default)(n,e.detail,o.handles,g);var v=function(e){return e.text}(o);if(v&&""!==v){var y=Object(I.textBoxWidth)(n,v,5),x=p.default.getFontSize()+10,w=Math.max(y,x)/2+5;if(f.x<d.x&&(w=-w),!o.handles.textBox.hasMoved){var T;T=t.configuration.arrowFirst?{x:f.x-y/2+w,y:f.y-x/2}:{x:d.x-y/2-w,y:d.y-x/2};var S=m.default.cornerstone.internal.getTransform(r);S.invert();var P=S.transformPoint(T.x,T.y);o.handles.textBox.x=P.x,o.handles.textBox.y=P.y}Object(E.default)(n,a,o.handles.textBox,v,o.handles,j,u,h,0,!1)}})},x=0;x<d.data.length;x++)y(x)}function j(e){return[e.start,{x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2},e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this,a=e.detail.element,r=this.createNewMeasurement(e),o=this.configuration.allowEmptyLabel;Object(T.addToolState)(a,this.name,r),m.default.cornerstone.updateImage(a),Object(y.moveNewHandle)(e.detail,this.name,r,r.handles.end,this.options,t,function(t){t?void 0===r.text&&n.configuration.getTextCallback(function(e){if(e||o){r.text=e,r.active=!1;var t={toolName:n.name,toolType:n.name,element:a,measurementData:r};m.default.cornerstone.updateImage(a),Object(w.default)(a,h.default.MEASUREMENT_COMPLETED,t)}else Object(T.removeToolState)(a,n.name,r)},e.detail):Object(T.removeToolState)(a,n.name,r),m.default.cornerstone.updateImage(a)})}},{key:"doubleClickCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"touchPressCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"_updateTextForNearbyAnnotation",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.canvas,a=Object(T.getToolState)(t,this.name);if(!a)return!1;for(var r=0;r<a.data.length;r++){var o=a.data[r];if(this.pointNearTool(t,o,n)||Object(x.default)(o.handles.textBox,n))return o.active=!0,m.default.cornerstone.updateImage(t),this.configuration.changeTextCallback(o,e.detail,this._doneChangingTextCallback.bind(this,t,o)),e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),!0}}},{key:"_doneChangingTextCallback",value:function(e,t,n,a){!0===a?Object(T.removeToolState)(e,this.name,t):t.text=n,t.active=!1,m.default.cornerstone.updateImage(e),Object(w.default)(e,h.default.MEASUREMENT_MODIFIED,{toolName:this.name,toolType:this.name,element:e,measurementData:t})}}]),t}(g.default);function _(e){e(prompt("Enter your annotation:"))}function L(e,t,n){n(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return S});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./tools/base/BaseAnnotationTool.js"),v=n("./tools/annotation/bidirectionalTool/createNewMeasurement.js"),p=n("./tools/annotation/bidirectionalTool/pointNearTool.js"),b=n("./tools/annotation/bidirectionalTool/renderToolData.js"),y=n("./tools/annotation/bidirectionalTool/addNewMeasurement.js"),x=n("./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),j=n("./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),w=n("./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),T=n("./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),E=n("./tools/cursors/index.js"),O=n("./util/throttle.js"),C=n("./util/getPixelSpacing.js"),M=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),I=function(e,t,n){return n()},S=function(e){function t(e){var n;r()(this,t);var a={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:I,getMeasurementLocationCallback:I,textBox:"",shadow:"",drawHandles:!0,drawHandlesOnHover:!0,hideHandlesIfMoving:!1,renderDashed:!1,additionalData:[]},svgCursor:E.bidirectionalCursor};return(n=l()(this,d()(t).call(this,e,a))).throttledUpdateCachedStats=Object(O.default)(n.updateCachedStats,110),n.createNewMeasurement=v.default.bind(f()(n)),n.pointNearTool=p.default.bind(f()(n)),n.renderToolData=b.default.bind(f()(n)),n.addNewMeasurement=y.default.bind(f()(n)),n._moveCallback=x.default.bind(f()(n)),n.handleSelectedCallback=j.default.bind(f()(n)),n.handleSelectedMouseCallback=w.default.bind(f()(n)),n.handleSelectedTouchCallback=T.default.bind(f()(n)),n}return g()(t,e),i()(t,[{key:"updateCachedStats",value:function(e,t,n){if(n.toolName===this.name){var a=Object(C.default)(e),r=Object(M.default)(n,a),o=r.shortestDiameter;n.longestDiameter=r.longestDiameter,n.shortestDiameter=o,n.invalidated=!1}}}]),t}(h.default)},"./tools/annotation/CircleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return P});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./store/index.js"),y=n("./drawing/index.js"),x=n("./util/calculateSUV.js"),j=n("./util/ellipse/index.js"),w=n("./util/getROITextBoxCoords.js"),T=n("./util/numbersWithCommas.js"),E=n("./util/throttle.js"),O=n("./util/logger.js"),C=n("./util/getPixelSpacing.js"),M=n("./tools/cursors/index.js"),I=n("./util/getCircleCoords.js"),S=Object(O.getLogger)("tools:annotation:CircleRoiTool"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"CircleRoi",supportedInteractionTypes:["Mouse","Touch"],svgCursor:M.circleRoiCursor,configuration:{renderDashed:!1,hideHandlesIfMoving:!1}};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(E.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};S.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end,o=m.default.cornerstoneMath.point.distance;if(r||S.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;var i="mouse"===a?15:25,s=m.default.cornerstone.pixelToCanvas(e,t.handles.start),l=m.default.cornerstone.pixelToCanvas(e,t.handles.end),u=o(s,n),d=o(s,l);return u>d-i/2&&u<d+i/2}},{key:"updateCachedStats",value:function(e,t,n){var a=(m.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,r=Object(C.default)(e),o=function(e,t,n,a,r){var o,i=Object(I.default)(n.start,n.end),s=m.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),l=Object(j.calculateEllipseStatistics)(s,i);return"PT"===a&&(o={mean:Object(x.default)(e,l.mean,!0)||0,stdDev:Object(x.default)(e,l.stdDev,!0)||0}),{area:Math.PI*(i.width*(r.colPixelSpacing||1)/2)*(i.height*(r.rowPixelSpacing||1)/2)||0,count:l.count||0,mean:l.mean||0,variance:l.variance||0,stdDev:l.stdDev||0,min:l.min||0,max:l.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(h.getToolState)(e.currentTarget,this.name);if(n){var a=m.default.cornerstoneMath.point.distance,r=e.detail,o=r.image,i=r.element,s=r.canvasContext,l=v.default.getToolWidth(),u=this.configuration,d=u.handleRadius,c=u.drawHandlesOnHover,f=u.hideHandlesIfMoving,g=u.renderDashed,x=Object(y.getNewContext)(s.canvas),j=Object(C.default)(o),T=j.rowPixelSpacing,E=j.colPixelSpacing,O=Object(b.getModule)("globalConfiguration").configuration.lineDash,M=(m.default.cornerstone.metaData.get("generalSeriesModule",o.imageId)||{}).modality,S=T&&E;Object(y.draw)(x,function(e){for(var s=0;s<n.data.length;s++){var u=n.data[s];if(!1!==u.visible){var h=p.default.getColorIfActive(u),v={color:h,handleRadius:d,drawHandlesIfActive:c,hideHandlesIfMoving:f};Object(y.setShadow)(e,t.configuration);var b=m.default.cornerstone.pixelToCanvas(i,u.handles.start),x=m.default.cornerstone.pixelToCanvas(i,u.handles.end),j=a(b,x),T={color:h};if(g&&(T.lineDash=O),Object(y.drawCircle)(e,i,u.handles.start,j,T,"pixel"),Object(y.drawHandles)(e,r,u.handles,v),!0===u.invalidated&&(u.cachedStats?t.throttledUpdateCachedStats(o,i,u):t.updateCachedStats(o,i,u)),!u.handles.textBox.hasMoved){var E=Object(w.default)(r.viewport,u.handles);Object.assign(u.handles.textBox,E)}var C=_(e,o.color,u.cachedStats,M,S,t.configuration);u.unit=D(M,t.configuration.showHounsfieldUnits),Object(y.drawLinkedTextBox)(e,i,u.handles.textBox,C,u.handles,function(e){return t=e.start,n=e.end,[{x:(r=(a=Object(I.default)(t,n)).left)+(i=a.width)/2,y:o=a.top},{x:r,y:o+(s=a.height)/2},{x:r+i/2,y:o+s},{x:r+i,y:o+s/2}];var t,n,a,r,o,i,s},h,l,10,!0)}}})}}}]),t}(g.default);function D(e,t){return"CT"===e&&!1!==t?"HU":""}function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.area,r=n.mean,o=n.stdDev,i=n.min,s=n.max,l=n.meanStdDevSUV,u=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,m=[],g=[];if(!t){var h=l&&0!==l.mean,v=D(u,c.showHounsfieldUnits),p="Mean: ".concat(Object(T.default)(r.toFixed(2))," ").concat(v),b="Std Dev: ".concat(Object(T.default)(o.toFixed(2))," ").concat(v);if(h){for(var y=" SUV: ",x="".concat(y).concat(Object(T.default)(l.mean.toFixed(2))),j="".concat(y).concat(Object(T.default)(l.stdDev.toFixed(2))),w=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(p).width<w;)p+=" ";g.push("".concat(p).concat(x)),g.push("".concat(b,"     ").concat(j))}else g.push("".concat(p,"     ").concat(b));if(f){for(var E="Min: ".concat(i," ").concat(v),O="Max: ".concat(s," ").concat(v),C=h?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(p,"     ")).width);e.measureText(E).width<C;)E+=" ";g.push("".concat(E).concat(O))}}return m.push(L(a,d)),g.forEach(function(e){return m.push(e)}),m}function L(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(T.default)(e.toFixed(2))).concat(n)}},"./tools/annotation/CobbAngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return D});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/textStyle.js"),v=n("./stateManagement/toolState.js"),p=n("./stateManagement/toolStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./manipulators/index.js"),x=n("./drawing/index.js"),j=n("./drawing/drawHandles.js"),w=n("./drawing/drawLinkedTextBox.js"),T=n("./util/lineSegDistance.js"),E=n("./util/roundToDecimal.js"),O=n("./events.js"),C=n("./tools/cursors/index.js"),M=n("./util/triggerEvent.js"),I=n("./util/throttle.js"),S=n("./util/getPixelSpacing.js"),P=n("./store/index.js"),D=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:C.cobbAngleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=l()(this,d()(t).call(this,n,a))).hasIncomplete=!1,e.throttledUpdateCachedStats=Object(I.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return this.hasIncomplete=!0,{visible:!0,active:!0,color:void 0,invalidated:!0,complete:!1,value:"",handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:e.currentPoints.image.x+1,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&!this.hasIncomplete&&(Object(T.default)(e,t.handles.start,t.handles.end,n)<25||Object(T.default)(e,t.handles.start2,t.handles.end2,n)<25)}},{key:"updateCachedStats",value:function(e,t,n){var a=Object(S.default)(e),r=a.rowPixelSpacing,o=a.colPixelSpacing,i=(Math.ceil(n.handles.start.x)-Math.ceil(n.handles.end.x))*(o||1),s=(Math.ceil(n.handles.start.y)-Math.ceil(n.handles.end.y))*(r||1),l=(Math.ceil(n.handles.start2.x)-Math.ceil(n.handles.end2.x))*(o||1),u=(Math.ceil(n.handles.start2.y)-Math.ceil(n.handles.end2.y))*(r||1),d=Math.acos(Math.abs((i*l+s*u)/(Math.sqrt(i*i+s*s)*Math.sqrt(l*l+u*u))));d*=180/Math.PI,n.rAngle=Object(E.default)(d,2),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.drawHandlesOnHover,i=a.hideHandlesIfMoving,s=a.renderDashed,l=Object(v.getToolState)(e.currentTarget,this.name);if(l)for(var u=Object(x.getNewContext)(n.canvasContext.canvas),d=p.default.getToolWidth(),c=Object(P.getModule)("globalConfiguration").configuration.lineDash,f=h.default.getFont(),m=function(e){var a=l.data[e];if(!1===a.visible)return"continue";Object(x.draw)(u,function(e){Object(x.setShadow)(e,t.configuration);var l=b.default.getColorIfActive(a),u={color:l};s&&(u.lineDash=c),Object(x.drawLine)(e,n.element,a.handles.start,a.handles.end,u),a.complete&&Object(x.drawLine)(e,n.element,a.handles.start2,a.handles.end2,u);var m={color:l,handleRadius:r,drawHandlesIfActive:o,hideHandlesIfMoving:i};t.configuration.drawHandles&&Object(j.default)(e,n,a.handles,m),e.fillStyle=l;var g=a.value;if(!a.handles.textBox.hasMoved){var h={x:(a.handles.start.x+a.handles.end.x)/2,y:(a.handles.start.y+a.handles.end.y)/2-10};e.font=f,a.handles.textBox.x=h.x,a.handles.textBox.y=h.y}Object(w.default)(e,n.element,a.handles.textBox,g,a.handles,y,l,d,0,!0)})},g=0;g<l.data.length;g++)m(g);function y(e){return[e.start,e.start2,e.end,e.end2]}}},{key:"getIncomplete",value:function(e){var t=Object(v.getToolState)(e,this.name);if(t&&Array.isArray(t.data))return t.data.find(function(e){return!1===e.complete})}},{key:"addNewMeasurement",value:function(e,t){var n=this;e.preventDefault(),e.stopPropagation();var a,r,o=e.detail,i=function(e){e||Object(v.removeToolState)(s,n.name,a)},s=e.detail.element,l=this.getIncomplete(s);l?((a=l).complete=!0,a.handles.start2={x:o.currentPoints.image.x,y:o.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1},a.handles.end2={x:o.currentPoints.image.x,y:o.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0},r=a.handles.end2,this.hasIncomplete=!1,i=function(e){if(e){var t=O.default.MEASUREMENT_COMPLETED,r={toolName:n.name,toolType:n.name,element:s,measurementData:a};Object(M.default)(s,t,r)}else Object(v.removeToolState)(s,n.name,a)}):(a=this.createNewMeasurement(o),Object(v.addToolState)(s,this.name,a),r=a.handles.end),m.default.cornerstone.updateImage(s),Object(y.moveNewHandle)(o,this.name,a,r,this.options,t,i)}},{key:"onMeasureModified",value:function(e){var t=e.detail.element,n=m.default.cornerstone.getEnabledElement(t).image,a=Object(S.default)(n),r=a.rowPixelSpacing,o=a.colPixelSpacing;if(e.detail.toolName===this.name){var i=e.detail.measurementData;!0===i.invalidated&&(i.rAngle?this.throttledUpdateCachedStats(n,t,i):this.updateCachedStats(n,t,i));var s=i.rAngle;i.value="",Number.isNaN(s)||(i.value=function(e,t,n){var a=t&&n?"":" (isotropic)";return e.toString()+String.fromCharCode(parseInt("00B0",16))+a}(s,r,o))}}},{key:"activeCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function(e){e.removeEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function(e){e.removeEventListener(O.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}}]),t}(g.default)},"./tools/annotation/EllipticalRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return P});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./manipulators/getHandleNearImagePoint.js"),y=n("./drawing/index.js"),x=n("./util/calculateSUV.js"),j=n("./util/ellipse/index.js"),w=n("./util/getROITextBoxCoords.js"),T=n("./util/numbersWithCommas.js"),E=n("./util/throttle.js"),O=n("./tools/cursors/index.js"),C=n("./util/logger.js"),M=n("./util/getPixelSpacing.js"),I=n("./store/index.js"),S=Object(C.getLogger)("tools:annotation:EllipticalRoiTool"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:O.ellipticalRoiCursor};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(E.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};S.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end;if(r||S.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;if(Object(b.default)(e,t.handles,n,6))return!0;var o="mouse"===a?15:25,i=m.default.cornerstone.pixelToCanvas(e,t.handles.start),s=m.default.cornerstone.pixelToCanvas(e,t.handles.end),l={left:Math.min(i.x,s.x)+o/2,top:Math.min(i.y,s.y)+o/2,width:Math.abs(i.x-s.x)-o,height:Math.abs(i.y-s.y)-o},u={left:Math.min(i.x,s.x)-o/2,top:Math.min(i.y,s.y)-o/2,width:Math.abs(i.x-s.x)+o,height:Math.abs(i.y-s.y)+o},d=Object(j.pointInEllipse)(l,n);return!(!Object(j.pointInEllipse)(u,n)||d)}},{key:"updateCachedStats",value:function(e,t,n){var a=(m.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,r=Object(M.default)(e),o=function(e,t,n,a,r){var o,i=k(n.start,n.end),s=m.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),l=Object(j.calculateEllipseStatistics)(s,i);return"PT"===a&&(o={mean:Object(x.default)(e,l.mean,!0)||0,stdDev:Object(x.default)(e,l.stdDev,!0)||0}),{area:Math.PI*(i.width*(r.colPixelSpacing||1)/2)*(i.height*(r.rowPixelSpacing||1)/2)||0,count:l.count||0,mean:l.mean||0,variance:l.variance||0,stdDev:l.stdDev||0,min:l.min||0,max:l.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(h.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,r=a.image,o=a.element,i=v.default.getToolWidth(),s=Object(I.getModule)("globalConfiguration").configuration.lineDash,l=this.configuration,u=l.handleRadius,d=l.drawHandlesOnHover,c=l.hideHandlesIfMoving,f=l.renderDashed,g=Object(y.getNewContext)(a.canvasContext.canvas),b=Object(M.default)(r),x=b.rowPixelSpacing,j=b.colPixelSpacing,T=(m.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,E=x&&j;Object(y.draw)(g,function(e){for(var l=0;l<n.data.length;l++){var m=n.data[l];if(!1!==m.visible){var g=p.default.getColorIfActive(m),h={color:g,handleRadius:u,drawHandlesIfActive:d,hideHandlesIfMoving:c};Object(y.setShadow)(e,t.configuration);var v={color:g};if(f&&(v.lineDash=s),Object(y.drawEllipse)(e,o,m.handles.start,m.handles.end,v,"pixel",m.handles.initialRotation),Object(y.drawHandles)(e,a,m.handles,h),!0===m.invalidated&&(m.cachedStats?t.throttledUpdateCachedStats(r,o,m):t.updateCachedStats(r,o,m)),!m.handles.textBox.hasMoved){var b=Object(w.default)(a.viewport,m.handles);Object.assign(m.handles.textBox,b)}var x=_(e,r.color,m.cachedStats,T,E,t.configuration);m.unit=D(T,t.configuration.showHounsfieldUnits),Object(y.drawLinkedTextBox)(e,o,m.handles.textBox,x,m.handles,function(e){return[{x:(n=(t=k(e.start,e.end)).left)+(r=t.width)/2,y:a=t.top},{x:n,y:a+(o=t.height)/2},{x:n+r/2,y:a+o},{x:n+r,y:a+o/2}];var t,n,a,r,o},g,i,10,!0)}}})}}}]),t}(g.default);function D(e,t){return"CT"===e&&!1!==t?"HU":""}function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.area,r=n.mean,o=n.stdDev,i=n.min,s=n.max,l=n.meanStdDevSUV,u=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,m=[],g=[];if(!t){var h=l&&0!==l.mean,v=D(u,c.showHounsfieldUnits),p="Mean: ".concat(Object(T.default)(r.toFixed(2))," ").concat(v),b="Std Dev: ".concat(Object(T.default)(o.toFixed(2))," ").concat(v);if(h){for(var y=" SUV: ",x="".concat(y).concat(Object(T.default)(l.mean.toFixed(2))),j="".concat(y).concat(Object(T.default)(l.stdDev.toFixed(2))),w=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(p).width<w;)p+=" ";g.push("".concat(p).concat(x)),g.push("".concat(b,"     ").concat(j))}else g.push("".concat(p)),g.push("".concat(b));if(f){for(var E="Min: ".concat(i," ").concat(v),O="Max: ".concat(s," ").concat(v),C=h?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(p,"     ")).width);e.measureText(E).width<C;)E+=" ";g.push("".concat(E).concat(O))}}return m.push(L(a,d)),g.forEach(function(e){return m.push(e)}),m}function L(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(T.default)(e.toFixed(2))).concat(n)}function k(e,t){return{left:Math.round(Math.min(e.x,t.x)),top:Math.round(Math.min(e.y,t.y)),width:Math.round(Math.abs(e.x-t.x)),height:Math.round(Math.abs(e.y-t.y))}}},"./tools/annotation/FreehandRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return z});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./events.js"),v=n("./externalModules.js"),p=n("./tools/base/BaseAnnotationTool.js"),b=n("./stateManagement/toolState.js"),y=n("./stateManagement/toolStyle.js"),x=n("./stateManagement/toolColors.js"),j=n("./store/index.js"),w=n("./util/triggerEvent.js"),T=n("./util/findAndMoveHelpers.js"),E=n("./util/pointInsideBoundingBox.js"),O=n("./util/calculateSUV.js"),C=n("./util/numbersWithCommas.js"),M=n("./util/getPixelSpacing.js"),I=n("./drawing/index.js"),S=n("./drawing/drawLinkedTextBox.js"),P=n("./drawing/drawHandles.js"),D=n("./util/clip.js"),_=n("./store/setToolCursor.js"),L=n("./tools/cursors/index.js"),k=n("./util/freehand/index.js"),A=n("./util/logger.js"),R=n("./util/throttle.js"),B=Object(A.getLogger)("tools:annotation:FreehandRoiTool"),H=k.default.insertOrDelete,F=k.default.freehandArea,U=k.default.calculateFreehandStatistics,N=k.default.freehandIntersect,V=k.default.FreehandHandleData,z=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1,drawHandles:!0,renderDashed:!1},svgCursor:L.freehandRoiCursor};return(e=l()(this,d()(t).call(this,n,a))).isMultiPartTool=!0,e._drawing=!1,e._dragging=!1,e._modifying=!1,e._drawingMouseDownCallback=e._drawingMouseDownCallback.bind(f()(e)),e._drawingMouseMoveCallback=e._drawingMouseMoveCallback.bind(f()(e)),e._drawingMouseDragCallback=e._drawingMouseDragCallback.bind(f()(e)),e._drawingMouseUpCallback=e._drawingMouseUpCallback.bind(f()(e)),e._drawingMouseDoubleClickCallback=e._drawingMouseDoubleClickCallback.bind(f()(e)),e._editMouseUpCallback=e._editMouseUpCallback.bind(f()(e)),e._editMouseDragCallback=e._editMouseDragCallback.bind(f()(e)),e._drawingTouchStartCallback=e._drawingTouchStartCallback.bind(f()(e)),e._drawingTouchDragCallback=e._drawingTouchDragCallback.bind(f()(e)),e._drawingDoubleTapClickCallback=e._drawingDoubleTapClickCallback.bind(f()(e)),e._editTouchDragCallback=e._editTouchDragCallback.bind(f()(e)),e.throttledUpdateCachedStats=Object(R.default)(e.updateCachedStats,110),e}return g()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};return t.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0},t}B.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.points;if(!a)throw new Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));return!(!a||!1===t.visible)&&void 0!==this._pointNearHandle(e,t,n)}},{key:"distanceFromPoint",value:function(e,t,n){for(var a=1/0,r=0;r<t.handles.points.length;r++){var o=v.default.cornerstoneMath.point.distance(t.handles.points[r],n);a=Math.min(a,o)}return a===1/0?-1:a}},{key:"distanceFromPointCanvas",value:function(e,t,n){var a=1/0;if(!t)return-1;for(var r=v.default.cornerstone.pixelToCanvas(e,n),o=t.handles.points,i=0;i<o.length;i++){var s=v.default.cornerstone.pixelToCanvas(e,o[i]),l=v.default.cornerstoneMath.point.distance(s,r);a=Math.min(a,l)}return a===1/0?-1:a}},{key:"updateCachedStats",value:function(e,t,n){for(var a,r,o=v.default.cornerstone.metaData.get("generalSeriesModule",e.imageId),i=o?o.modality:null,s=n.handles.points,l={left:s[0].x,right:s[0].x,bottom:s[0].y,top:s[0].x},u=0;u<s.length;u++)l.left=Math.min(l.left,s[u].x),l.right=Math.max(l.right,s[u].x),l.bottom=Math.min(l.bottom,s[u].y),l.top=Math.max(l.top,s[u].y);var d={left:l.left,top:l.bottom,width:Math.abs(l.right-l.left),height:Math.abs(l.top-l.bottom)};if(n.polyBoundingBox=d,!e.color){var c=v.default.cornerstone.getPixels(t,d.left,d.top,d.width,d.height);a=U.call(this,c,d,n.handles.points),"PT"===i&&(r={mean:Object(O.default)(e,(a.mean-e.intercept)/e.slope),stdDev:Object(O.default)(e,(a.stdDev-e.intercept)/e.slope)}),a&&!isNaN(a.mean)&&(n.meanStdDev=a,n.meanStdDevSUV=r)}var f=Object(M.default)(e),m=F(n.handles.points,(f.colPixelSpacing||1)*(f.rowPixelSpacing||1));isNaN(m)||(n.area=m),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=Object(b.getToolState)(e.currentTarget,this.name);if(a)for(var r=n.image,o=n.element,i=this.configuration,s=v.default.cornerstone.metaData.get("generalSeriesModule",r.imageId),l=s?s.modality:null,u=Object(I.getNewContext)(n.canvasContext.canvas),d=y.default.getToolWidth(),c=i.renderDashed,f=Object(j.getModule)("globalConfiguration").configuration.lineDash,m=function(e){var s=a.data[e];if(!1===s.visible)return"continue";Object(I.draw)(u,function(e){var a,l=x.default.getColorIfActive(s);s.active?s.handles.invalidHandlePlacement?(l=i.invalidColor,a=i.invalidColor):(l=x.default.getColorIfActive(s),a=x.default.getFillColor()):a=x.default.getToolColor();var u={color:l};if(c&&(u.lineDash=f),s.handles.points.length){var m=s.handles.points;Object(I.drawJoinedLines)(e,o,m[0],m,u),s.polyBoundingBox?Object(I.drawJoinedLines)(e,o,m[m.length-1],[m[0]],u):Object(I.drawJoinedLines)(e,o,m[m.length-1],[i.mouseLocation.handles.start],u)}if(u={color:l,fill:a},(i.alwaysShowHandles||s.active&&s.polyBoundingBox)&&(u.handleRadius=i.activeHandleRadius,t.configuration.drawHandles&&Object(P.default)(e,n,s.handles.points,u)),s.canComplete){u.handleRadius=i.completeHandleRadius;var g=s.handles.points[0];t.configuration.drawHandles&&Object(P.default)(e,n,[g],u)}if(s.active&&!s.polyBoundingBox){u.handleRadius=i.activeHandleRadius,t.configuration.drawHandles&&Object(P.default)(e,n,i.mouseLocation.handles,u);var v=s.handles.points[0];t.configuration.drawHandles&&Object(P.default)(e,n,[v],u)}if(!0!==s.invalidated||s.active||(s.meanStdDev&&s.meanStdDevSUV&&s.area?t.throttledUpdateCachedStats(r,o,s):t.updateCachedStats(r,o,s)),s.polyBoundingBox&&!s.handles.textBox.freehand){s.handles.textBox.hasMoved||(s.handles.textBox.x=s.polyBoundingBox.left+s.polyBoundingBox.width,s.handles.textBox.y=s.polyBoundingBox.top+s.polyBoundingBox.height/2);var b=h.call(t,s);Object(S.default)(e,o,s.handles.textBox,b,s.handles.points,p,l,d,0,!0)}})},g=0;g<a.data.length;g++)m(g);function h(e){var t=e.meanStdDev,n=e.meanStdDevSUV,a=e.area,o=[];if(t&&void 0!==t.mean){var i="";"CT"===l&&(i="HU"),e.unit=i;var s="Mean: ".concat(Object(C.default)(t.mean.toFixed(2))," ").concat(i),u="StdDev: ".concat(Object(C.default)(t.stdDev.toFixed(2))," ").concat(i);if(n&&void 0!==n.mean){var d=" SUV: ";s+=d+Object(C.default)(n.mean.toFixed(2)),u+=d+Object(C.default)(n.stdDev.toFixed(2))}o.push(s),o.push(u)}if(a){var c=" mm".concat(String.fromCharCode(178)),f=Object(M.default)(r);f.rowPixelSpacing&&f.colPixelSpacing||(c=" pixels".concat(String.fromCharCode(178)));var m="Area: ".concat(Object(C.default)(a.toFixed(2))).concat(c);o.push(m)}return o}function p(e){return e}}},{key:"addNewMeasurement",value:function(e){var t=e.detail;this._startDrawing(e),this._addPoint(t),q(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=this._pointNearHandleAllTools(t);return!!t.event.ctrlKey&&(void 0!==n&&n.handleNearby.hasBoundingBox||H.call(this,e,n),q(e),!0)}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",r=e.detail.element,o=Object(b.getToolState)(r,this.name);if(n.hasBoundingBox)Object(T.moveHandleNearImagePoint)(e,this,t,n,a);else{var i=this.configuration;i.dragOrigin={x:n.x,y:n.y};for(var s=0;s<o.data.length;s++)for(var l=o.data[s].handles.points,u=0;u<l.length;u++)l[u]===n&&(i.currentHandle=u,i.currentTool=s);this._modifying=!0,this._activateModify(r),q(e)}}},{key:"_drawingMouseMoveCallback",value:function(e){var t=e.detail,n=t.currentPoints,a=t.element,r=Object(b.getToolState)(a,this.name),o=this.configuration,i=r.data[o.currentTool],s=n.canvas;this._getMouseLocation(t),this._checkInvalidHandleLocation(i,t);var l=this._pointNearHandle(a,i,s),u=i.handles.points;void 0!==l&&!l.hasBoundingBox&&l<u.length-1&&(o.mouseLocation.handles.start.x=u[l].x,o.mouseLocation.handles.start.y=u[l].y),v.default.cornerstone.updateImage(a)}},{key:"_drawingMouseDragCallback",value:function(e){this.options.mouseButtonMask.includes(e.detail.buttons)&&this._drawingDrag(e)}},{key:"_drawingTouchDragCallback",value:function(e){this._drawingDrag(e)}},{key:"_drawingDrag",value:function(e){var t=e.detail,n=t.element,a=Object(b.getToolState)(n,this.name).data[this.configuration.currentTool];this._getMouseLocation(t),this._checkInvalidHandleLocation(a,t),this._addPointPencilMode(t,a.handles.points),this._dragging=!0,v.default.cornerstone.updateImage(n)}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail.element;if(this._dragging){this._dragging=!1;var n=this.configuration,a=n.currentTool,r=Object(b.getToolState)(t,this.name).data[a];!N.end(r.handles.points)&&r.canComplete&&this._endDrawing(t,n.currentHandle),q(e)}}},{key:"_drawingMouseDownCallback",value:function(e){var t=e.detail,n=t.currentPoints,a=t.element;if(this.options.mouseButtonMask.includes(t.buttons)){var r=n.canvas,o=this.configuration,i=o.currentTool,s=Object(b.getToolState)(a,this.name).data[i],l=this._pointNearHandle(a,s,r);!N.end(s.handles.points)&&s.canComplete?this._endDrawing(a,o.currentHandle):void 0===l&&this._addPoint(t),q(e)}}},{key:"_drawingTouchStartCallback",value:function(e){var t=e.detail,n=t.element,a=t.currentPoints.canvas,r=this.configuration,o=r.currentTool,i=Object(b.getToolState)(n,this.name).data[o],s=this._pointNearHandle(n,i,a);!N.end(i.handles.points)&&i.canComplete?this._endDrawing(n,r.currentHandle):void 0===s&&this._addPoint(t),q(e)}},{key:"completeDrawing",value:function(e){if(this._drawing){var t=Object(b.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];if(!N.end(a.handles.points)&&a.handles.points.length>=2){var r=n.currentHandle;a.polyBoundingBox={},this._endDrawing(e,r)}}}},{key:"_drawingMouseDoubleClickCallback",value:function(e){this.completeDrawing(e.detail.element),q(e)}},{key:"_drawingDoubleTapClickCallback",value:function(e){this.completeDrawing(e.detail.element),q(e)}},{key:"_editMouseDragCallback",value:function(e){var t=e.detail,n=t.element;if(this.options.mouseButtonMask.includes(t.buttons)){var a,r=Object(b.getToolState)(n,this.name),o=this.configuration,i=r.data[o.currentTool],s=o.currentHandle,l=i.handles.points;if(this._getMouseLocation(t),i.handles.invalidHandlePlacement=N.modify(l,s),i.active=!0,i.highlight=!0,l[s].x=o.mouseLocation.handles.start.x,l[s].y=o.mouseLocation.handles.start.y,a=this._getPrevHandleIndex(s,l),s>=0){var u=l[a].lines[l[a].lines.length-1];u.x=o.mouseLocation.handles.start.x,u.y=o.mouseLocation.handles.start.y}v.default.cornerstone.updateImage(n)}}},{key:"_editTouchDragCallback",value:function(e){var t,n=e.detail,a=n.element,r=Object(b.getToolState)(a,this.name),o=this.configuration,i=r.data[o.currentTool],s=o.currentHandle,l=i.handles.points;if(this._getMouseLocation(n),i.handles.invalidHandlePlacement=N.modify(l,s),i.active=!0,i.highlight=!0,l[s].x=o.mouseLocation.handles.start.x,l[s].y=o.mouseLocation.handles.start.y,t=this._getPrevHandleIndex(s,l),s>=0){var u=l[t].lines[l[t].lines.length-1];u.x=o.mouseLocation.handles.start.x,u.y=o.mouseLocation.handles.start.y}v.default.cornerstone.updateImage(a)}},{key:"_getPrevHandleIndex",value:function(e,t){return 0===e?t.length-1:e-1}},{key:"_editMouseUpCallback",value:function(e){var t=e.detail,n=t.element,a=Object(b.getToolState)(n,this.name);this._deactivateModify(n),this._dropHandle(t,a),this._endDrawing(n),v.default.cornerstone.updateImage(n)}},{key:"_dropHandle",value:function(e,t){var n=this.configuration,a=t.data[n.currentTool].handles,r=a.points;if(a.invalidHandlePlacement){var o,i=n.currentHandle,s=r[i];o=0===i?r[r.length-1]:r[i-1],s.x=n.dragOrigin.x,s.y=n.dragOrigin.y,o.lines[0]=s,a.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function(e){var t,n=e.detail,a=this.createNewMeasurement(n),r=n.element,o=this.configuration;e.type===h.default.MOUSE_DOWN_ACTIVATE?t="Mouse":e.type===h.default.TOUCH_START_ACTIVE&&(t="Touch"),this._activateDraw(r,t),this._getMouseLocation(n),Object(b.addToolState)(r,this.name,a);var i=Object(b.getToolState)(r,this.name);o.currentTool=i.data.length-1,this._activeDrawingToolReference=i.data[o.currentTool]}},{key:"_addPoint",value:function(e){var t=e.currentPoints,n=e.element,a=Object(b.getToolState)(n,this.name),r=this.configuration,o=a.data[r.currentTool];if(!o.handles.invalidHandlePlacement){var i=new V(t.image);o.handles.points.length&&o.handles.points[r.currentHandle-1].lines.push(t.image),o.handles.points.push(i),r.currentHandle+=1,v.default.cornerstone.updateImage(n),this.fireModifiedEvent(n,o)}}},{key:"_addPointPencilMode",value:function(e,t){var n=this,a=e.element,r=this.configuration.mouseLocation.handles.start;t.every(function(e){return n._isDistanceLargerThanSpacing(a,e,r)})&&this._addPoint(e)}},{key:"_endDrawing",value:function(e,t){var n=Object(b.getToolState)(e,this.name),a=this.configuration,r=n.data[a.currentTool];if(r.active=!1,r.highlight=!1,r.handles.invalidHandlePlacement=!1,void 0!==t){var o=r.handles.points;o[a.currentHandle-1].lines.push(o[0])}this._modifying&&(this._modifying=!1,r.invalidated=!0),a.currentHandle=0,a.currentTool=-1,r.canComplete=!1,this._drawing&&this._deactivateDraw(e),v.default.cornerstone.updateImage(e),this.fireModifiedEvent(e,r),this.fireCompletedEvent(e,r)}},{key:"_pointNearHandle",value:function(e,t,n){if(void 0!==t.handles&&void 0!==t.handles.points&&!1!==t.visible){for(var a=0;a<t.handles.points.length;a++){var r=v.default.cornerstone.pixelToCanvas(e,t.handles.points[a]);if(v.default.cornerstoneMath.point.distance(r,n)<6)return a}return t.handles.textBox&&Object(E.default)(t.handles.textBox,n)?t.handles.textBox:void 0}}},{key:"_pointNearHandleAllTools",value:function(e){var t=e.element,n=e.currentPoints.canvas,a=Object(b.getToolState)(t,this.name);if(a)for(var r,o=0;o<a.data.length;o++)if(void 0!==(r=this._pointNearHandle(t,a.data[o],n)))return{handleNearby:r,toolIndex:o}}},{key:"_getMouseLocation",value:function(e){var t=e.currentPoints,n=e.image,a=this.configuration;a.mouseLocation.handles.start.x=t.image.x,a.mouseLocation.handles.start.y=t.image.y,Object(D.clipToBox)(a.mouseLocation.handles.start,n)}},{key:"_checkInvalidHandleLocation",value:function(e,t){if(e.handles.points.length<2)return!0;var n;n=this._dragging?this._checkHandlesPencilMode(e,t):this._checkHandlesPolygonMode(e,t),e.handles.invalidHandlePlacement=n}},{key:"_checkHandlesPolygonMode",value:function(e,t){var n=t.element,a=this.configuration.mouseLocation.handles.start,r=e.handles.points,o=!1;return e.canComplete=!1,this._isDistanceSmallerThanCompleteSpacingCanvas(n,r[0],a)&&!N.end(r)&&r.length>2?(e.canComplete=!0,o=!1):o=N.newHandle(a,r),o}},{key:"_checkHandlesPencilMode",value:function(e,t){var n=N.newHandle(this.configuration.mouseLocation.handles.start,e.handles.points);return!1===n&&(n=this._invalidHandlePencilMode(e,t)),n}},{key:"_invalidHandlePencilMode",value:function(e,t){var n=t.element,a=this.configuration.mouseLocation.handles.start,r=e.handles.points;if(this._isDistanceSmallerThanCompleteSpacingCanvas(n,r[0],a))return e.canComplete=!0,!1;e.canComplete=!1;for(var o=1;o<r.length-1;o++)if(this._isDistanceSmallerThanSpacing(n,r[o],a))return!0;return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function(e,t,n){var a,r=v.default.cornerstone.pixelToCanvas(e,t),o=v.default.cornerstone.pixelToCanvas(e,n);return"Mouse"===this._drawingInteractionType?a=this.configuration.completeHandleRadius:"Touch"===this._drawingInteractionType&&(a=this.configuration.completeHandleRadiusTouch),this._compareDistanceToSpacing(e,r,o,"<",a)}},{key:"_isDistanceSmallerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,"<")}},{key:"_isDistanceLargerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,">")}},{key:"_compareDistanceToSpacing",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:">",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.configuration.spacing;return">"===a?v.default.cornerstoneMath.point.distance(t,n)>r:v.default.cornerstoneMath.point.distance(t,n)<r}},{key:"_activateDraw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Mouse";this._drawing=!0,this._drawingInteractionType=t,j.state.isMultiPartToolActive=!0,Object(_.hideToolCursor)(this.element),e.addEventListener(h.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.addEventListener(h.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.addEventListener(h.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.addEventListener(h.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.addEventListener(h.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(h.default.TOUCH_START,this._drawingMouseMoveCallback),e.addEventListener(h.default.TOUCH_START,this._drawingTouchStartCallback),e.addEventListener(h.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.addEventListener(h.default.TOUCH_END,this._drawingMouseUpCallback),e.addEventListener(h.default.DOUBLE_TAP,this._drawingDoubleTapClickCallback),v.default.cornerstone.updateImage(e)}},{key:"_deactivateDraw",value:function(e){this._drawing=!1,j.state.isMultiPartToolActive=!1,this._activeDrawingToolReference=null,this._drawingInteractionType=null,Object(_.setToolCursor)(this.element,this.svgCursor),e.removeEventListener(h.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.removeEventListener(h.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.removeEventListener(h.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.removeEventListener(h.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.removeEventListener(h.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(h.default.TOUCH_START,this._drawingTouchStartCallback),e.removeEventListener(h.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.removeEventListener(h.default.TOUCH_START,this._drawingMouseMoveCallback),e.removeEventListener(h.default.TOUCH_END,this._drawingMouseUpCallback),v.default.cornerstone.updateImage(e)}},{key:"_activateModify",value:function(e){j.state.isToolLocked=!0,e.addEventListener(h.default.MOUSE_UP,this._editMouseUpCallback),e.addEventListener(h.default.MOUSE_DRAG,this._editMouseDragCallback),e.addEventListener(h.default.MOUSE_CLICK,this._editMouseUpCallback),e.addEventListener(h.default.TOUCH_END,this._editMouseUpCallback),e.addEventListener(h.default.TOUCH_DRAG,this._editTouchDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_deactivateModify",value:function(e){j.state.isToolLocked=!1,e.removeEventListener(h.default.MOUSE_UP,this._editMouseUpCallback),e.removeEventListener(h.default.MOUSE_DRAG,this._editMouseDragCallback),e.removeEventListener(h.default.MOUSE_CLICK,this._editMouseUpCallback),e.removeEventListener(h.default.TOUCH_END,this._editMouseUpCallback),e.removeEventListener(h.default.TOUCH_DRAG,this._editTouchDragCallback),v.default.cornerstone.updateImage(e)}},{key:"passiveCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"enabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"disabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"_closeToolIfDrawing",value:function(e){this._drawing&&(this._endDrawing(e,this.configuration.currentHandle),v.default.cornerstone.updateImage(e))}},{key:"fireModifiedEvent",value:function(e,t){var n=h.default.MEASUREMENT_MODIFIED,a={toolName:this.name,toolType:this.name,element:e,measurementData:t};Object(w.default)(e,n,a)}},{key:"fireCompletedEvent",value:function(e,t){var n=h.default.MEASUREMENT_COMPLETED,a={toolName:this.name,toolType:this.name,element:e,measurementData:t};Object(w.default)(e,n,a)}},{key:"cancelDrawing",value:function(e){if(this._drawing){var t=Object(b.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1,n.currentHandle=0,n.currentTool=-1,a.canComplete=!1,Object(b.removeToolState)(e,this.name,a),this._deactivateDraw(e),v.default.cornerstone.updateImage(e)}}},{key:"newImageCallback",value:function(e){var t=this.configuration;if(this._drawing&&this._activeDrawingToolReference){var n=e.detail.element,a=this._activeDrawingToolReference;a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1;var r=a.handles.points;r[t.currentHandle-1].lines.push(r[0]),t.currentHandle=0,t.currentTool=-1,a.canComplete=!1,this._deactivateDraw(n),v.default.cornerstone.updateImage(n)}}},{key:"spacing",get:function(){return this.configuration.spacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand spacing to a value other than a number.");this.configuration.spacing=e,v.default.cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function(){return this.configuration.activeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.");this.configuration.activeHandleRadius=e,v.default.cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function(){return this.configuration.completeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.");this.configuration.completeHandleRadius=e,v.default.cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function(){return this.configuration.alwaysShowHandles},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");this.configuration.alwaysShowHandles=e,v.default.cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function(){return this.configuration.invalidColor},set:function(e){this.configuration.invalidColor=e,v.default.cornerstone.updateImage(this.element)}}]),t}(p.default);function q(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/LengthTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return M});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./stateManagement/toolState.js"),h=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/toolColors.js"),p=n("./drawing/index.js"),b=n("./drawing/drawLinkedTextBox.js"),y=n("./drawing/drawHandles.js"),x=n("./util/lineSegDistance.js"),j=n("./tools/cursors/index.js"),w=n("./util/logger.js"),T=n("./util/getPixelSpacing.js"),E=n("./util/throttle.js"),O=n("./store/index.js"),C=Object(w.getLogger)("tools:annotation:LengthTool"),M=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:j.lengthCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1,digits:2}};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(E.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t=e.currentPoints.image,n=t.x,a=t.y;return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:n,y:a,highlight:!0,active:!1},end:{x:n,y:a,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}C.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){return t&&t.handles&&t.handles.start&&t.handles.end?!1!==t.visible&&Object(x.default)(e,t.handles.start,t.handles.end,n)<25:(C.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!1)}},{key:"updateCachedStats",value:function(e,t,n){var a=Object(T.default)(e),r=(n.handles.end.x-n.handles.start.x)*(a.colPixelSpacing||1),o=(n.handles.end.y-n.handles.start.y)*(a.rowPixelSpacing||1),i=Math.sqrt(r*r+o*o);n.length=i,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.drawHandlesOnHover,i=a.hideHandlesIfMoving,s=a.renderDashed,l=a.digits,u=Object(g.getToolState)(e.currentTarget,this.name);if(u)for(var d=Object(p.getNewContext)(n.canvasContext.canvas),c=n.image,f=n.element,m=Object(T.default)(c),x=m.rowPixelSpacing,j=m.colPixelSpacing,w=h.default.getToolWidth(),E=Object(O.getModule)("globalConfiguration").configuration.lineDash,C=function(e){var a=u.data[e];if(!1===a.visible)return"continue";Object(p.draw)(d,function(e){Object(p.setShadow)(e,t.configuration);var u=v.default.getColorIfActive(a),d={color:u};s&&(d.lineDash=E),Object(p.drawLine)(e,f,a.handles.start,a.handles.end,d);var m={color:u,handleRadius:r,drawHandlesIfActive:o,hideHandlesIfMoving:i};if(t.configuration.drawHandles&&Object(y.default)(e,n,a.handles,m),!a.handles.textBox.hasMoved){var g={x:Math.max(a.handles.start.x,a.handles.end.x)};g.y=g.x===a.handles.start.x?a.handles.start.y:a.handles.end.y,a.handles.textBox.x=g.x,a.handles.textBox.y=g.y}!0===a.invalidated&&(a.length?t.throttledUpdateCachedStats(c,f,a):t.updateCachedStats(c,f,a));var h=function(e,t,n){var a,r=(a=Number(e.length),isNaN(a)?void 0:a);if(!r)return"";var o="mm";return t&&n||(o="pixels"),e.unit=o,"".concat(r.toFixed(l)," ").concat(o)}(a,x,j);Object(b.default)(e,f,a.handles.textBox,h,a.handles,I,u,w,10,!0)})},M=0;M<u.data.length;M++)C(M);function I(e){return[e.start,{x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2},e.end]}}}]),t}(m.default)},"./tools/annotation/ProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return I});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/textStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./drawing/drawTextBox.js"),x=n("./drawing/drawHandles.js"),j=n("./util/getRGBPixels.js"),w=n("./util/calculateSUV.js"),T=n("./tools/cursors/index.js"),E=n("./util/logger.js"),O=n("./util/throttle.js"),C=n("./store/index.js"),M=Object(E.getLogger)("tools:annotation:ProbeTool"),I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.probeCursor,configuration:{drawHandles:!0,renderDashed:!1}};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(O.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};M.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.end;if(a||M.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!a||!1===t.visible)return!1;var r=m.default.cornerstone.pixelToCanvas(e,t.handles.end);return m.default.cornerstoneMath.point.distance(r,n)<5}},{key:"updateCachedStats",value:function(e,t,n){var a=Math.round(n.handles.end.x),r=Math.round(n.handles.end.y),o={};a>=0&&r>=0&&a<e.columns&&r<e.rows&&(o.x=a,o.y=r,e.color?o.storedPixels=Object(j.default)(t,a,r,1,1):(o.storedPixels=m.default.cornerstone.getStoredPixels(t,a,r,1,1),o.sp=o.storedPixels[0],o.mo=o.sp*e.slope+e.intercept,o.suv=Object(w.default)(e,o.sp))),n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.renderDashed,i=Object(h.getToolState)(e.currentTarget,this.name);if(i)for(var s=Object(b.getNewContext)(n.canvasContext.canvas),l=n.image,u=n.element,d=v.default.getFontSize(),c=Object(C.getModule)("globalConfiguration").configuration.lineDash,f=function(e){var a=i.data[e];if(!1===a.visible)return"continue";Object(b.draw)(s,function(e){var i,s,f=p.default.getColorIfActive(a);if(t.configuration.drawHandles){var g={handleRadius:r,color:f};o&&(g.lineDash=c),Object(x.default)(e,n,a.handles,g)}!0===a.invalidated&&(a.cachedStats?t.throttledUpdateCachedStats(l,u,a):t.updateCachedStats(l,u,a));var h=a.cachedStats,v=h.x,b=h.y,j=h.storedPixels,w=h.sp,T=h.mo,E=h.suv;if(v>=0&&b>=0&&v<l.columns&&b<l.rows){i="".concat(v,", ").concat(b),l.color?s="R: ".concat(j[0]," G: ").concat(j[1]," B: ").concat(j[2]):(s="SP: ".concat(w," MO: ").concat(parseFloat(T.toFixed(3))),E&&(s+=" SUV: ".concat(parseFloat(E.toFixed(3)))));var O=m.default.cornerstone.pixelToCanvas(n.element,{x:a.handles.end.x+3,y:a.handles.end.y-3});Object(y.default)(e,s,O.x,O.y+d+5,f),Object(y.default)(e,i,O.x,O.y,f)}})},g=0;g<i.data.length;g++)f(g)}}]),t}(g.default)},"./tools/annotation/RectangleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return I});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),h=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./util/calculateSUV.js"),x=n("./util/getROITextBoxCoords.js"),j=n("./util/numbersWithCommas.js"),w=n("./util/throttle.js"),T=n("./tools/cursors/index.js"),E=n("./util/logger.js"),O=n("./util/getPixelSpacing.js"),C=n("./store/index.js"),M=Object(E.getLogger)("tools:annotation:RectangleRoiTool"),I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:T.rectangleRoiCursor};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(w.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};M.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end;if(r||M.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;var o="mouse"===a?15:25,i=m.default.cornerstone.pixelToCanvas(e,t.handles.start),s=m.default.cornerstone.pixelToCanvas(e,t.handles.end),l={left:Math.min(i.x,s.x),top:Math.min(i.y,s.y),width:Math.abs(i.x-s.x),height:Math.abs(i.y-s.y)};return m.default.cornerstoneMath.rect.distanceToPoint(l,n)<o}},{key:"updateCachedStats",value:function(e,t,n){var a=(m.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,r=Object(O.default)(e),o=function(e,t,n,a,r){var o,i=S(n.start,n.end),s=function(e,t){for(var n=0,a=0,r=0,o=0,i=e?e[0]:null,s=e?e[0]:null,l=t.top;l<t.top+t.height;l++)for(var u=t.left;u<t.left+t.width;u++)n+=e[o],a+=e[o]*e[o],i=Math.min(i,e[o]),s=Math.max(s,e[o]),r++,o++;if(0===r)return{count:r,mean:0,variance:0,stdDev:0,min:0,max:0};var d=n/r,c=a/r-d*d;return{count:r,mean:d,variance:c,stdDev:Math.sqrt(c),min:i,max:s}}(m.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),i);return"PT"===a&&(o={mean:Object(y.default)(e,s.mean,!0)||0,stdDev:Object(y.default)(e,s.stdDev,!0)||0}),{area:i.width*(r.colPixelSpacing||1)*(i.height*(r.rowPixelSpacing||1))||0,count:s.count||0,mean:s.mean||0,variance:s.variance||0,stdDev:s.stdDev||0,min:s.min||0,max:s.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(h.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,r=a.image,o=a.element,i=v.default.getToolWidth(),s=Object(C.getModule)("globalConfiguration").configuration.lineDash,l=this.configuration,u=l.handleRadius,d=l.drawHandlesOnHover,c=l.hideHandlesIfMoving,f=l.renderDashed,g=Object(b.getNewContext)(a.canvasContext.canvas),y=Object(O.default)(r),j=y.rowPixelSpacing,w=y.colPixelSpacing,T=(m.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,E=j&&w;Object(b.draw)(g,function(e){for(var l=0;l<n.data.length;l++){var m=n.data[l];if(!1!==m.visible){var g=p.default.getColorIfActive(m),h={color:g,handleRadius:u,drawHandlesIfActive:d,hideHandlesIfMoving:c};Object(b.setShadow)(e,t.configuration);var v={color:g};if(f&&(v.lineDash=s),Object(b.drawRect)(e,o,m.handles.start,m.handles.end,v,"pixel",m.handles.initialRotation),t.configuration.drawHandles&&Object(b.drawHandles)(e,a,m.handles,h),!0===m.invalidated&&(m.cachedStats?t.throttledUpdateCachedStats(r,o,m):t.updateCachedStats(r,o,m)),!m.handles.textBox.hasMoved){var y=Object(x.default)(a.viewport,m.handles);Object.assign(m.handles.textBox,y)}var j=_(e,r.color,m.cachedStats,T,E,t.configuration);m.unit=D(T,t.configuration.showHounsfieldUnits),Object(b.drawLinkedTextBox)(e,o,m.handles.textBox,j,m.handles,function(e){return[{x:(n=(t=S(e.start,e.end)).left)+(r=t.width)/2,y:a=t.top},{x:n,y:a+(o=t.height)/2},{x:n+r/2,y:a+o},{x:n+r,y:a+o/2}];var t,n,a,r,o},g,i,10,!0)}}})}}}]),t}(g.default);function S(e,t){return{left:Math.min(e.x,t.x),top:Math.min(e.y,t.y),width:Math.abs(e.x-t.x),height:Math.abs(e.y-t.y)}}function P(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(j.default)(e.toFixed(2))).concat(n)}function D(e,t){return"CT"===e&&!1!==t?"HU":""}function _(e,t,n,a,r){var o=n.area,i=n.mean,s=n.stdDev,l=n.min,u=n.max,d=n.meanStdDevSUV,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,m=[],g=[];if(!t){var h=d&&0!==d.mean,v=D(a,c.showHounsfieldUnits),p="Mean: ".concat(Object(j.default)(i.toFixed(2))," ").concat(v),b="Std Dev: ".concat(Object(j.default)(s.toFixed(2))," ").concat(v);if(h){for(var y=" SUV: ",x="".concat(y).concat(Object(j.default)(d.mean.toFixed(2))),w="".concat(y).concat(Object(j.default)(d.stdDev.toFixed(2))),T=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(p).width<T;)p+=" ";g.push("".concat(p).concat(x)),g.push("".concat(b,"     ").concat(w))}else g.push("".concat(p)),g.push("".concat(b));if(f){for(var E="Min: ".concat(l," ").concat(v),O="Max: ".concat(u," ").concat(v),C=h?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(p,"     ")).width);e.measureText(E).width<C;)E+=" ";g.push("".concat(E).concat(O))}}return m.push(P(o,r)),g.forEach(function(e){return m.push(e)}),m}},"./tools/annotation/TextMarkerTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./tools/base/BaseAnnotationTool.js"),v=n("./externalModules.js"),p=n("./util/pointInsideBoundingBox.js"),b=n("./stateManagement/toolColors.js"),y=n("./drawing/index.js"),x=n("./drawing/drawTextBox.js"),j=n("./stateManagement/toolState.js"),w=n("./tools/cursors/index.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:E},svgCursor:w.textMarkerCursor};return(e=l()(this,d()(t).call(this,n,a))).touchPressCallback=e._changeText.bind(f()(e)),e.doubleClickCallback=e._changeText.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){var t=this.configuration;if(t.current){var n={visible:!0,active:!0,text:t.current,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}};if(v.default.cornerstoneMath.point.insideRect(n.handles.end,{left:0,top:0,width:e.image.width,height:e.image.height})){var a=t.markers.indexOf(t.current);return(a+=t.ascending?1:-1)>=t.markers.length?a=t.loop?0:-1:a<0&&(a=t.loop?t.markers.length:-1),t.current=t.markers[a],n}}}},{key:"pointNearTool",value:function(e,t,n){if(!1===t.visible)return!1;if(t.handles.end.boundingBox){var a=v.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,n),r=Object(p.default)(t.handles.end,n);return a<10||r}}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=e.detail,n=this.configuration,a=Object(j.getToolState)(t.element,this.name);if(a)for(var r=Object(y.getNewContext)(t.canvasContext.canvas),o=function(e){var o=a.data[e];if(!1===o.visible)return"continue";var i=b.default.getColorIfActive(o);Object(y.draw)(r,function(e){Object(y.setShadow)(e,n);var a=v.default.cornerstone.pixelToCanvas(t.element,o.handles.end);o.handles.end.boundingBox=Object(x.default)(e,o.text,a.x,a.y-10,i,{centering:{x:!0,y:!0}})})},i=0;i<a.data.length;i++)o(i)}},{key:"_changeText",value:function(e){var t,n=e.detail,a=n.element;function r(e,t,n){!0===n?Object(j.removeToolState)(a,this.name,e):e.text=t,e.active=!1,v.default.cornerstone.updateImage(a)}var o=this.configuration,i=n.currentPoints.canvas,s=Object(j.getToolState)(a,this.name);if(s)for(var l=0;l<s.data.length;l++)if(this.pointNearTool(a,t=s.data[l],i))return t.active=!0,v.default.cornerstone.updateImage(a),o.changeTextCallback(t,n,r),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation()}}]),t}(h.default),E=function(e,t,n){n(e,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./events.js"),o=n("./manipulators/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),s=n("./stateManagement/toolState.js"),l=n("./util/triggerEvent.js"),u=n("./util/getActiveTool.js"),d=n("./tools/annotation/BidirectionalTool.js"),c=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js");t.default=function(e,t){var n=this,m=e.detail,g=m.element,h=m.image,v=m.buttons,p=this.configuration;if(!f(h)){var b=this.createNewMeasurement(m),y=function(){b.active=!1,a.default.cornerstone.updateImage(g)};Object(s.addToolState)(g,this.name,b),a.default.cornerstone.updateImage(g);var x=(new Date).getTime(),j=b.handles,w=j.end,T=j.perpendicularStart;Object(o.moveNewHandle)(m,this.name,b,w,{},t,function(e){if(e){var o=b.handles,f=b.longestDiameter,j=b.shortestDiameter,w=Object(i.default)(m,o),E=parseFloat(f)||0,O=parseFloat(j)||0,C=E<1||O<1,M=(new Date).getTime()-x<150;w||C||M?(b.cancelled=!0,Object(s.removeToolState)(g,n.name,b)):p.getMeasurementLocationCallback(b,m,y),Object(c.default)(m,b),T.locked=!1,b.invalidated=!0,a.default.cornerstone.updateImage(g);var I=Object(u.default)(g,v,t);I instanceof d.default&&I.updateCachedStats(h,g,b);var S={toolName:n.name,toolType:n.name,element:g,measurementData:b};Object(l.default)(g,r.default.MEASUREMENT_MODIFIED,S),Object(l.default)(g,r.default.MEASUREMENT_COMPLETED,S)}else Object(s.removeToolState)(g,n.name,b)})}};var f=function(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId),n=e.rowPixelSpacing,r=e.columnPixelSpacing;return t&&(n=t.rowPixelSpacing||t.rowImagePixelSpacing,r=t.columnPixelSpacing||t.colImagePixelSpacing),!n||!r}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object.assign({x:e,y:t,index:n,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},a)};t.default=function(e){var t=e.currentPoints.image,n=t.x,r=t.y;return{toolName:this.name,toolType:this.name,isCreating:!0,visible:!0,active:!0,invalidated:!0,handles:{start:a(n,r,0),end:a(n,r,1,{active:!0}),perpendicularStart:a(n,r,2,{locked:!0}),perpendicularEnd:a(n,r,3),textBox:a(n-50,r-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0}}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";"touch"===a?this.handleSelectedTouchCallback(e):this.handleSelectedMouseCallback(e)}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./events.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/anyHandlesOutsideImage.js"),d=n("./manipulators/getHandleNearImagePoint.js"),c=n("./manipulators/index.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),m=n("./tools/annotation/bidirectionalTool/invertHandles.js"),g=n("./store/setToolCursor.js");t.default=function(e){var t,n=this,a=e.detail,b=a.element,y=i.state.clickProximity,x=function(e){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(l.removeToolState)(b,n.name,t),e&&(e.moving=!1,e.selected=!0),Object(g.setToolCursor)(n.element,n.svgCursor),o.default.cornerstone.updateImage(b),b.addEventListener(s.default.MOUSE_MOVE,n._moveCallback),b.addEventListener(s.default.TOUCH_START,n._moveCallback)},j=a.startPoints.canvas,w=Object(l.getToolState)(e.currentTarget,this.name);if(w){for(var T=function(r){var o=d.default.apply(void 0,[b,(t=w.data[r]).handles,j,y]);if(o)return b.removeEventListener(s.default.MOUSE_MOVE,n._moveCallback),b.removeEventListener(s.default.TOUCH_START,n._moveCallback),t.active=!0,h(t.handles),o.moving=!0,(o=Object(m.default)(a,t,o)).hasBoundingBox||Object(g.hideToolCursor)(n.element),Object(f.default)(a,n.name,t,o,function(){return x(o)}),p(e),{v:!0}},E=0;E<w.data.length;E++){var O=T(E);if("object"===r()(O))return O.v}var C=function(e){return function(){v(e,!1),x()}};for(E=0;E<w.data.length;E++)if(this.pointNearTool(b,t=w.data[E],j,"mouse")){b.removeEventListener(s.default.MOUSE_MOVE,this._moveCallback),b.removeEventListener(s.default.TOUCH_START,this._moveCallback),t.active=!0,h(t.handles),v(t.handles,!0);var M=C(t.handles);return Object(c.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"mouse",M),p(e),!0}}};var h=function(e){var t=!1;return Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)}),t},v=function(e,t){Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].moving=t)})},p=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./events.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/anyHandlesOutsideImage.js"),d=n("./manipulators/getHandleNearImagePoint.js"),c=n("./manipulators/index.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");t.default=function(e){var t,n=this,a=e.detail,v=a.element,p=i.state.touchProximity,b=function(e){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(l.removeToolState)(v,n.name,t),e&&(e.moving=!1,e.selected=!0),o.default.cornerstone.updateImage(v),v.addEventListener(s.default.TOUCH_DRAG,n._moveCallback)},y=a.startPoints.canvas,x=Object(l.getToolState)(e.currentTarget,this.name);if(x){for(var j=function(r){var o=d.default.apply(void 0,[v,(t=x.data[r]).handles,y,p]);if(o)return v.removeEventListener(s.default.TOUCH_DRAG,n._moveCallback),t.active=!0,m(t.handles),o.moving=!0,Object(f.default)(a,n.name,t,o,function(){return b(o)}),h(e),{v:!0}},w=0;w<x.data.length;w++){var T=j(w);if("object"===r()(T))return T.v}var E=function(e){return function(){g(e,!1),b()}};for(w=0;w<x.data.length;w++)if(this.pointNearTool(v,t=x.data[w],y,"touch")){v.removeEventListener(s.default.TOUCH_DRAG,this._moveCallback),t.active=!0,m(t.handles),g(t.handles,!0);var O=E(t.handles);return Object(c.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"touch",O),h(e),!0}}};var m=function(e){var t=!1;return Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)}),t},g=function(e,t){Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].moving=t)})},h=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=function(e,t,n){var a=e[n];e[n]=t[n],t[n]=a},r=function(e,t){a(e,t,"x"),a(e,t,"y"),a(e,t,"moving"),a(e,t,"hover"),a(e,t,"active"),a(e,t,"selected")};function o(e,t,n){var a=e.image,o=a.rowPixelSpacing,i=a.columnPixelSpacing,s=t.handles,l=s.start,u=s.end,d=s.perpendicularStart,c=s.perpendicularEnd,f=(l.x-u.x)*(i||1),m=(l.y-u.y)*(o||1),g=Math.sqrt(f*f+m*m),h=(d.x-c.x)*(i||1),v=(d.y-c.y)*(o||1);return(Math.sqrt(h*h+v*v)||0)>g?(r(l,u),r(l,d),r(u,c),Object.values(s).find(function(e){return!0===e.moving})):n}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolCoordinates.js"),o=n("./manipulators/getHandleNearImagePoint.js"),i=n("./stateManagement/toolState.js");t.default=function(e){var t=this,n=e.detail,s=n.element;r.default.setCoords(n);var l=Object(i.getToolState)(s,this.name);if(l){for(var u=!1,d=function(e){var a=n.currentPoints.canvas,r=l.data[e],i=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=Object(o.default)(e,t,n,a),i=!1;return Object.keys(t).forEach(function(e){if("textBox"!==e){var n=t[e],a=n===r;n.active!==a&&(i=!0),n.active=a}}),i}(s,r.handles,a);Object.keys(r.handles).forEach(function(e){if("textBox"!==e){var t=r.handles[e];t.hover=t.active}}),i&&(u=!0);var d=t.pointNearTool(s,r,a,"mouse");(d&&!r.active||!d&&r.active)&&(r.active=!r.active,u=!0)},c=0;c<l.data.length;c++)d(c);!0===u&&a.default.cornerstone.updateImage(s)}}},"./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./externalModules.js"),r=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function o(e,t){return{start:e,end:t}}function i(e,t,n){var i=a.default.cornerstoneMath.lineSegment,s=e.handles,l=s.start,u=s.end,d=s.perpendicularStart,c=s.perpendicularEnd,f=t.image,m=f.columnPixelSpacing,g=void 0===m?1:m,h=f.rowPixelSpacing,v=void 0===h?1:h,p=o(l,u),b=o(d,c),y=i.intersectLine(p,b);return{columnPixelSpacing:g,rowPixelSpacing:v,start:l,end:u,perpendicularStart:d,perpendicularEnd:c,longLine:p,intersection:y,distanceToFixed:Object(r.default)(g,v,n,y),fixedPoint:n}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),s=n("./util/getActiveTool.js"),l=n("./tools/base/BaseAnnotationTool.js");t.default=function(e,t,n,u,d,c){var f=e.element,m=e.image,g=e.buttons,h={x:u.x-e.currentPoints.image.x,y:u.y-e.currentPoints.image.y},v=function(e){var r=e.detail;u.hasMoved=!0,null==u.index?(u.x=r.currentPoints.image.x+h.x,u.y=r.currentPoints.image.y+h.y):Object(i.default)(u,r,n,h),c&&(u.x=Math.max(u.x,0),u.x=Math.min(u.x,r.image.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,r.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(f);var d=Object(s.default)(f,g,"mouse");d instanceof l.default&&d.updateCachedStats(m,f,n),a.default.cornerstone.triggerEvent(f,o.default.MEASUREMENT_MODIFIED,{toolName:t,toolType:t,element:f,measurementData:n})};u.active=!0,u.moving=!0,r.state.isToolLocked=!0,f.addEventListener(o.default.MOUSE_DRAG,v),f.addEventListener(o.default.TOUCH_DRAG,v);var p=a.default.cornerstone.getImage(f),b=function(){a.default.cornerstone.getImage(f).imageId!==p.imageId&&y()};f.addEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,b);var y=function e(){u.active=!1,r.state.isToolLocked=!1,f.removeEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,b),f.removeEventListener(o.default.MOUSE_DRAG,v),f.removeEventListener(o.default.MOUSE_UP,e),f.removeEventListener(o.default.MOUSE_CLICK,e),f.removeEventListener(o.default.TOUCH_DRAG,v),f.removeEventListener(o.default.TOUCH_DRAG_END,e),f.removeEventListener(o.default.TAP,e),a.default.cornerstone.updateImage(f),"function"==typeof d&&d()};f.addEventListener(o.default.MOUSE_UP,y),f.addEventListener(o.default.MOUSE_CLICK,y),f.addEventListener(o.default.TOUCH_DRAG_END,y),f.addEventListener(o.default.TAP,y)}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js");function i(e,t,n,i){var s=Object(r.default)(t,n,i),l=s.columnPixelSpacing,u=s.rowPixelSpacing,d=s.distanceToFixed,c=Object(a.default)(l,u,i,e);if(c<=d)return!1;var f=d/c,m={x:i.x+(e.x-i.x)*f,y:i.y+(e.y-i.y)*f},g=Object(o.default)(s,m);return t.handles.perpendicularStart.x=g.start.x,t.handles.perpendicularStart.y=g.start.y,t.handles.perpendicularEnd.x=g.end.x,t.handles.perpendicularEnd.y=g.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),r=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function o(e,t){var n=e.columnPixelSpacing,o=e.rowPixelSpacing,i=e.start,s=e.perpendicularStart,l=e.perpendicularEnd,u=e.intersection,d=e.fixedPoint,c=Object(r.default)(n,o,s,u),f=Object(r.default)(n,o,l,u),m=Object(a.default)(n,o,d,t),g=d===i?1:-1,h=g*o,v=g*n;return{start:{x:t.x+m.y*c*h,y:t.y+m.x*c*v*-1},end:{x:t.x+m.y*f*h*-1,y:t.y+m.x*f*v}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function r(e,t){return Object(a.default)(e,t)?-1:1}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js");function r(e,t,n){var r=e.columnPixelSpacing,o=e.rowPixelSpacing,i=e.perpendicularEnd,s=e.fixedPoint,l=Number.MAX_SAFE_INTEGER,u=Object(a.default)(s,i)*l;return{start:t,end:{x:t.x+n.y*o*u,y:t.y+n.x*r*u*-1}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function r(e,t,n){return Object(a.default)(e,n)?t:n}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js":function(e,t,n){"use strict";function a(e,t){return e===t}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function r(e,t,n){return 0!==Object(a.default)(e,t,n.start,n.end)}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("./externalModules.js"),r=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js"),s=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js"),l=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js");function u(e,t,n,u){var d=a.default.cornerstoneMath.lineSegment,c=Object(o.default)(t,n,u),f=c.columnPixelSpacing,m=c.rowPixelSpacing,g=c.start,h=c.longLine,v=c.intersection;if(!Object(i.default)(f,m,h))return!1;var p=Object(r.default)(f,m,g,v),b=Object(s.default)(c,e,p),y=d.intersectLine(h,b);if(!y)return!1;var x=Object(l.default)(c,y,b,p);return t.handles.perpendicularStart.x=x.start.x,t.handles.perpendicularStart.y=x.start.y,t.handles.perpendicularEnd.x=x.end.x,t.handles.perpendicularEnd.y=x.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),r=n.n(a),o=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js");function s(e,t,n,a){var s,l=e.columnPixelSpacing,u=e.rowPixelSpacing,d=e.fixedPoint,c=e.perpendicularStart,f=e.perpendicularEnd,m=e.distanceToFixed,g=Object(o.default)(d,f)*m,h=Object(i.default)(d,c,f)===c,v=h?"start":"end",p=h?"end":"start";return s={},r()(s,v,{x:n.start.x,y:n.start.y}),r()(s,p,{x:t.x+a.y*u*g,y:t.y+a.x*l*g*-1}),s}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js");t.default=function(e,t,n,i){var s,l,u,d,c={},f={},m={x:t.currentPoints.image.x+i.x,y:t.currentPoints.image.y+i.y};0===e.index?Object(r.default)(m,n,t,n.handles.end)?(e.x=m.x,e.y=m.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):1===e.index?Object(r.default)(m,n,t,n.handles.start)?(e.x=m.x,e.y=m.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):2===e.index?(s=!1,c.start={x:n.handles.start.x,y:n.handles.start.y},c.end={x:n.handles.end.x,y:n.handles.end.y},f.start={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},f.end={x:m.x,y:m.y},(l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f))||(f.end={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f),u=a.default.cornerstoneMath.point.distance(l,n.handles.start),d=a.default.cornerstoneMath.point.distance(l,n.handles.end),(!l||u<3||d<3)&&(s=!0)),s||Object(o.default)(m,n,t,n.handles.perpendicularEnd)||(t.currentPoints.image.x=n.handles.perpendicularStart.x,t.currentPoints.image.y=n.handles.perpendicularStart.y)):3===e.index&&(s=!1,c.start={x:n.handles.start.x,y:n.handles.start.y},c.end={x:n.handles.end.x,y:n.handles.end.y},f.start={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},f.end={x:m.x,y:m.y},(l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f))||(f.end={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f),u=a.default.cornerstoneMath.point.distance(l,n.handles.start),d=a.default.cornerstoneMath.point.distance(l,n.handles.end),(!l||u<3||d<3)&&(s=!0)),s||Object(o.default)(m,n,t,n.handles.perpendicularStart)||(t.currentPoints.image.x=n.handles.perpendicularEnd.x,t.currentPoints.image.y=n.handles.perpendicularEnd.y))}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),s=n("./util/getActiveTool.js"),l=n("./tools/base/BaseAnnotationTool.js"),u=[o.default.TOUCH_END,o.default.TOUCH_DRAG_END,o.default.TOUCH_PINCH,o.default.TOUCH_PRESS,o.default.TAP];t.default=function(e,t,n,d,c,f){var m=e.element,g=e.image,h=e.buttons,v={x:d.x-e.currentPoints.image.x,y:d.y-e.currentPoints.image.y},p=function(e){var r=e.detail;d.hasMoved=!0,null==d.index?(d.x=r.currentPoints.image.x+v.x,d.y=r.currentPoints.image.y+v.y):Object(i.default)(d,r,n,v),f&&(d.x=Math.max(d.x,0),d.x=Math.min(d.x,r.image.width),d.y=Math.max(d.y,0),d.y=Math.min(d.y,r.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(m);var u=Object(s.default)(m,h,"touch");u instanceof l.default&&u.updateCachedStats(g,m,n),a.default.cornerstone.triggerEvent(m,o.default.MEASUREMENT_MODIFIED,{toolName:t,toolType:t,element:m,measurementData:n})};d.active=!0,r.state.isToolLocked=!0,m.addEventListener(o.default.TOUCH_DRAG,p);var b=function e(){d.active=!1,r.state.isToolLocked=!1,m.removeEventListener(o.default.TOUCH_DRAG,p),u.forEach(function(t){m.removeEventListener(t,e)}),a.default.cornerstone.updateImage(m),"function"==typeof c&&c()};u.forEach(function(e){m.addEventListener(e,b)})}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./externalModules.js"),o=n("./util/pointInsideBoundingBox.js"),i=function(e,t,n,a){var o=r.default.cornerstone,i=r.default.cornerstoneMath,s={start:o.pixelToCanvas(e,t.perpendicularStart),end:o.pixelToCanvas(e,t.perpendicularEnd)};return i.lineSegment.distanceToPoint(s,n)<a};t.default=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",l=r.default.cornerstone,u=r.default.cornerstoneMath,d=t.handles,c={start:l.pixelToCanvas(e,d.start),end:l.pixelToCanvas(e,d.end)},f=u.lineSegment.distanceToPoint(c,n);if(Object(o.default)(d.textBox,n))return!0;var m="mouse"===s?a.state.clickProximity:a.state.touchProximity;return!!i(e,d,n,m)||f<m}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./drawing/drawHandles.js"),i=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),s=n("./store/index.js"),l=n("./stateManagement/toolStyle.js"),u=n("./stateManagement/toolColors.js"),d=n("./stateManagement/toolState.js"),c=n("./drawing/index.js"),f=n("./drawing/drawLinkedTextBox.js"),m=n("./util/getPixelSpacing.js");t.default=function(e){var t=this,n=e.detail,a=n.element,r=n.canvasContext,h=n.image,v=this.configuration,p=v.handleRadius,b=v.drawHandlesOnHover,y=v.hideHandlesIfMoving,x=v.renderDashed,j=Object(s.getModule)("globalConfiguration").configuration.lineDash,w=Object(d.getToolState)(a,this.name);if(w){var T=Object(m.default)(h),E=T.rowPixelSpacing,O=T.colPixelSpacing;if(E&&O)for(var C,M=Object(c.getNewContext)(r.canvas),I=u.default.getActiveColor(),S=l.default.getToolWidth(),P=function(e){var r=w.data[e];if(!1===r.visible)return"continue";C=r.active?I:u.default.getToolColor(),!0===r.invalidated&&(r.longestDiameter&&r.shortestDiameter?t.throttledUpdateCachedStats(h,a,r):t.updateCachedStats(h,a,r)),Object(c.draw)(M,function(e){Object(c.setShadow)(e,t.configuration);var s=r.handles,l=s.start,u=s.end,d=s.perpendicularStart,m=s.perpendicularEnd,h=s.textBox,v={color:C},w={color:C,strokeWidth:T};x&&(v.lineDash=j,w.lineDash=j),Object(c.drawLine)(e,a,l,u,v);var T=S;Object(i.default)(n,r),Object(c.drawLine)(e,a,d,m,w);var M={color:C,handleRadius:p,drawHandlesIfActive:b,hideHandlesIfMoving:y};t.configuration.drawHandles&&Object(o.default)(e,n,r.handles,M);var I=g(r,E,O);Object(f.default)(e,a,h,I,r.handles,function(e){return[e.start,e.end,e.perpendicularStart,e.perpendicularEnd]},C,S,10,!0)})},D=0;D<w.data.length;D++)P(D)}};var g=function(e,t,n){var a=" mm";t&&n||(a=" pixels");var o=" L ".concat(e.longestDiameter).concat(a),i=" W ".concat(e.shortestDiameter).concat(a),s=e.labels;return s&&Array.isArray(s)?[].concat(r()(s),[o,i]):[o,i]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(e,t,n){"use strict";function a(e,t){var n=t.rowPixelSpacing,a=t.colPixelSpacing,r=e.handles,o=r.start,i=r.end,s=r.perpendicularStart,l=r.perpendicularEnd,u=(o.x-i.x)*(a||1),d=(o.y-i.y)*(n||1),c=Math.sqrt(u*u+d*d),f=(s.x-l.x)*(a||1),m=(s.y-l.y)*(n||1),g=Math.sqrt(f*f+m*m);if(g||(g=0),g>c){var h=c;c=g,g=h}return{longestDiameter:c.toFixed(1),shortestDiameter:g.toFixed(1)}}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js":function(e,t,n){"use strict";function a(e,t,n,a){var r=(n.x-a.x)/t,o=(n.y-a.y)/e;return Math.sqrt(r*r+o*o)}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/getLineVector.js":function(e,t,n){"use strict";function a(e,t,n,a){var r=(n.x-a.x)*e,o=(n.y-a.y)*t,i=Math.sqrt(r*r+o*o);return{x:r/i,y:o/i,length:i}}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js");function r(e,t){if(!t.handles.perpendicularStart.locked)return!1;var n,r,o,i,s=t.handles,l=s.start,u=s.end,d=e.image,c=d.columnPixelSpacing,f=void 0===c?1:c,m=d.rowPixelSpacing,g=void 0===m?1:m;if(l.x===u.x&&l.y===u.y)n=l.x,r=l.y,o=u.x,i=u.y;else{var h={x:(l.x+u.x)/2,y:(l.y+u.y)/2},v=Object(a.default)(f,g,l,u),p=v.length/2,b=p/(2*g),y=p/(2*f);n=h.x+y*v.y,r=h.y-b*v.x,o=h.x-y*v.y,i=h.y+b*v.x}return t.handles.perpendicularStart.x=n,t.handles.perpendicularStart.y=r,t.handles.perpendicularEnd.x=o,t.handles.perpendicularEnd.y=i,!0}},"./tools/annotation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/AngleTool.js"),r=n("./tools/annotation/ArrowAnnotateTool.js"),o=n("./tools/annotation/BidirectionalTool.js"),i=n("./tools/annotation/CircleRoiTool.js"),s=n("./tools/annotation/CobbAngleTool.js"),l=n("./tools/annotation/EllipticalRoiTool.js"),u=n("./tools/annotation/FreehandRoiTool.js"),d=n("./tools/annotation/LengthTool.js"),c=n("./tools/annotation/ProbeTool.js"),f=n("./tools/annotation/RectangleRoiTool.js"),m=n("./tools/annotation/TextMarkerTool.js");n.d(t,"AngleTool",function(){return a.default}),n.d(t,"ArrowAnnotateTool",function(){return r.default}),n.d(t,"BidirectionalTool",function(){return o.default}),n.d(t,"CircleRoiTool",function(){return i.default}),n.d(t,"CobbAngleTool",function(){return s.default}),n.d(t,"EllipticalRoiTool",function(){return l.default}),n.d(t,"FreehandRoiTool",function(){return u.default}),n.d(t,"LengthTool",function(){return d.default}),n.d(t,"ProbeTool",function(){return c.default}),n.d(t,"RectangleRoiTool",function(){return f.default}),n.d(t,"TextMarkerTool",function(){return m.default}),t.default={AngleTool:a.default,ArrowAnnotateTool:r.default,BidirectionalTool:o.default,CircleRoiTool:i.default,CobbAngleTool:s.default,EllipticalRoiTool:l.default,FreehandRoiTool:u.default,LengthTool:d.default,ProbeTool:c.default,RectangleRoiTool:f.default,TextMarkerTool:m.default}},"./tools/base/BaseAnnotationTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),m=n("./tools/base/BaseTool.js"),g=n("./stateManagement/toolState.js"),h=n("./manipulators/handleActivator.js"),v=n("./util/findAndMoveHelpers.js"),p=n("./util/logger.js"),b=Object(p.getLogger)("baseAnnotationTool");t.default=function(e){function t(){return r()(this,t),l()(this,d()(t).apply(this,arguments))}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){throw new Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function(e,t,n){throw new Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function(e,t,n){throw new Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function(e){throw new Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function(e){for(var t=e.detail,n=t.element,a=t.currentPoints.canvas,r=Object(g.getToolState)(n,this.name),o=!1,i=0;i<r.data.length;i++){var s=r.data[i];!0===Object(h.default)(n,s.handles,a)&&(o=!0);var l=this.pointNearTool(n,s,a,"mouse")&&!s.active,u=!this.pointNearTool(n,s,a,"mouse")&&s.active;(l||u)&&(s.active=!s.active,o=!0)}return o}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";Object(v.moveHandleNearImagePoint)(e,this,t,n,a)}},{key:"toolSelectedCallback",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";Object(v.moveAnnotation)(e,this,t,n)}},{key:"updateCachedStats",value:function(e,t,n){b.warn("updateCachedStats not implemented for ".concat(this.name,"."))}}]),t}(m.default)},"./tools/base/BaseBrushTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./tools/base/BaseTool.js"),v=n("./events.js"),p=n("./externalModules.js"),b=n("./store/isToolActiveForElement.js"),y=n("./store/index.js"),x=n("./util/segmentation/index.js"),j=Object(y.getModule)("segmentation");t.default=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r()(this,t),a.configuration||(a.configuration={alwaysEraseOnClick:!1}),(n=l()(this,d()(t).call(this,e,a))).updateOnMouseMove=!0,n.hideDefaultCursor=!0,n._drawing=!1,n._drawingMouseUpCallback=n._drawingMouseUpCallback.bind(f()(n)),n}return g()(t,e),i()(t,[{key:"renderBrush",value:function(e){throw new Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function(e){throw new Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function(e){this._lastImageCoords=e.detail.currentPoints.image,this._drawing&&this._paint(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=t.element,a=t.currentPoints;return this._startPainting(e),this._lastImageCoords=a.image,this._drawing=!0,this._startListeningForMouseUp(n),this._paint(e),!0}},{key:"_startPainting",value:function(e){var t=e.detail,n=j.configuration,a=j.getters.labelmap2D(t.element),r=a.labelmap2D,o=a.labelmap3D,i=a.currentImageIdIndex,s=a.activeLabelmapIndex,l=this._isCtrlDown(t)||this.configuration.alwaysEraseOnClick;if(this.paintEventData={labelmap2D:r,labelmap3D:o,currentImageIdIndex:i,activeLabelmapIndex:s,shouldErase:l},n.storeHistory){var u=r.pixelData.slice();this.paintEventData.previousPixelData=u}}},{key:"_endPainting",value:function(e){for(var t=j.configuration,n=j.setters,a=this.paintEventData,r=a.labelmap2D,o=a.currentImageIdIndex,i=new Set(r.pixelData).values(),s=[],l=!1;!l;){var u=i.next();(l=u.done)||s.push(u.value)}if(r.segmentsOnLabelmap=s,t.storeHistory){var d=this.paintEventData.previousPixelData,c=r.pixelData,f={imageIdIndex:o,diff:Object(x.getDiffBetweenPixelData)(d,c)};n.pushState(this.element,[f])}Object(x.triggerLabelmapModifiedEvent)(this.element)}},{key:"mouseMoveCallback",value:function(e){this._lastImageCoords=e.detail.currentPoints.image}},{key:"renderToolData",value:function(e){var t=e.detail.element;Object(b.default)(t,this.name)&&this.renderBrush(e)}},{key:"passiveCallback",value:function(e){try{p.default.cornerstone.updateImage(this.element)}catch(t){return}}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail.element;this._endPainting(e),this._drawing=!1,this._mouseUpRender=!0,this._stopListeningForMouseUp(t)}},{key:"newImageCallback",value:function(e){this._drawing&&(this._endPainting(e),this._startPainting(e))}},{key:"_startListeningForMouseUp",value:function(e){e.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),e.addEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),p.default.cornerstone.updateImage(e)}},{key:"_stopListeningForMouseUp",value:function(e){e.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),p.default.cornerstone.updateImage(e)}},{key:"increaseBrushSize",value:function(){var e=j.setters,t=j.configuration.radius,n=Math.floor(1.2*t);n===t&&(n+=1),e.radius(n)}},{key:"decreaseBrushSize",value:function(){var e=j.setters,t=Math.floor(.8*j.configuration.radius);e.radius(t)}},{key:"_isCtrlDown",value:function(e){return e.event&&e.event.ctrlKey||e.ctrlKey}}]),t}(h.default)},"./tools/base/BaseTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(s),u=n("./mixins/index.js"),d=n("./util/logger.js"),c=n("./util/deepmerge.js"),f=n("./store/setToolCursor.js"),m=n("./store/index.js"),g=Object(d.getLogger)("tools:base:BaseTool"),h=Object(m.getModule)("globalConfiguration");t.default=function(){function e(t,n){i()(this,e),this.initialConfiguration=Object(c.default)(n,t);var a=this.initialConfiguration,r=a.strategies,o=a.defaultStrategy,s=a.configuration,l=a.supportedInteractionTypes,u=a.mixins,d=a.svgCursor;this.name=a.name,this.mode="disabled",this.element=void 0,this.supportedInteractionTypes=l||[],this.strategies=r||{},this.defaultStrategy=o||Object.keys(this.strategies)[0]||void 0,this.activeStrategy=this.defaultStrategy,d&&(this.svgCursor=d),this._options={},this._configuration=Object.assign({},s),this.updateOnMouseMove=!1,this.hideDefaultCursor=!1,u&&u.length&&this._applyMixins(u),this._cursors=Object.assign({},this.initialConfiguration.cursors);var f=this.defaultStrategy&&this._cursors[this.activeStrategy];f&&(this.svgCursor=f)}return l()(e,[{key:"mergeOptions",value:function(e){this._options=Object.assign({},this._options,e)}},{key:"clearOptions",value:function(){this._options={}}},{key:"applyActiveStrategy",value:function(e,t){return this.strategies[this.activeStrategy].call(this,e,t)}},{key:"_applyMixins",value:function(e){for(var t=0;t<e.length;t++){var n=u.default["".concat(e[t])];"object"===r()(n)?(Object.assign(this,n),"function"==typeof this.initializeMixin&&this.initializeMixin()):g.warn("".concat(this.name,": mixin ").concat(u.default[t]," does not exist."))}"function"===this.initializeMixin&&delete this.initializeMixin}},{key:"setActiveStrategy",value:function(e){this.activeStrategy=e,h.configuration.showSVGCursors&&this.changeCursor(this.element,e)}},{key:"changeCursor",value:function(e,t){if(e){var n=this._cursors[t];n&&(this.svgCursor=n,"active"===this.mode&&Object(f.setToolCursor)(e,n))}}},{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"options",get:function(){return this._options}}],[{key:"configuration",get:function(){}}]),e}()},"./tools/base/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/base/BaseAnnotationTool.js"),r=n("./tools/base/BaseTool.js"),o=n("./tools/base/BaseBrushTool.js");n.d(t,"BaseAnnotationTool",function(){return a.default}),n.d(t,"BaseBrushTool",function(){return o.default}),n.d(t,"BaseTool",function(){return r.default}),t.default={BaseAnnotationTool:a.default,BaseBrushTool:o.default,BaseTool:r.default}},"./tools/cursors/MouseCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./stateManagement/toolColors.js"),l=n("./store/index.js").modules.cursor,u=function(){function e(t,n){r()(this,e),this.iconGroupString=t,this.options=Object.assign({},l.getters.defaultOptions(),n)}return i()(e,[{key:"getIconSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconSVGString(e)}},{key:"getIconWithPointerSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconWithPointerSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconWithPointerSVGString(e)}},{key:"_generateIconWithPointerSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.mousePointerGroupString,a=t.iconSize,r=t.viewBox,o=a/Math.max(r.x,r.y),i=16+a,s='\n        <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(i,'" height="').concat(i,'" viewBox="0 0 ').concat(i," ").concat(i,'"\n      >\n        <g>\n          ').concat(n,'\n        </g>\n        <g transform="translate(16, 16) scale(').concat(o,')">\n          ').concat(this.iconGroupString,"\n        </g>\n      </svg>");return this._injectColors(s,t)}},{key:"_generateIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.iconSize,a=t.viewBox,r='\n      <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(n,'" height="').concat(n,'" viewBox="0 0\n        ').concat(a.x," ").concat(a.y,'"\n      >\n        ').concat(this.iconGroupString,"\n      </svg>");return this._injectColors(r,t)}},{key:"_injectColors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.activeColor||s.default.getActiveColor(),a=t.toolColor||s.default.getToolColor(),r=t.fillColor||s.default.getFillColor();return e.replace(/ACTIVE_COLOR/g,"".concat(n)).replace(/TOOL_COLOR/g,"".concat(a)).replace(/FILL_COLOR/g,"".concat(r))}},{key:"mousePoint",get:function(){var e=this.options.mousePoint;return"".concat(e.x," ").concat(e.y)}}]),e}()},"./tools/cursors/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"angleCursor",function(){return r}),n.d(t,"arrowAnnotateCursor",function(){return o}),n.d(t,"bidirectionalCursor",function(){return i}),n.d(t,"cobbAngleCursor",function(){return s}),n.d(t,"circleRoiCursor",function(){return l}),n.d(t,"ellipticalRoiCursor",function(){return u}),n.d(t,"freehandRoiCursor",function(){return d}),n.d(t,"freehandRoiSculptorCursor",function(){return c}),n.d(t,"lengthCursor",function(){return f}),n.d(t,"probeCursor",function(){return m}),n.d(t,"rectangleRoiCursor",function(){return g}),n.d(t,"textMarkerCursor",function(){return h}),n.d(t,"crosshairsCursor",function(){return v}),n.d(t,"eraserCursor",function(){return p}),n.d(t,"magnifyCursor",function(){return b}),n.d(t,"panCursor",function(){return y}),n.d(t,"rotateCursor",function(){return x}),n.d(t,"stackScrollCursor",function(){return j}),n.d(t,"wwwcRegionCursor",function(){return w}),n.d(t,"wwwcCursor",function(){return T}),n.d(t,"zoomCursor",function(){return E}),n.d(t,"freehandEraseInsideCursor",function(){return D}),n.d(t,"freehandFillInsideCursor",function(){return _}),n.d(t,"freehandEraseOutsideCursor",function(){return L}),n.d(t,"freehandFillOutsideCursor",function(){return k}),n.d(t,"segRectangleEraseInsideCursor",function(){return A}),n.d(t,"segRectangleFillInsideCursor",function(){return R}),n.d(t,"segRectangleEraseOutsideCursor",function(){return B}),n.d(t,"segRectangleFillOutsideCursor",function(){return H}),n.d(t,"segCircleEraseInsideCursor",function(){return F}),n.d(t,"segCircleFillInsideCursor",function(){return U}),n.d(t,"segCircleEraseOutsideCursor",function(){return N}),n.d(t,"segCircleFillOutsideCursor",function(){return V});var a=n("./tools/cursors/MouseCursor.js"),r=new a.default('<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z"\n      />',{viewBox:{x:1792,y:1792}}),o=new a.default('<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>',{viewBox:{x:24,y:24}}),i=new a.default('<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>',{viewBox:{x:48,y:48}}),s=new a.default('<g stroke="ACTIVE_COLOR" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>',{viewBox:{x:32,y:32}}),l=new a.default('<circle stroke="ACTIVE_COLOR" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',{viewBox:{x:32,y:32}}),u=new a.default('<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z"\n    />',{viewBox:{x:32,y:32}}),d=new a.default('\n  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>',{viewBox:{x:18,y:18}}),c=new a.default('<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n    </g>',{viewBox:{x:18,y:18}}),f=new a.default('<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>',{viewBox:{x:24,y:24}}),m=new a.default('<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z"\n  />',{viewBox:{x:1792,y:1792}}),g=new a.default('<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),h=new a.default('<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"\n  />',{viewBox:{x:1792,y:1792}}),v=new a.default('<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"\n  />',{viewBox:{x:1792,y:1792}}),p=new a.default('<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z"\n    />',{viewBox:{x:2048,y:1792}}),b=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />',{viewBox:{x:512,y:512}}),y=new a.default('<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"\n    />',{viewBox:{x:1792,y:1792}}),x=new a.default('<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z"\n    />',{viewBox:{x:1792,y:1792}}),j=new a.default('<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"\n      />',{viewBox:{x:24,y:28}}),w=new a.default('<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),T=new a.default('<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />',{viewBox:{x:18,y:18}}),E=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />\n    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"\n    />',{viewBox:{x:640,y:512}}),O={x:127,y:60},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>')},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>\n      <rect fill="').concat(e,'" x="95.84" y="9.38" width="15.85" height="47.14"/>')},I='<path fill="ACTIVE_COLOR" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',S='<path fill="ACTIVE_COLOR" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',P='<path fill="ACTIVE_COLOR" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',D=new a.default("".concat(I," ").concat(C()),{viewBox:O}),_=new a.default("".concat(I," ").concat(M()),{viewBox:O}),L=new a.default("".concat(I," ").concat(C()),{viewBox:O}),k=new a.default("".concat(I," ").concat(M()),{viewBox:O}),A=new a.default("".concat(S," ").concat(C()),{viewBox:O}),R=new a.default("".concat(S," ").concat(M()),{viewBox:O}),B=new a.default("".concat(S," ").concat(C()),{viewBox:O}),H=new a.default("".concat(S," ").concat(M()),{viewBox:O}),F=new a.default("".concat(P," ").concat(C()),{viewBox:O}),U=new a.default("".concat(P," ").concat(M()),{viewBox:O}),N=new a.default("".concat(P," ").concat(C()),{viewBox:O}),V=new a.default("".concat(P," ").concat(M()),{viewBox:O})},"./tools/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/CrosshairsTool.js");n.d(t,"CrosshairsTool",function(){return a.default});var r=n("./tools/DoubleTapFitToWindowTool.js");n.d(t,"DoubleTapFitToWindowTool",function(){return r.default});var o=n("./tools/DragProbeTool.js");n.d(t,"DragProbeTool",function(){return o.default});var i=n("./tools/EraserTool.js");n.d(t,"EraserTool",function(){return i.default});var s=n("./tools/FreehandRoiSculptorTool.js");n.d(t,"FreehandRoiSculptorTool",function(){return s.default});var l=n("./tools/MagnifyTool.js");n.d(t,"MagnifyTool",function(){return l.default});var u=n("./tools/OverlayTool.js");n.d(t,"OverlayTool",function(){return u.default});var d=n("./tools/OrientationMarkersTool.js");n.d(t,"OrientationMarkersTool",function(){return d.default});var c=n("./tools/PanMultiTouchTool.js");n.d(t,"PanMultiTouchTool",function(){return c.default});var f=n("./tools/PanTool.js");n.d(t,"PanTool",function(){return f.default});var m=n("./tools/ReferenceLinesTool.js");n.d(t,"ReferenceLinesTool",function(){return m.default});var g=n("./tools/RotateTool.js");n.d(t,"RotateTool",function(){return g.default});var h=n("./tools/RotateTouchTool.js");n.d(t,"RotateTouchTool",function(){return h.default});var v=n("./tools/ScaleOverlayTool.js");n.d(t,"ScaleOverlayTool",function(){return v.default});var p=n("./tools/StackScrollMouseWheelTool.js");n.d(t,"StackScrollMouseWheelTool",function(){return p.default});var b=n("./tools/StackScrollMultiTouchTool.js");n.d(t,"StackScrollMultiTouchTool",function(){return b.default});var y=n("./tools/StackScrollTool.js");n.d(t,"StackScrollTool",function(){return y.default});var x=n("./tools/WwwcRegionTool.js");n.d(t,"WwwcRegionTool",function(){return x.default});var j=n("./tools/WwwcTool.js");n.d(t,"WwwcTool",function(){return j.default});var w=n("./tools/ZoomMouseWheelTool.js");n.d(t,"ZoomMouseWheelTool",function(){return w.default});var T=n("./tools/ZoomTool.js");n.d(t,"ZoomTool",function(){return T.default});var E=n("./tools/ZoomTouchPinchTool.js");n.d(t,"ZoomTouchPinchTool",function(){return E.default}),t.default={CrosshairsTool:a.default,DoubleTapFitToWindowTool:r.default,DragProbeTool:o.default,EraserTool:i.default,FreehandRoiSculptorTool:s.default,MagnifyTool:l.default,OverlayTool:u.default,OrientationMarkersTool:d.default,PanMultiTouchTool:c.default,PanTool:f.default,ReferenceLinesTool:m.default,RotateTool:g.default,RotateTouchTool:h.default,ScaleOverlayTool:v.default,StackScrollMouseWheelTool:p.default,StackScrollMultiTouchTool:b.default,StackScrollTool:y.default,WwwcRegionTool:x.default,WwwcTool:j.default,ZoomMouseWheelTool:w.default,ZoomTool:T.default,ZoomTouchPinchTool:E.default}},"./tools/referenceLines/calculateReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/pointProjector.js");t.default=function(e,t){var n=Object(a.planePlaneIntersection)(e,t);if(n)return{start:Object(a.projectPatientPointToImagePlane)(n.start,e),end:Object(a.projectPatientPointToImagePlane)(n.end,e)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./tools/referenceLines/calculateReferenceLine.js"),o=n("./stateManagement/toolColors.js"),i=n("./util/convertToVector3.js"),s=n("./drawing/index.js");t.default=function(e,t,n,l){var u=a.default.cornerstone,d=u.getEnabledElement(n).image,c=u.getEnabledElement(l).image;if(d&&c){var f=u.metaData.get("imagePlaneModule",d.imageId),m=u.metaData.get("imagePlaneModule",c.imageId);if(f&&m&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&m.rowCosines&&m.columnCosines&&m.imagePositionPatient&&f.frameOfReferenceUID===m.frameOfReferenceUID){f.rowCosines=Object(i.default)(f.rowCosines),f.columnCosines=Object(i.default)(f.columnCosines),f.imagePositionPatient=Object(i.default)(f.imagePositionPatient),m.rowCosines=Object(i.default)(m.rowCosines),m.columnCosines=Object(i.default)(m.columnCosines),m.imagePositionPatient=Object(i.default)(m.imagePositionPatient);var g=f.rowCosines.clone().cross(f.columnCosines),h=m.rowCosines.clone().cross(m.columnCosines),v=g.angleTo(h);if(!((v=Math.abs(v))<.5)){var p=Object(r.default)(f,m);if(p){var b=o.default.getActiveColor();e.setTransform(1,0,0,1,0,0),Object(s.draw)(e,function(e){Object(s.drawLine)(e,t.element,p.start,p.end,{color:b})})}}}}}},"./tools/segmentation/BrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return j});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=n("./tools/base/index.js"),p=n("./store/index.js"),b=n("./util/segmentation/index.js"),y=n("./util/logger.js"),x=(Object(y.getLogger)("tools:BrushTool"),Object(p.getModule)("segmentation")),j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Brush",supportedInteractionTypes:["Mouse","Touch"],configuration:{},mixins:["renderBrushMixin"]};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._paint.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_paint",value:function(e){var t=e.detail,n=t.image,a=n.rows,r=n.columns,o=t.currentPoints.image,i=o.x,s=o.y;if(!(i<0||i>r||s<0||s>a)){var l=x.configuration.radius,u=Object(b.getCircle)(l,a,r,i,s),d=this.paintEventData,c=d.labelmap2D,f=d.labelmap3D,m=d.shouldErase;Object(b.drawBrushPixels)(u,c.pixelData,f.activeSegmentIndex,r,m),h.default.cornerstone.updateImage(e.detail.element)}}}]),t}(v.BaseBrushTool)},"./tools/segmentation/CircleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/segmentation/strategies/index.js"),m=n("./tools/cursors/index.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"CircleScissors",strategies:{FILL_INSIDE:f.fillInsideCircle,FILL_OUTSIDE:f.fillOutsideCircle,ERASE_OUTSIDE:f.eraseOutsideCircle,ERASE_INSIDE:f.eraseInsideCircle},cursors:{FILL_INSIDE:m.segCircleFillInsideCursor,FILL_OUTSIDE:m.segCircleFillOutsideCursor,ERASE_OUTSIDE:m.segCircleEraseOutsideCursor,ERASE_INSIDE:m.segCircleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:m.segCircleFillInsideCursor,mixins:["circleSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/CorrectionScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/cursors/index.js"),m=n("./tools/segmentation/strategies/index.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"CorrectionScissors",strategies:{CORRECTION:m.correction},cursors:{CORRECTION:f.freehandFillInsideCursor},defaultStrategy:"CORRECTION",supportedInteractionTypes:["Mouse","Touch"],svgCursor:f.freehandFillInsideCursor,mixins:["polylineSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/FreehandScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/cursors/index.js"),f=n("./tools/segmentation/strategies/index.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"FreehandScissors",strategies:{FILL_INSIDE:f.fillInsideFreehand,FILL_OUTSIDE:f.fillOutsideFreehand,ERASE_OUTSIDE:f.eraseOutsideFreehand,ERASE_INSIDE:f.eraseInsideFreehand},cursors:{FILL_INSIDE:c.freehandFillInsideCursor,FILL_OUTSIDE:c.freehandFillOutsideCursor,ERASE_OUTSIDE:c.freehandEraseOutsideCursor,ERASE_INSIDE:c.freehandEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:c.freehandFillInsideCursor,mixins:["freehandSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(n("./tools/base/index.js").BaseTool)},"./tools/segmentation/RectangleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/segmentation/strategies/index.js"),m=n("./tools/cursors/index.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"RectangleScissors",strategies:{FILL_INSIDE:f.fillInsideRectangle,FILL_OUTSIDE:f.fillOutsideRectangle,ERASE_OUTSIDE:f.eraseOutsideRectangle,ERASE_INSIDE:f.eraseInsideRectangle},cursors:{FILL_INSIDE:m.segRectangleFillInsideCursor,FILL_OUTSIDE:m.segRectangleFillOutsideCursor,ERASE_OUTSIDE:m.segRectangleEraseOutsideCursor,ERASE_INSIDE:m.segRectangleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],mixins:["rectangleSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/SphericalBrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(m),h=n("./externalModules.js"),v=n("./tools/base/BaseBrushTool.js"),p=n("./store/index.js"),b=n("./util/segmentation/index.js"),y=n("./stateManagement/toolState.js"),x=n("./util/logger.js"),j=Object(x.getLogger)("tools:SphericalBrushTool"),w=Object(p.getModule)("segmentation"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"SphericalBrush",supportedInteractionTypes:["Mouse","Touch"],configuration:{alwaysEraseOnClick:!1},mixins:["renderBrushMixin"]};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._paint.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_startPainting",value:function(e){var t,n=w.configuration,a=w.getters,r=e.detail,o=r.element,i=r.image,s=h.default.cornerstone,l=n.radius,u=i.rows,d=i.columns,c=Math.max(i.rowPixelSpacing,i.columnPixelSpacing),f=Object(y.getToolState)(o,"stack").data[0].imageIds,m=a.labelmap2D(o),g=m.labelmap2D,v=m.labelmap3D,p=m.currentImageIdIndex,b=m.activeLabelmapIndex,x=this._isCtrlDown(r)||this.configuration.alwaysEraseOnClick,T=s.metaData.get("imagePlaneModule",i.imageId);if(T?t=this._getImagesInRange(p,T.imagePositionPatient,f,l,c):(j.warn("No imagePlane metadata found for image, defaulting to circle brush application."),t=[{imageIdIndex:p,radiusOnImage:l}]),this.paintEventData={labelmap2D:g,labelmap3D:v,currentImageIdIndex:p,activeLabelmapIndex:b,shouldErase:x,imagesInRange:t},n.storeHistory){for(var E=[],O=0;O<t.length;O++){var C=a.labelmap2DByImageIdIndex(v,t[O].imageIdIndex,u,d).pixelData.slice();E.push(C)}this.paintEventData.previousPixeldataForImagesInRange=E}}},{key:"_paint",value:function(e){var t=w.getters,n=e.detail,a=n.image,r=a.rows,o=a.columns,i=n.currentPoints.image,s=i.x,l=i.y;if(!(s<0||s>o||l<0||l>r)){for(var u=this.paintEventData,d=u.labelmap3D,c=u.imagesInRange,f=u.shouldErase,m=0;m<c.length;m++){var g=c[m],v=g.imageIdIndex,p=g.radiusOnImage,y=Object(b.getCircle)(p,r,o,s,l),x=t.labelmap2DByImageIdIndex(d,v,r,o);Object(b.drawBrushPixels)(y,x.pixelData,d.activeSegmentIndex,o,f)}h.default.cornerstone.updateImage(e.detail.element)}}},{key:"_getImagesInRange",value:function(e,t,n,a,r){for(var o=a*r,i=[{imageIdIndex:e,radiusOnImage:a}],s=e+1;s<n.length;s++){var l=this._getRadiusOnImage(n[s],t,o,r);if(!l)break;i.push({imageIdIndex:s,radiusOnImage:l})}for(var u=e-1;u>=0;u--){var d=this._getRadiusOnImage(n[u],t,o,r);if(!d)break;i.push({imageIdIndex:u,radiusOnImage:d})}return i}},{key:"_getRadiusOnImage",value:function(e,t,n,a){var r=h.default.cornerstone.metaData.get("imagePlaneModule",e);if(r){var o=r.imagePositionPatient,i=Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2));if(!(i>n))return Math.floor(Math.sqrt(Math.pow(n,2)-Math.pow(i,2))/a)}else j.warn("Can't find imagePlane metadata for image, cancelling spherical brushing on: ".concat(e,","))}},{key:"_endPainting",value:function(e){for(var t=this.paintEventData,n=t.labelmap3D,a=t.imagesInRange,r=[],o=w.configuration,i=w.setters,s=0;s<a.length;s++){for(var l=a[s].imageIdIndex,u=n.labelmaps2D[l],d=new Set(u.pixelData).values(),c=[],f=!1;!f;){var m=d.next();(f=m.done)||c.push(m.value)}if(u.segmentsOnLabelmap=c,o.storeHistory){var g=this.paintEventData.previousPixeldataForImagesInRange[s],h=n.labelmaps2D[l].pixelData;r.push({imageIdIndex:l,diff:Object(b.getDiffBetweenPixelData)(g,h)})}}o.storeHistory&&i.pushState(this.element,r),Object(b.triggerLabelmapModifiedEvent)(this.element)}}]),t}(v.default)},"./tools/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/segmentation/BrushTool.js"),r=n("./tools/segmentation/SphericalBrushTool.js"),o=n("./tools/segmentation/FreehandScissorsTool.js"),i=n("./tools/segmentation/RectangleScissorsTool.js"),s=n("./tools/segmentation/CircleScissorsTool.js"),l=n("./tools/segmentation/CorrectionScissorsTool.js");n.d(t,"BrushTool",function(){return a.default}),n.d(t,"SphericalBrushTool",function(){return r.default}),n.d(t,"FreehandScissorsTool",function(){return o.default}),n.d(t,"RectangleScissorsTool",function(){return i.default}),n.d(t,"CircleScissorsTool",function(){return s.default}),n.d(t,"CorrectionScissorsTool",function(){return l.default}),t.default={BrushTool:a.default,SphericalBrushTool:r.default,CircleScissorsTool:s.default,CorrectionScissorsTool:l.default,FreehandScissorsTool:o.default,RectangleScissorsTool:i.default}},"./tools/segmentation/strategies/correction.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return c});var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./tools/segmentation/strategies/index.js"),i=n("./util/segmentation/index.js"),s=n("./util/clip.js"),l=n("./util/isPointInImage.js"),u=n("./util/logger.js"),d=Object(u.getLogger)("util:segmentation:operations:correction");function c(e,t){var n=t.pixelData,a=t.segmentIndex,u=t.segmentationMixinType;if("freehandSegmentationMixin"===u){var c=function(e,t){for(var n=t.pixelData,a=t.points,r=e.detail.image,o=r.width,i=r.height,l=[],u=0;u<a.length;u++){var d=a[u],c=Math.floor(d.x),f=Math.floor(d.y);c=Object(s.default)(c,0,o-1),f=Object(s.default)(f,0,i-1);var m=l[l.length-1];m&&c===m.x&&f===m.y||l.push({x:c,y:f,segment:n[f*o+c]})}return l}(e,t),g=function(e,t){for(var n=!0,a=!0,r=0;r<e.length&&(e[r].segment===t?a=!1:n=!1,n||a);r++);return a?{isScissorOperation:!0,operation:"fillInsideFreehand"}:n?{isScissorOperation:!0,operation:"eraseInsideFreehand"}:{isScissorOperation:!1}}(c,a);if(g.isScissorOperation)"fillInsideFreehand"===g.operation?(d.warn("The line never intersects a segment."),Object(o.fillInsideFreehand)(e,t)):"eraseInsideFreehand"===g.operation&&(d.warn("The line is only ever inside the segment."),Object(o.eraseInsideFreehand)(e,t));else{var h=new Uint8Array(n.length);(function(e,t){var n=e[0].segment===t,a=[];a.push({additive:!n,nodes:[]});for(var r=0,o=0;o<e.length;o++){var i=e[o];n?(a[r].nodes.push(i),i.segment!==t&&(r++,n=!n,a.push({additive:!0,nodes:[]}),a[r].nodes.push(e[o-1]),a[r].nodes.push(i))):(a[r].nodes.push(i),i.segment===t&&(r++,n=!n,a.push({additive:!1,nodes:[]}),a[r].nodes.push(e[o-1]),a[r].nodes.push(i)))}return a.pop(),a.shift(),a})(c,a).forEach(function(t){!function(e,t,n,a,o){var s=o.detail.image,u=s.width,c=s.height,g=e.nodes,h=e.additive,v=h?0:1,p=function(e){return e.y*u+e.x},b=function(e){return{x:e%u,y:Math.floor(e/u)}};d.warn(h?"additive operation...":"subtractive operation...");for(var y=function(e){for(var t=[],n=0;n<e.length-1;n++)t.push(e[n]),t.push.apply(t,r()(Object(i.getPixelPathBetweenPixels)(e[n],e[n+1])));for(var a=[],o=[],s=0;s<t.length-1;s++){var l=(void 0,-1===(m={x:(f=t[s+1]).x-(c=t[s]).x,y:f.y-c.y}).x&&1===m.y?{left:{x:c.x-1,y:c.y-1},right:{x:c.x+1,y:c.y+1}}:0===m.x&&1===m.y?{left:{x:c.x-1,y:c.y},right:{x:c.x+1,y:c.y}}:1===m.x&&1===m.y?{left:{x:c.x-1,y:c.y+1},right:{x:c.x+1,y:c.y-1}}:1===m.x&&0===m.y?{left:{x:c.x,y:c.y+1},right:{x:c.x,y:c.y-1}}:1===m.x&&-1===m.y?{left:{x:c.x+1,y:c.y+1},right:{x:c.x-1,y:c.y-1}}:0===m.x&&-1===m.y?{left:{x:c.x+1,y:c.y},right:{x:c.x-1,y:c.y}}:-1===m.x&&-1===m.y?{left:{x:c.x+1,y:c.y-1},right:{x:c.x-1,y:c.y+1}}:-1===m.x&&0===m.y?{left:{x:c.x,y:c.y-1},right:{x:c.x,y:c.y+1}}:void d.error("Unable to find left and right paths for flood fill ",c,f,m)),u=l.right;a.push(l.left),o.push(u)}var c,f,m;return{pixelPath:t,leftPath:a,rightPath:o}}(g),x=y.pixelPath,j=y.leftPath,w=y.rightPath,T=x[0],E={xMin:T.x,xMax:T.x,yMin:T.y,yMax:T.y},O=0;O<n.length;O++)t[O]===a?(f(E,b(O)),n[O]=1):n[O]=0;for(var C=0;C<x.length;C++){var M=x[C];n[p(M)]=2,f(E,M)}!function(e,t,n){e.xMax=Math.min(e.xMax+2,n),e.xMin=Math.max(e.xMin-2,0),e.yMax=Math.min(e.yMax+2,t),e.yMin=Math.max(e.yMin-2,0)}(E,c,u);var I=E.xMin,S=E.xMax,P=E.yMin,D=E.yMax;function _(e,t){if(!(e>=S||e<I||t>=D||t<P))return n[t*u+e]}for(var L=0,k=0,A=0;A<j.length;A++){var R=j[A];n[p(R)]===v&&Object(l.default)(R,c,u)&&(L+=m(R,3,n,_,u));var B=w[A];n[p(B)]===v&&Object(l.default)(B,c,u)&&(k+=m(B,4,n,_,u))}if(0!==L&&0!==k){for(var H=h?a:0,F=L<k?3:4,U=0;U<n.length;U++)n[U]===F&&(t[U]=H);if(H===a)for(var N=0;N<x.length;N++)t[p(x[N])]=a;else for(var V=0;V<x.length;V++){var z=p(x[V]);t[z]===a&&(t[z]=0)}}}(t,n,h,a,e)})}}else d.error("correction operation requires freehandSegmentationMixin operationData, recieved ".concat(u))}function f(e,t){var n=t.x,a=t.y;n<e.xMin&&(e.xMin=n),n>e.xMax&&(e.xMax=n),a<e.yMin&&(e.yMin=a),a>e.yMax&&(e.yMax=a)}function m(e,t,n,a,r){for(var o=Object(i.floodFill)(a,[e.x,e.y]).flooded,s=0;s<o.length;s++){var l=o[s];n[l[1]*r+l[0]]=t}return o.length}},"./tools/segmentation/strategies/eraseCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideCircle",function(){return c}),n.d(t,"eraseOutsideCircle",function(){return f});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/ellipse/index.js"),i=n("./util/logger.js"),s=n("./util/segmentation/index.js"),l=n("./util/getCircleCoords.js"),u=Object(i.getLogger)("util:segmentation:operations:eraseInsideCircle");function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.segmentationMixinType;if("circleSegmentationMixin"===a){var i=e.detail,d=Object(s.getBoundingBoxAroundCircle)(e),c=r()(d,2),f=c[0],m=c[1],g=Object(l.default)(i.handles.start,i.handles.end);n?Object(s.eraseInsideShape)(e,t,function(e){return Object(o.pointInEllipse)(g,e)},f,m):Object(s.eraseOutsideShape)(e,t,function(e){return Object(o.pointInEllipse)(g,e)},f,m)}else u.error("eraseInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(a))}function c(e,t){d(e,t,!0)}function f(e,t){d(e,t,!1)}},"./tools/segmentation/strategies/eraseFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideFreehand",function(){return d}),n.d(t,"eraseOutsideFreehand",function(){return c});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/isPointInPolygon.js"),s=n("./util/logger.js"),l=Object(s.getLogger)("util:segmentation:operations:eraseInsideFreehand");function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,s=t.segmentationMixinType;if("freehandSegmentationMixin"===s){var u=e.detail.image,d=a.map(function(e){return[e.x,e.y]}),c=Object(o.getBoundingBoxAroundPolygon)(d,u),f=r()(c,2),m=f[0],g=f[1];n?Object(o.eraseInsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},m,g):Object(o.eraseOutsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},m,g)}else l.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(s))}function d(e,t){u(e,t,!0)}function c(e,t){u(e,t,!1)}},"./tools/segmentation/strategies/eraseRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideRectangle",function(){return u}),n.d(t,"eraseOutsideRectangle",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/logger.js"),i=n("./util/segmentation/index.js"),s=Object(o.getLogger)("util:segmentation:operations:eraseInsideRectangle");function l(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,o=t.segmentationMixinType;if("rectangleSegmentationMixin"===o){var l=e.detail,u=l.image,d=a.map(function(e){return[e.x,e.y]}),c=Object(i.getBoundingBoxAroundPolygon)(d,u),f=r()(c,2),m=f[0],g=f[1];n?Object(i.eraseInsideShape)(e,t,function(){return!0},m,g):Object(i.eraseOutsideBoundingBox)(e,t,m,g)}else s.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(o))}function u(e,t){l(e,t,!0)}function d(e,t){l(e,t,!1)}},"./tools/segmentation/strategies/fillCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideCircle",function(){return c}),n.d(t,"fillOutsideCircle",function(){return f});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/ellipse/index.js"),s=n("./util/getCircleCoords.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("util:segmentation:operations:fillCircle");function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.segmentationMixinType;if("circleSegmentationMixin"===a){var l=e.detail,d=Object(o.getBoundingBoxAroundCircle)(e),c=r()(d,2),f=c[0],m=c[1],g=Object(s.default)(l.handles.start,l.handles.end);n?Object(o.fillInsideShape)(e,t,function(e){return Object(i.pointInEllipse)(g,e)},f,m):Object(o.fillOutsideShape)(e,t,function(e){return Object(i.pointInEllipse)(g,e)},f,m)}else u.error("fillInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(a))}function c(e,t){d(e,t,!0)}function f(e,t){d(e,t,!1)}},"./tools/segmentation/strategies/fillFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideFreehand",function(){return d}),n.d(t,"fillOutsideFreehand",function(){return c});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/isPointInPolygon.js"),s=n("./util/logger.js"),l=Object(s.getLogger)("util:segmentation:operations:fillInsideFreehand");function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,s=t.segmentationMixinType;if("freehandSegmentationMixin"===s){var u=e.detail.image,d=a.map(function(e){return[e.x,e.y]}),c=Object(o.getBoundingBoxAroundPolygon)(d,u),f=r()(c,2),m=f[0],g=f[1];n?Object(o.fillInsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},m,g):Object(o.fillOutsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},m,g)}else l.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(s))}function d(e,t){u(e,t,!0)}function c(e,t){u(e,t,!1)}},"./tools/segmentation/strategies/fillRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideRectangle",function(){return u}),n.d(t,"fillOutsideRectangle",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("util:segmentation:operations:fillInsideRectangle");function l(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,i=t.segmentationMixinType;if("rectangleSegmentationMixin"===i){var l=e.detail.image,u=a.map(function(e){return[e.x,e.y]}),d=Object(o.getBoundingBoxAroundPolygon)(u,l),c=r()(d,2),f=c[0],m=c[1];n?Object(o.fillInsideShape)(e,t,function(){return!0},f,m):Object(o.fillOutsideBoundingBox)(e,t,f,m)}else s.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(i))}function u(e,t){l(e,t,!0)}function d(e,t){l(e,t,!1)}},"./tools/segmentation/strategies/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/segmentation/strategies/correction.js");n.d(t,"correction",function(){return a.default});var r=n("./tools/segmentation/strategies/eraseFreehand.js");n.d(t,"eraseInsideFreehand",function(){return r.eraseInsideFreehand}),n.d(t,"eraseOutsideFreehand",function(){return r.eraseOutsideFreehand});var o=n("./tools/segmentation/strategies/eraseRectangle.js");n.d(t,"eraseInsideRectangle",function(){return o.eraseInsideRectangle}),n.d(t,"eraseOutsideRectangle",function(){return o.eraseOutsideRectangle});var i=n("./tools/segmentation/strategies/fillFreehand.js");n.d(t,"fillInsideFreehand",function(){return i.fillInsideFreehand}),n.d(t,"fillOutsideFreehand",function(){return i.fillOutsideFreehand});var s=n("./tools/segmentation/strategies/fillRectangle.js");n.d(t,"fillInsideRectangle",function(){return s.fillInsideRectangle}),n.d(t,"fillOutsideRectangle",function(){return s.fillOutsideRectangle});var l=n("./tools/segmentation/strategies/fillCircle.js");n.d(t,"fillInsideCircle",function(){return l.fillInsideCircle}),n.d(t,"fillOutsideCircle",function(){return l.fillOutsideCircle});var u=n("./tools/segmentation/strategies/eraseCircle.js");n.d(t,"eraseInsideCircle",function(){return u.eraseInsideCircle}),n.d(t,"eraseOutsideCircle",function(){return u.eraseOutsideCircle})},"./util/SaveAs.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=e.querySelector("canvas");if(a.msToBlob){var r=a.msToBlob();return window.navigator.msSaveBlob(r,t)}var o=document.createElement("a");if(o.download=t,o.href=a.toDataURL(n,1),document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(i)}else o.fireEvent&&o.fireEvent("onclick")}},"./util/angleBetweenPoints.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),o=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));return{angle:180*Math.acos((Math.pow(a,2)+Math.pow(r,2)-Math.pow(o,2))/(2*a*r))/Math.PI,direction:(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)}}},"./util/calculateSUV.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");function r(e){return parseFloat(".".concat(e))}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=a.default.cornerstone,i=o.metaData.get("patientStudyModule",e.imageId),s=o.metaData.get("generalSeriesModule",e.imageId);if(i&&s){var l=s.modality;if("PT"===l){var u=n?t:t*e.slope+e.intercept,d=i.patientWeight;if(d){var c=o.metaData.get("petIsotopeModule",e.imageId);if(c){var f=c.radiopharmaceuticalInfo,m=f.radiopharmaceuticalStartTime,g=f.radionuclideTotalDose,h=f.radionuclideHalfLife,v=s.seriesTime;if(m&&g&&h&&v){var p=r(v.fractionalSeconds||0)+v.seconds+60*v.minutes+60*v.hours*60,b=r(m.fractionalSeconds||0)+m.seconds+60*m.minutes+60*m.hours*60,y=p-b,x=g*Math.exp(-y*Math.log(2)/h),j=u*d/x*1e3;return j}}}}}}},"./util/clip.js":function(e,t,n){"use strict";function a(e,t,n){return Math.min(Math.max(t,e),n)}function r(e,t){e.x=a(e.x,0,t.width),e.y=a(e.y,0,t.height)}n.r(t),n.d(t,"clip",function(){return a}),n.d(t,"clipToBox",function(){return r}),t.default=a},"./util/convertToVector3.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./externalModules.js");function r(e){var t=a.default.cornerstoneMath;if(e instanceof t.Vector3)return e;var n=Object.keys(e);return n.includes("x")&&n.includes("y")&&n.includes("z")?new t.Vector3(e.x,e.y,e.z):new t.Vector3(e[0],e[1],e[2])}},"./util/copyPoints.js":function(e,t,n){"use strict";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,n=e.y;return{x:t,y:n}}n.r(t),t.default=function(e){return{page:a(e.page),image:a(e.image),client:a(e.client),canvas:a(e.canvas)}}},"./util/debounce.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/isObject.js");t.default=function(e,t,n){var r,o,i,s,l,u,d=0,c=!1,f=!1,m=!0,g=!t&&0!==t&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=r,a=o;return r=o=void 0,d=t,s=e.apply(a,n)}function v(e,t){return g?window.requestAnimationFrame(e):setTimeout(e,t)}function p(e){return d=e,l=v(y,t),c?h(e):s}function b(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-d>=i}function y(){var e=Date.now();if(b(e))return x(e);l=v(y,function(e){var n=t-(e-u);return f?Math.min(n,i-(e-d)):n}(e))}function x(e){return l=void 0,m&&r?h(e):(r=o=void 0,s)}function j(){for(var e=Date.now(),n=b(e),a=arguments.length,i=new Array(a),d=0;d<a;d++)i[d]=arguments[d];if(r=i,o=this,u=e,n){if(void 0===l)return p(u);if(f)return l=v(y,t),h(u)}return void 0===l&&(l=v(y,t)),s}return t=Number(t)||0,Object(a.default)(n)&&(c=Boolean(n.leading),i=(f="maxWait"in n)?Math.max(Number(n.maxWait)||0,t):i,m="trailing"in n?Boolean(n.trailing):m),j.cancel=function(){void 0!==l&&function(e){if(g)return window.cancelAnimationFrame(e);clearTimeout(e)}(l),d=0,r=u=o=l=void 0},j.flush=function(){return void 0===l?s:x(Date.now())},j.pending=function(){return void 0!==l},j}},"./util/debugLib/common.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a);t.default=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return a.colors[Math.abs(t)%a.colors.length]}function a(e){var n;function r(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];if(r.enabled){var i=r,s=Number(new Date),l=s-(n||s);i.diff=l,i.prev=n,i.curr=s,n=s,t[0]=a.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;u++;var r=a.formatters[n];return"function"==typeof r&&(e=r.call(i,t[u]),t.splice(u,1),u--),e}),a.formatArgs.call(i,t);var d=i.log||a.log;d.apply(i,t)}}return r.namespace=e,r.enabled=a.enabled(e),r.useColors=a.useColors(),r.color=t(e),r.destroy=o,r.extend=i,"function"==typeof a.init&&a.init(r),a.instances.push(r),r}function o(){var e=a.instances.indexOf(this);return-1!==e&&(a.instances.splice(e,1),!0)}function i(e,t){var n=a(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){var e=[].concat(r()(a.names.map(s)),r()(a.skips.map(s).map(function(e){return"-".concat(e)}))).join(",");return a.enable(""),e},a.enable=function(e){var t;a.save(e),a.names=[],a.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^".concat(e.substr(1),"$"))):a.names.push(new RegExp("^".concat(e,"$"))));for(t=0;t<a.instances.length;t++){var o=a.instances[t];o.enabled=a.enabled(o.namespace)}},a.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=n("../node_modules/ms/index.js"),Object.keys(e).forEach(function(t){a[t]=e[t]}),a.instances=[],a.names=[],a.skips=[],a.formatters={},a.selectColor=t,a.enable(a.load()),a}},"./util/debugLib/index.js":function(e,t,n){"use strict";n.r(t),(function(e){var a=n("./util/debugLib/common.js"),r={formatArgs:function(e){if(e[0]="".concat((this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" "),"+").concat(o.humanize(this.diff)),this.useColors){var t="color: ".concat(this.color);e.splice(1,0,t,"color: inherit");var n=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(a=n))}),e.splice(a,0,t)}},save:function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(t){}},load:function(){var t;try{t=r.storage.getItem("debug")}catch(n){console.warn(n)}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},useColors:function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},storage:function(){try{return localStorage}catch(e){}}(),colors:["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"]};r.log=console.debug||console.log||function(){};var o=Object(a.default)(r);o.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: ".concat(t.message)}},t.default=o}).call(this,n("../node_modules/process/browser.js"))},"./util/deepmerge.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=function(e){return e&&"object"===r()(e)&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)},i=function(e,t){return t&&!0===t.clone&&o(e)?u(Array.isArray(e)?[]:{},e,t):e},s=function(e,t,n){var a=e.slice();return t.forEach(function(t,r){void 0===a[r]?a[r]=i(t,n):o(t)?a[r]=u(e[r],t,n):-1===e.indexOf(t)&&a.push(i(t,n))}),a},l=function(e,t,n){var a={};return o(e)&&Object.keys(e).forEach(function(t){a[t]=i(e[t],n)}),Object.keys(t).forEach(function(r){a[r]=o(t[r])&&e[r]?u(e[r],t[r],n):i(t[r],n)}),a},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=Array.isArray(t),r=n||{arrayMerge:s},o=r.arrayMerge||s;return a?Array.isArray(e)?o(e,t,n):i(t,n):l(e,t,n)};t.default=u},"./util/ellipse/calculateEllipseStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/pointInEllipse.js");t.default=function(e,t){for(var n=0,r=0,o=0,i=0,s=null,l=null,u=t.top;u<t.top+t.height;u++)for(var d=t.left;d<t.left+t.width;d++){var c={x:d,y:u};Object(a.default)(t,c)&&(null===s&&(s=e[i],l=e[i]),n+=e[i],r+=e[i]*e[i],s=Math.min(s,e[i]),l=Math.max(l,e[i]),o++),i++}if(0===o)return{count:o,mean:0,variance:0,stdDev:0,min:0,max:0};var f=n/o,m=r/o-f*f;return{count:o,mean:f,variance:m,stdDev:Math.sqrt(m),min:s,max:l}}},"./util/ellipse/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/calculateEllipseStatistics.js");n.d(t,"calculateEllipseStatistics",function(){return a.default});var r=n("./util/ellipse/pointInEllipse.js");n.d(t,"pointInEllipse",function(){return r.default}),t.default={calculateEllipseStatistics:a.default,pointInEllipse:r.default}},"./util/ellipse/pointInEllipse.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.width/2,a=e.height/2;if(n<=0||a<=0)return!1;var r=t.x-(e.left+n),o=t.y-(e.top+a);return r*r/(n*n)+o*o/(a*a)<=1}},"./util/findAndMoveHelpers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"moveHandleNearImagePoint",function(){return i}),n.d(t,"findHandleDataNearImagePoint",function(){return s}),n.d(t,"moveAnnotation",function(){return l});var a=n("./store/index.js"),r=n("./manipulators/getHandleNearImagePoint.js"),o=n("./manipulators/index.js"),i=function(e,t,n,r,i){n.active=!0,a.state.isToolLocked=!0,Object(o.moveHandle)(e.detail,t.name,n,r,t.options,i),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()},s=function(e,t,n,o){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"mouse",s=0;s<t.data.length;s++){var l=t.data[s],u=Object(r.default)(e,l.handles,o,"mouse"===i?a.state.clickProximity:a.state.touchProximity);if(u)return{handle:u,data:l}}},l=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";n.active=!0,a.state.isToolLocked=!0,Object(o.moveAllHandles)(e.detail,t.name,n,null,t.options,r,function(){n.active=!1,a.state.isToolLocked=!1}),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./util/freehand/ClickedLineData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=function e(t,n){r()(this,e),this.toolIndex=t,this.handleIndexArray=n}},"./util/freehand/FreehandHandleData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r()(this,e),this.x=t.x,this.y=t.y,this.highlight=n,this.active=a,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./stateManagement/toolState.js"),l=n("./externalModules.js"),u=n("./util/freehand/ClickedLineData.js"),d=function(){function e(t,n){r()(this,e),this._eventData=t,this._toolName=n}return i()(e,[{key:"findLine",value:function(){var e=this.findTool();if(null===e)return null;var t=this._getCloseLinesInTool(e);return t?this._findCorrectLine(e,t):null}},{key:"findTool",value:function(){return this._toolData=Object(s.getToolState)(this._eventData.element,this._toolName),this._mousePoint=this._eventData.currentPoints.canvas,this._toolData?this._nearestHandleToPointAllTools().toolIndex:null}},{key:"_nearestHandleToPointAllTools",value:function(){for(var e=this._toolData,t={toolIndex:null,handleIndex:null,distance:1/0},n=0;n<e.data.length;n++){var a=this._nearestHandleToPoint(n);null!==a&&a.distance<t.distance&&(t=a)}return t}},{key:"_nearestHandleToPoint",value:function(e){var t=this._eventData,n=this._toolData.data[e],a=n.handles.points;if(void 0===a)return null;if(!1===n.visible)return null;for(var r={toolIndex:e,handleIndex:null,distance:1/0},o=0;o<a.length;o++){var i=l.default.cornerstone.pixelToCanvas(t.element,a[o]),s=l.default.cornerstoneMath.point.distance(i,this._mousePoint);s<r.distance&&(r.handleIndex=o,r.distance=s)}return r}},{key:"_getCloseLinesInTool",value:function(t){for(var n=this._toolData.data[t].handles.points,a=[],r=0;r<n.length;r++){var o=e.getNextHandleIndex(r,n.length);this._distanceOfPointfromLine(n[r],n[o])<10&&a.push([r,o])}return a}},{key:"_findCorrectLine",value:function(e,t){for(var n=0;n<t.length;n++)if(this._pointProjectsToLineSegment(e,t[n]))return new u.default(e,t[n]);return null}},{key:"_pointProjectsToLineSegment",value:function(t,n){var a=this._toolData.data[t],r=a.handles.points;if(void 0!==a.handles.points){if(!1===a.visible)return!1;var o=e.getCanvasPointsFromHandles(r[n[0]],r[n[1]],this._eventData.element),i=e.getLineAsVector(o),s=this._getLineOriginToMouseAsVector(o),l=(s[0]*i[0]+s[1]*i[1])/i.magnitude;return l>0&&l<i.magnitude}}},{key:"_getLineOriginToMouseAsVector",value:function(e){return[this._mousePoint.x-e[0].x,this._mousePoint.y-e[0].y]}},{key:"_distanceOfPointfromLine",value:function(e,t){var n=this._eventData,a=l.default.cornerstone.pixelToCanvas(n.element,e),r=l.default.cornerstone.pixelToCanvas(n.element,t),o=this._mousePoint;return Math.abs((r.y-a.y)*o.x-(r.x-a.x)*o.y+r.x*a.y-r.y*a.x)/l.default.cornerstoneMath.point.distance(a,r)}}],[{key:"getCanvasPointsFromHandles",value:function(e,t,n){var a=[];return e.x<t.x?(a.push(l.default.cornerstone.pixelToCanvas(n,e)),a.push(l.default.cornerstone.pixelToCanvas(n,t))):(a.push(l.default.cornerstone.pixelToCanvas(n,t)),a.push(l.default.cornerstone.pixelToCanvas(n,e))),a}},{key:"getLineAsVector",value:function(e){var t=[e[1].x-e[0].x,e[1].y-e[0].y];return t.magnitude=l.default.cornerstoneMath.point.distance(e[0],e[1]),t}},{key:"getNextHandleIndex",value:function(e,t){return e<t-1?e+1:0}}]),e}()},"./util/freehand/addLine.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e[t].lines.push(t===e.length-1?e[0]:e[t+1])}},"./util/freehand/calculateFreehandStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/pointInFreehand.js");function r(e,t,n,r){Object(a.default)(e,t)&&(n.value+=r,n.squared+=r*r,n.count++)}t.default=function(e,t,n){var a={count:0,mean:0,variance:0,stdDev:0},o=function(e,t,n){for(var a={value:0,squared:0,count:0},o=0,i=t.top;i<t.top+t.height;i++)for(var s=t.left;s<t.left+t.width;s++)r(n,{x:s,y:i},a,e[o]),o++;return a}(e,t,n);return 0===o.count||(a.count=o.count,a.mean=o.value/o.count,a.variance=o.squared/o.count-a.mean*a.mean,a.stdDev=Math.sqrt(a.variance)),a}},"./util/freehand/freehandArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=0,a=e.length-1;t=t||1;for(var r=0;r<e.length;r++)n+=(e[a].x+e[r].x)*(e[a].y-e[r].y),a=r;return Math.abs(n*t/2)}},"./util/freehand/freehandIntersect.js":function(e,t,n){"use strict";function a(e,t,n,a){for(var i=e.length-1,s=0;s<e.length;s++)if(-1===a.indexOf(s)&&-1===a.indexOf(i)){if(r(t,n,o(e[i]),o(e[s])))return!0;i=s}else i=s;return!1}function r(e,t,n,a){var r=!1,o=[i(e,t,n),i(e,t,a),i(n,a,e),i(n,a,t)];return o[0]!==o[1]&&o[2]!==o[3]||((0===o[0]&&s(e,n,t)||0===o[1]&&s(e,a,t)||0===o[2]&&s(n,e,a)||0===o[3]&&s(n,t,a))&&(r=!0),r)}function o(e){return{x:e.x,y:e.y}}function i(e,t,n){var a=(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y);return 0===a?0:a>0?1:2}function s(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}n.r(t),t.default={newHandle:function(e,t){var n=t.length-1;return a(t,o(t[n]),o(e),[n])},end:function(e){var t=e.length-1;return a(e,o(e[t]),o(e[0]),[t,0])},modify:function(e,t){var n=o(e[t]),r=t-1;0===t&&(r=e.length-1);var i=o(e[r]);return!!a(e,n,i,[t,r])||a(e,n,i=o(e[r=t===e.length-1?0:t+1]),[t,r])}}},"./util/freehand/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/calculateFreehandStatistics.js"),r=n("./util/freehand/ClickedLineData.js"),o=n("./util/freehand/freehandArea.js"),i=n("./util/freehand/FreehandHandleData.js"),s=n("./util/freehand/freehandIntersect.js"),l=n("./util/freehand/FreehandLineFinder.js"),u=n("./util/freehand/insertOrDelete.js"),d=n("./util/freehand/pointInFreehand.js"),c=n("./util/freehand/addLine.js");t.default={calculateFreehandStatistics:a.default,ClickedLineData:r.default,freehandArea:o.default,FreehandHandleData:i.default,freehandIntersect:s.default,FreehandLineFinder:l.default,insertOrDelete:u.default,pointInFreehand:d.default,addLine:c.default}},"./util/freehand/insertOrDelete.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/FreehandLineFinder.js"),r=n("./util/freehand/FreehandHandleData.js"),o=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),s=n("./util/freehand/addLine.js");function l(e,t){var n=Object(o.getToolState)(e.element,this.name);if(void 0!==n){var a=t.handleIndex,r=n.data[t.toolIndex],s=r.handles.points;s.length<=3||(a===s.length-1?(s[a-1].lines.pop(),s[a-1].lines.push(s[0])):0===a?(s[s.length-1].lines.pop(),s[s.length-1].lines.push(s[a+1])):(s[a-1].lines.pop(),s[a-1].lines.push(s[a+1])),s.splice(a,1),r.invalidated=!0,r.active=!0,r.highlight=!0,i.default.cornerstone.updateImage(e.element))}}function u(e,t){var n=Object(o.getToolState)(e.element,this.name);if(void 0!==n){var a=n.data[t.toolIndex],l=function(e){for(var t=e.handleIndexArray,n=1/0,a=t.includes(0),r=0;r<t.length;r++){var o=t[r];0!==o&&o<n&&(n=o)}return a&&1===n&&(n=0),++n}(t);if(l!==1/0){var u=new r.default(e.currentPoints.image),d=a.handles.points;d.splice(l,0,u),d[l-1].lines.pop(),d[l-1].lines.push(e.currentPoints.image),Object(s.default)(d,l),a.active=!0,a.highlight=!0,a.invalidated=!0,i.default.cornerstone.updateImage(e.element)}}}t.default=function(e,t){var n=e.detail;if(t&&null!==t.handleNearby)l.call(this,n,{toolIndex:t.toolIndex,handleIndex:t.handleNearby});else{var r=new a.default(n,this.name).findLine();r&&u.call(this,n,r)}}},"./util/freehand/pointInFreehand.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){for(var n=!1,a=e.length-1,r=0;r<e.length;r++)void 0,void 0,void 0,d=(s=e[a]).y,!((u=(i=e[r]).y)<(l=(o=t).y)&&l<d||d<l&&l<u)||!function(e,t,n){if(t.x>e.x&&n.x>e.x)return!0;if(t.x===n.x)return e.x<t.x;if(t.x>n.x){var a=t;t=n,n=a}var r=function(e,t,n){var a=(n.y-t.y)/(n.x-t.x);return{value:t.y+a*(e.x-t.x),gradient:a}}(e,t,n);return Math.sign(r.gradient)*e.y>Math.sign(r.gradient)*r.value}(o,i,s)||(n=!n),a=r;var o,i,s,l,u,d;return n}},"./util/getActiveTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");function i(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";if("touch"===i?n=(n=Object(r.default)(e,a.getters.touchTools())).filter(function(e){return e.options.isTouchActive}):(n=(n=Object(r.default)(e,a.getters.mouseTools())).filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&t&&e.options.mouseButtonMask.includes(t)&&e.options.isMouseActive}),a.state.isMultiPartToolActive&&(n=Object(o.default)(n))),0!==n.length)return n[0]}},"./util/getCircleCoords.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./externalModules.js");function r(e,t){var n=(0,a.default.cornerstoneMath.point.distance)(e,t);return{left:Math.floor(Math.min(e.x-n,t.x)),top:Math.floor(Math.min(e.y-n,t.y)),width:2*n,height:2*n}}},"./util/getDefault.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return void 0===e?t:e}},"./util/getKeyPressData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./store/index.js"),r=n("./externalModules.js");function o(e){var t=r.default.cornerstone,n=e.currentTarget,o=t.getEnabledElement(n);if(o&&o.image){var i=a.default.state.mousePositionImage;return{event:window.event||e,element:n,viewport:t.getViewport(n),image:o.image,currentPoints:{image:i,canvas:t.pixelToCanvas(n,i)},keyCode:e.keyCode,which:e.which}}}},"./util/getLuminance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r,o){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,s,l,u=a.default.cornerstone.getEnabledElement(e).image,d=[],c=0,f=u.getPixelData();if(u.color)for(s=0;s<o;s++)for(l=0;l<r;l++)d[c++]=.2126*f[i=4*((s+n)*u.columns+(l+t))]+.7152*f[i+1]+.0722*f[i+2];else for(s=0;s<o;s++)for(l=0;l<r;l++)d[c++]=f[i=(s+n)*u.columns+(l+t)]*u.slope+u.intercept;return d}},"./util/getMaxSimultaneousRequests.js":function(e,t,n){"use strict";var a;n.r(t),n.d(t,"getDefaultSimultaneousRequests",function(){return l}),n.d(t,"getMaxSimultaneousRequests",function(){return s}),n.d(t,"setMaxSimultaneousRequests",function(){return i}),n.d(t,"getBrowserInfo",function(){return o}),n.d(t,"isMobileDevice",function(){return u});var r={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function o(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE ".concat(e[1]||"")):"Chrome"===n[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}function i(e){a=e}function s(){return a||l()}function l(){var e=o().split(" "),t=e[1],n=r[e[0]];return n?n[t]?n[t]:n.default:r.default}function u(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},"./util/getPixelSpacing.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./externalModules.js");function r(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId);return t?{rowPixelSpacing:t.rowPixelSpacing||t.rowImagePixelSpacing,colPixelSpacing:t.columnPixelSpacing||t.colImagePixelSpacing}:{rowPixelSpacing:e.rowPixelSpacing,colPixelSpacing:e.columnPixelSpacing}}},"./util/getRGBPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r,o){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,s,l,u=a.default.cornerstone.getEnabledElement(e),d=[],c=0,f=u.image.getPixelData();if(u.image.color)for(s=0;s<o;s++)for(l=0;l<r;l++){var m=f[1+(i=4*((s+n)*u.image.columns+(l+t)))],g=f[i+2],h=f[i+3];d[c++]=f[i],d[c++]=m,d[c++]=g,d[c++]=h}return d}},"./util/getROITextBoxCoords.js":function(e,t,n){"use strict";function a(e,t){var n=function(e){var t=[e.start,e.end].sort(function(e,t){return e.x<t.x?-1:1}),n=[e.start,e.end].sort(function(e,t){return e.y<t.y?-1:1});return{top:n[0],left:t[0],bottom:n[n.length-1],right:t[t.length-1]}}(t),a=(n.left.x+n.right.x)/2,r=(n.top.y+n.bottom.y)/2,o={};return e.rotation>=0&&e.rotation<90&&(o.x=e.hflip?n.left.x:n.right.x,o.y=r),e.rotation>=90&&e.rotation<180&&(o.x=a,o.y=e.vflip?n.bottom.y:n.top.y),e.rotation>=180&&e.rotation<270&&(o.x=e.hflip?n.right.x:n.left.x,o.y=r),e.rotation>=270&&e.rotation<360&&(o.x=a,o.y=e.vflip?n.top.y:n.bottom.y),o}n.r(t),n.d(t,"default",function(){return a})},"./util/isEmptyObject.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return 0===Object.keys(e).length&&e.constructor===Object}},"./util/isObject.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a);t.default=function(e){var t=r()(e);return null!==e&&("object"===t||"function"===t)}},"./util/isPointInImage.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.x,r=e.y;return a<n&&a>=0&&r<t&&r>=0}n.r(t),n.d(t,"default",function(){return a})},"./util/isPointInPolygon.js":function(e,t,n){"use strict";function a(e,t){for(var n=e[0],a=e[1],r=!1,o=0,i=t.length-1;o<t.length;i=o++){var s=t[o][0],l=t[o][1],u=t[i][1];l>a!=u>a&&n<(t[i][0]-s)*(a-l)/(u-l)+s&&(r=!r)}return r}n.r(t),n.d(t,"default",function(){return a})},"./util/lineSegDistance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r){var o=a.default.cornerstone,i={start:o.pixelToCanvas(e,t),end:o.pixelToCanvas(e,n)};return a.default.cornerstoneMath.lineSegment.distanceToPoint(i,r)}},"./util/logger.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLogger",function(){return i}),n.d(t,"enable",function(){return s}),n.d(t,"disable",function(){return l});var a=n("./util/debugLib/index.js"),r="cornerstoneTools",o=Object(a.default)(r);o.enabled||(console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white"),console.info('run %clocalStorage.setItem("debug", "cornerstoneTools")%c to see console output',"background: #eaeaea; color: #333; font-family: monospace",""));var i=function(e){return{log:o.extend(e),warn:console.warn.bind(console),error:console.error.bind(console)}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(r,":*");return a.default.enable(e)},l=function(){return a.default.disable()}},"./util/makeUnselectable.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.style.webkitUserSelect="none",e.style.webkitTouchCallout="none",e.style.mozUserSelect="none",e.style.msUserSelect="none",e.style.oUserSelect="none",e.style.khtmlUserSelect="none",e.style.userSelect="none",e.unselectable="on",e.oncontextmenu=function(){return!1},!0===t&&(e.style.pointerEvents="none")}},"./util/numbersWithCommas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},"./util/pointInsideBoundingBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){if(e.boundingBox)return a.default.cornerstoneMath.point.insideRect(t,e.boundingBox)}},"./util/pointProjector.js":function(e,t,n){"use strict";n.r(t),n.d(t,"projectPatientPointToImagePlane",function(){return o}),n.d(t,"imagePointToPatientPoint",function(){return i}),n.d(t,"planePlaneIntersection",function(){return s}),n.d(t,"rotatePoint",function(){return l});var a=n("./externalModules.js"),r=n("./util/convertToVector3.js");function o(e,t){var n=Object(r.default)(t.rowCosines),a=Object(r.default)(t.columnCosines),o=Object(r.default)(t.imagePositionPatient),i=e.clone().sub(o);return{x:n.dot(i)/t.columnPixelSpacing,y:a.dot(i)/t.rowPixelSpacing}}function i(e,t){var n=Object(r.default)(t.rowCosines),a=Object(r.default)(t.columnCosines),o=Object(r.default)(t.imagePositionPatient),i=n.clone().multiplyScalar(e.x);i.multiplyScalar(t.columnPixelSpacing);var s=a.clone().multiplyScalar(e.y);s.multiplyScalar(t.rowPixelSpacing);var l=i.add(s);return l.add(o),l}function s(e,t){var n=Object(r.default)(e.rowCosines),o=Object(r.default)(e.columnCosines),s=Object(r.default)(e.imagePositionPatient),l=Object(r.default)(t.rowCosines),u=Object(r.default)(t.columnCosines),d=Object(r.default)(t.imagePositionPatient),c=n.clone().cross(o),f=new a.default.cornerstoneMath.Plane;f.setFromNormalAndCoplanarPoint(c,s);var m=l.clone().cross(u),g=new a.default.cornerstoneMath.Plane;g.setFromNormalAndCoplanarPoint(m,d);var h=g.clone().intersectPlane(f),v=h.origin,p=h.direction,b=i({x:t.columns,y:t.rows},t),y=d.distanceTo(b),x=new a.default.cornerstoneMath.Line3;x.start=v,x.end=v.clone().add(p.multiplyScalar(y));var j=function(e,t){var n=[];return Object.keys(t).forEach(function(a){var r=e.intersectLine(t[a]);r&&n.push(r)}),n}(x,function(e){var t=i({x:0,y:0},e),n=i({x:e.columns,y:0},e),r=i({x:0,y:e.rows},e),o=i({x:e.columns,y:e.rows},e);return{top:new a.default.cornerstoneMath.Line3(t,n),left:new a.default.cornerstoneMath.Line3(t,r),right:new a.default.cornerstoneMath.Line3(n,o),bottom:new a.default.cornerstoneMath.Line3(r,o)}}(t));if(2===j.length)return{start:j[0],end:j[1]}}function l(e,t,n){var a=n*(Math.PI/180);return{x:Math.cos(a)*(e.x-t.x)-Math.sin(a)*(e.y-t.y)+t.x,y:Math.sin(a)*(e.x-t.x)+Math.cos(a)*(e.y-t.y)+t.y}}},"./util/roundToDecimal.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},"./util/scroll.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/scrollToIndex.js"),r=n("./stateManagement/toolState.js"),o=n("./util/clip.js"),i=n("./externalModules.js");function s(e,t,n){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index)return e.pending.splice(e.pending.indexOf(t),1),void(e.pending.length>0&&s(e,e.pending[0],n));n.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,function a(r){e.imageIds.indexOf(r.detail.image.imageId)===t.index&&(e.pending.splice(e.pending.indexOf(t),1),n.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,a),e.pending.length>0&&s(e,e.pending[0],n))}),Object(a.default)(n,t.index)}}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=Object(r.getToolState)(e,"stack");if(l&&l.data&&l.data.length){var u=l.data[0];u.pending||(u.pending=[]);var d=u.currentImageIdIndex+t;if(n){var c=u.imageIds.length;d%=c}else d=Object(o.default)(d,0,u.imageIds.length-1);if(i)Object(a.default)(e,d);else{var f={index:d};u.pending.push(f),s(u,f,e)}}}},"./util/scrollToIndex.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),i=n("./requestPool/requestPoolManager.js"),s=n("./stateManagement/loadHandlerManager.js"),l=n("./util/triggerEvent.js");t.default=function(e,t){var n=Object(o.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var u,d=r.default.cornerstone;if(n.data.length>1){var c=Object(o.getToolState)(e,"stackRenderer");c&&c.data&&c.data.length&&(u=c.data[0])}var f=n.data[0];t<0&&(t+=f.imageIds.length);var m=s.default.getStartLoadHandler(e),g=s.default.getEndLoadHandler(e),h=s.default.getErrorLoadingHandler(e);if(t!==f.currentImageIdIndex){m&&m(e);var v={newImageIdIndex:t,direction:t-f.currentImageIdIndex};f.currentImageIdIndex=t;var p=f.imageIds[t];(Boolean(f.preventCache)?d.loadImage(p):d.loadAndCacheImage(p)).then(function(a){if(f.currentImageIdIndex===t){try{d.getEnabledElement(e)}catch(r){return}u?(u.currentImageIdIndex=t,u.render(e,n.data)):d.displayImage(e,a),g&&g(e,a)}},function(n){h&&h(e,f.imageIds[t],n)}),i.default.startGrabbing(),Object(l.default)(e,a.default.STACK_SCROLL,v)}}}},"./util/segmentation/drawBrush.js":function(e,t,n){"use strict";n.r(t),n.d(t,"drawBrushPixels",function(){return i});var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./util/segmentation/eraseIfSegmentIndex.js");function i(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,t){return t*a+e};e.forEach(function(e){var a=s.apply(void 0,r()(e));i?Object(o.default)(a,t,n):t[a]=n})}},"./util/segmentation/eraseIfSegmentIndex.js":function(e,t,n){"use strict";function a(e,t,n){t[e]===n&&(t[e]=0)}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/eraseOutsideBoundingBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./util/segmentation/eraseIfSegmentIndex.js");function r(e,t,n,r){for(var o=t.pixelData,i=t.segmentIndex,s=e.detail.image,l=s.width,u=s.height,d=0;d<l;d++)for(var c=0;c<n[1];c++)Object(a.default)(c*l+d,o,i);for(var f=0;f<n[0];f++)for(var m=n[1];m<r[1];m++)Object(a.default)(m*l+f,o,i);for(var g=r[0];g<l;g++)for(var h=n[1];h<r[1];h++)Object(a.default)(h*l+g,o,i);for(var v=0;v<l;v++)for(var p=r[1];p<u;p++)Object(a.default)(p*l+v,o,i)}},"./util/segmentation/eraseShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideShape",function(){return u}),n.d(t,"eraseOutsideShape",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/eraseOutsideBoundingBox.js"),i=n("./util/segmentation/isSameSegment.js"),s=n("./util/logger.js");function l(e,t,n,a,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",u=e.detail.image.width,d=t.pixelData,c=t.segmentIndex,f=r()(a,2),m=f[0],g=f[1],h=r()(s,2),v=h[0],p=h[1];"outside"===l&&Object(o.default)(e,t,a,s);for(var b=m;b<v;b++)for(var y=g;y<p;y++){var x=y*u+b;Object(i.default)(x,d,c)&&n({x:b,y:y})&&(d[x]=0)}}function u(e,t,n,a,r){l(e,t,n,a,r,"inside")}function d(e,t,n,a,r){l(e,t,function(e){return!n(e)},a,r,"outside")}Object(s.getLogger)("util:segmentation:operations:eraseOutsideCircle")},"./util/segmentation/fillOutsideBoundingBox.js":function(e,t,n){"use strict";function a(e,t,n,a){for(var r=t.pixelData,o=t.segmentIndex,i=e.detail.image,s=i.width,l=i.height,u=0;u<s;u++)for(var d=0;d<n[1];d++)r[d*s+u]=o;for(var c=0;c<n[0];c++)for(var f=n[1];f<a[1];f++)r[f*s+c]=o;for(var m=a[0];m<s;m++)for(var g=n[1];g<a[1];g++)r[g*s+m]=o;for(var h=0;h<s;h++)for(var v=a[1];v<l;v++)r[v*s+h]=o}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/fillShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideShape",function(){return u}),n.d(t,"fillOutsideShape",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/fillOutsideBoundingBox.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("util:segmentation:operations:helpers:fillShape");function l(e,t,n,a,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",u=t.pixelData,d=t.segmentIndex;if(void 0!==u&&void 0!==d){var c=e.detail.image.width,f=r()(a,2),m=f[0],g=f[1],h=r()(i,2),v=h[0],p=h[1];"outside"===l&&Object(o.default)(e,t,a,i);for(var b=m;b<v;b++)for(var y=g;y<p;y++){var x=y*c+b;n({x:b,y:y})&&(u[x]=d)}}else s.error("fillInsideShape requires operationData to contain pixelData and segmentIndex")}function u(e,t,n,a,r){l(e,t,n,a,r,"inside")}function d(e,t,n,a,r){l(e,t,function(e){return!n(e)},a,r,"outside")}},"./util/segmentation/floodFill.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a);function o(e,t){return e===t}function i(e){for(var t=0,n=0;n<e.length;n+=1)0!==e[n]&&(t+=1);return t}function s(e,t,n){return(new Array(n+1).join(t)+e).slice(-n)}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.onFlood||function(){},l=n.onBoundary||function(){},u=n.equals||o,d=n.diagonals||!1,c=E(t),f=C(),m=[],g=[],h={},v={};for(m.push({currentArgs:t});m.length>0;)p(m.pop());return{flooded:g,boundaries:I()};function p(e){var t=e.currentArgs,n=e.previousArgs;b(t)||(y(t),x(t)?(j(t),T(t)):w(n))}function b(e){return!0===h[e]}function y(e){h[e]=!0}function x(e){var t=O(E,[e]);return O(u,[t,c])}function j(e){g.push(e),a.apply(void 0,r()(e))}function w(e){v[e]=e,l.apply(void 0,r()(e))}function T(e){for(var t=0;t<f.length;t+=1){for(var n=f[t],a=e.slice(0),r=0;r<e.length;r+=1)a[r]+=n[r];m.push({currentArgs:a,previousArgs:e})}}function E(t){return e.apply(void 0,r()(t))}function O(e,t){try{return e.apply(void 0,r()(t))}catch(n){return}}function C(){return M(t.length).filter(function(e){var t=i(e);return 0!==t&&(1===t||d)})}function M(e){for(var t=[],n=function(e){return e.split("").map(function(e){return parseInt(e,10)-1})},a=0;a<Math.pow(3,e);a+=1){var r=s(a.toString(3),"0",e);t.push(n(r))}return t}function I(){var e=[];for(var t in v)v.hasOwnProperty(t)&&e.unshift(v[t]);return e}}},"./util/segmentation/getBoundingBoxAroundCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./util/getCircleCoords.js");function r(e){var t=e.detail.handles,n=e.detail.image,r=n.width,o=n.height,i=Object(a.default)(t.start,t.end),s=i.width+i.left,l=i.left,u=i.top+i.height,d=i.top;return l=Math.floor(l),d=Math.floor(d),s=Math.floor(s),u=Math.floor(u),s=Math.min(r,s),l=Math.max(0,l),u=Math.min(o,u),[[l,d=Math.max(0,d)],[s,u]]}},"./util/segmentation/getBoundingBoxAroundPolygon.js":function(e,t,n){"use strict";function a(e,t){var n=1/0,a=0,r=1/0,o=0,i=t.width,s=t.height;return e.forEach(function(e){n=Math.min(e[0],n),a=Math.max(e[0],a),r=Math.min(e[1],r),o=Math.max(e[1],o)}),n=Math.floor(n),r=Math.floor(r),a=Math.floor(a),o=Math.floor(o),a=Math.min(i,a),n=Math.max(0,n),o=Math.min(s,o),r=Math.max(0,r),[[n,r],[a,o]]}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/getCircle.js":function(e,t,n){"use strict";function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=Math.floor(a),i=Math.floor(r);if(1===e)return[[o,i]];for(var s=[],l=0,u=-e;u<=e;u++){var d=i+u;if(!(d>t||d<0))for(var c=-e;c<=e;c++){var f=o+c;f>=n||f<0||c*c+u*u<e*e&&(s[l++]=[o+c,i+u])}}return s}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/getDiffBetweenPixelData.js":function(e,t,n){"use strict";function a(e,t){for(var n=[],a=0;a<e.length;a++)e[a]!==t[a]&&n.push([a,e[a],t[a]]);return n}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/getPixelPathBetweenPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=1/Math.sqrt(2),o={up:{x:0,y:1},upRight:{x:r,y:r},right:{x:1,y:0},downRight:{x:r,y:-r},down:{x:0,y:1},downLeft:{x:-r,y:-r},left:{x:-1,y:0},upLeft:{x:-r,y:r}};function i(e,t){var n=d(e,t);switch(f([c(n,o.up),c(n,o.right),c(n,o.upRight)])){case 0:e.y++;break;case 1:e.x++;break;case 2:e.y++,e.x++}}function s(e,t){var n=d(e,t);switch(f([c(n,o.up),c(n,o.left),c(n,o.upLeft)])){case 0:e.y++;break;case 1:e.x--;break;case 2:e.y++,e.x--}}function l(e,t){var n=d(e,t);switch(f([c(n,o.down),c(n,o.right),c(n,o.downRight)])){case 0:e.y--;break;case 1:e.x++;break;case 2:e.y--,e.x++}}function u(e,t){var n=d(e,t);switch(f([c(n,o.down),c(n,o.left),c(n,o.downLeft)])){case 0:e.y--;break;case 1:e.x--;break;case 2:e.y--,e.x--}}function d(e,t){var n=a.default.cornerstoneMath.point.distance(e,t);return{x:(t.x-e.x)/n,y:(t.y-e.y)/n}}function c(e,t){return e.x*t.x+e.y*t.y}function f(e){var t=e[0]>e[1]?0:1;return e[2]>e[t]&&(t=2),t}t.default=function(e,t){for(var n={x:e.x,y:e.y},a=[];t.x!==n.x||t.y!==n.y;)t.x===n.x?t.y>n.y?n.y++:n.y--:t.y===n.y?t.x>n.x?n.x++:n.x--:t.y>n.y?t.x>n.x?i(n,t):s(n,t):t.x>n.x?l(n,t):u(n,t),a.push({x:n.x,y:n.y});return a.pop(),a}},"./util/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/segmentation/drawBrush.js");n.d(t,"drawBrushPixels",function(){return a.drawBrushPixels});var r=n("./util/segmentation/eraseIfSegmentIndex.js");n.d(t,"eraseIfSegmentIndex",function(){return r.default});var o=n("./util/segmentation/eraseOutsideBoundingBox.js");n.d(t,"eraseOutsideBoundingBox",function(){return o.default});var i=n("./util/segmentation/eraseShape.js");n.d(t,"eraseInsideShape",function(){return i.eraseInsideShape}),n.d(t,"eraseOutsideShape",function(){return i.eraseOutsideShape});var s=n("./util/segmentation/fillOutsideBoundingBox.js");n.d(t,"fillOutsideBoundingBox",function(){return s.default});var l=n("./util/segmentation/fillShape.js");n.d(t,"fillInsideShape",function(){return l.fillInsideShape}),n.d(t,"fillOutsideShape",function(){return l.fillOutsideShape});var u=n("./util/segmentation/floodFill.js");n.d(t,"floodFill",function(){return u.default});var d=n("./util/segmentation/getBoundingBoxAroundCircle.js");n.d(t,"getBoundingBoxAroundCircle",function(){return d.default});var c=n("./util/segmentation/getBoundingBoxAroundPolygon.js");n.d(t,"getBoundingBoxAroundPolygon",function(){return c.default});var f=n("./util/segmentation/getCircle.js");n.d(t,"getCircle",function(){return f.default});var m=n("./util/segmentation/getPixelPathBetweenPixels.js");n.d(t,"getPixelPathBetweenPixels",function(){return m.default});var g=n("./util/segmentation/isSameSegment.js");n.d(t,"isSameSegment",function(){return g.default});var h=n("./util/segmentation/triggerLabelmapModifiedEvent.js");n.d(t,"triggerLabelmapModifiedEvent",function(){return h.default});var v=n("./util/segmentation/getDiffBetweenPixelData.js");n.d(t,"getDiffBetweenPixelData",function(){return v.default})},"./util/segmentation/isSameSegment.js":function(e,t,n){"use strict";function a(e,t,n){return t[e]===n}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/triggerLabelmapModifiedEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./externalModules.js"),r=n("./events.js"),o=n("./store/index.js");function i(e,t){var n=Object(o.getModule)("segmentation");t=void 0===t?n.getters.activeLabelmapIndex(e):t,a.default.cornerstone.triggerEvent(e,r.default.LABELMAP_MODIFIED,{labelmapIndex:t})}},"./util/setContextToDisplayFontSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){var r=.1;return a.default.cornerstone.setToPixelCoordinateSystem(e,t,r),{fontSize:n/e.viewport.scale/r,lineHeight:n/e.viewport.scale/r,fontScale:r}}},"./util/throttle.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/debounce.js"),r=n("./util/isObject.js");t.default=function(e,t,n){var o=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Object(r.default)(n)&&(o="leading"in n?Boolean(n.leading):o,i="trailing"in n?Boolean(n.trailing):i),Object(a.default)(e,t,{leading:o,trailing:i,maxWait:t})}},"./util/triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./util/uuidv4.js":function(e,t,n){"use strict";function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}n.r(t),n.d(t,"default",function(){return a})},"./util/wait.js":function(e,t,n){"use strict";n.r(t),n.d(t,"wait",function(){return r}),n.d(t,"waitForEnabledElementImageToLoad",function(){return o});var a=n("./externalModules.js"),r=function(e){return new Promise(function(t){return setTimeout(t,e)})};function o(e){try{var t=a.default.cornerstone.getEnabledElement(e);return t.image?t:r(250).then(function(){return o(e)})}catch(n){return null}}t.default=r},"./util/zoom/changeViewportScale.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=n.maxScale,r=n.minScale,o=Math.log(e.scale)/Math.log(1.7),i=Math.pow(1.7,o+t);return e.scale=a&&i>a?a:r&&i<r?r:i,e}},"./util/zoom/correctShift.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=t.vflip,a=t.rotation;if(e.x*=t.hflip?-1:1,e.y*=n?-1:1,0!==a){var r=a*Math.PI/180,o=Math.cos(r),i=Math.sin(r),s=e.x*i+e.y*o;e.x=e.x*o-e.y*i,e.y=s}return e}},"./util/zoom/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/zoom/changeViewportScale.js");n.d(t,"changeViewportScale",function(){return a.default});var r=n("./util/zoom/correctShift.js");n.d(t,"correctShift",function(){return r.default}),t.default={changeViewportScale:a.default,correctShift:r.default}},"./version.js":function(e,t,n){"use strict";n.r(t),t.default="5.3.0"}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("zlib")):"function"==typeof define&&define.amd?define("dicom-parser",["zlib"],t):"object"==typeof exports?exports["dicom-parser"]=t(require("zlib")):e.dicomParser=t(e.zlib)}(this,function(e){return function(e){var t=this.webpackHotUpdate;this.webpackHotUpdate=function(e,n){!function(e,t){if(j[e]&&x[e]){for(var n in x[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(g[n]=t[n]);0==--p&&0===b&&O()}}(e,n),t&&t(e,n)};var n,a=!0,r="10548f5b41ce6f922e03",o={},i=[],s=[];function l(e){var t=P[e];if(!t)return D;var a=function(a){return t.hot.active?(P[a]?-1===P[a].parents.indexOf(e)&&P[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),D(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return D[e]},set:function(t){D[e]=t}}};for(var o in D)Object.prototype.hasOwnProperty.call(D,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),b++,D.e(e).then(t,function(e){throw t(),e});function t(){b--,"prepare"===c&&(y[e]||E(e),0===b&&0===p&&O())}},a.t=function(e,t){return 1&t&&(e=a(e)),D.t(e,-2&t)},a}function u(t){var a={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:n!==t,active:!0,accept:function(e,t){if(void 0===e)a._selfAccepted=!0;else if("function"==typeof e)a._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)a._acceptedDependencies[e[n]]=t||function(){};else a._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)a._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)a._declinedDependencies[e[t]]=!0;else a._declinedDependencies[e]=!0},dispose:function(e){a._disposeHandlers.push(e)},addDisposeHandler:function(e){a._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=a._disposeHandlers.indexOf(e);t>=0&&a._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,c){case"idle":(g={})[t]=e[t],f("ready");break;case"ready":S(t);break;case"prepare":case"check":case"dispose":case"apply":(v=v||[]).push(t)}},check:T,apply:C,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[t]};return n=void 0,a}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var m,g,h,v,p=0,b=0,y={},x={},j={};function w(e){return+e+""===e?+e:e}function T(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=D.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f(I()?"ready":"idle"),null;x={},y={},j=e.c,h=e.h,f("prepare");var t=new Promise(function(e,t){m={resolve:e,reject:t}});return g={},E("dicomParser"),"prepare"===c&&0===b&&0===p&&O(),t});var t}function E(e){j[e]?(x[e]=!0,p++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=D.p+""+e+"."+r+".hot-update.js",document.head.appendChild(t)}(e)):y[e]=!0}function O(){f("ready");var e=m;if(m=null,e)if(a)Promise.resolve().then(function(){return C(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&t.push(w(n));e.resolve(t)}}function C(e){if("ready"!==c)throw new Error("apply() is only allowed in ready status");return M(e=e||{})}function M(t){var a,s,l,u,d;function c(e){for(var t=[e],n={},a=t.map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((u=P[o])&&(!u.hot._selfAccepted||u.hot._selfInvalidated)){if(u.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(u.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<u.parents.length;s++){var l=u.parents[s],d=P[l];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([l]),moduleId:o,parentId:l};-1===t.indexOf(l)&&(d.hot._acceptedDependencies[o]?(n[l]||(n[l]=[]),m(n[l],[o])):(delete n[l],t.push(l),a.push({chain:i.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}I();var p={},b=[],y={},x=function(){console.warn("[HMR] unexpected require("+E.moduleId+") to disposed module")};for(var T in g)if(Object.prototype.hasOwnProperty.call(g,T)){var E;d=w(T);var O=!1,C=!1,S=!1,_="";switch((E=g[T]?c(d):{type:"disposed",moduleId:T}).chain&&(_="\nUpdate propagation: "+E.chain.join(" -> ")),E.type){case"self-declined":t.onDeclined&&t.onDeclined(E),t.ignoreDeclined||(O=new Error("Aborted because of self decline: "+E.moduleId+_));break;case"declined":t.onDeclined&&t.onDeclined(E),t.ignoreDeclined||(O=new Error("Aborted because of declined dependency: "+E.moduleId+" in "+E.parentId+_));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(E),t.ignoreUnaccepted||(O=new Error("Aborted because "+d+" is not accepted"+_));break;case"accepted":t.onAccepted&&t.onAccepted(E),C=!0;break;case"disposed":t.onDisposed&&t.onDisposed(E),S=!0;break;default:throw new Error("Unexception type "+E.type)}if(O)return f("abort"),Promise.reject(O);if(C)for(d in y[d]=g[d],m(b,E.outdatedModules),E.outdatedDependencies)Object.prototype.hasOwnProperty.call(E.outdatedDependencies,d)&&(p[d]||(p[d]=[]),m(p[d],E.outdatedDependencies[d]));S&&(m(b,[E.moduleId]),y[d]=x)}var L,k=[];for(s=0;s<b.length;s++)P[d=b[s]]&&P[d].hot._selfAccepted&&y[d]!==x&&!P[d].hot._selfInvalidated&&k.push({module:d,parents:P[d].parents.slice(),errorHandler:P[d].hot._selfAccepted});f("dispose"),Object.keys(j).forEach(function(e){!1===j[e]&&function(e){delete installedChunks[e]}(e)});for(var A,R=b.slice();R.length>0;)if(d=R.pop(),u=P[d]){var B={},H=u.hot._disposeHandlers;for(l=0;l<H.length;l++)(a=H[l])(B);for(o[d]=B,u.hot.active=!1,delete P[d],delete p[d],l=0;l<u.children.length;l++){var F=P[u.children[l]];F&&(L=F.parents.indexOf(d))>=0&&F.parents.splice(L,1)}}for(d in p)if(Object.prototype.hasOwnProperty.call(p,d)&&(u=P[d]))for(A=p[d],l=0;l<A.length;l++)(L=u.children.indexOf(A[l]))>=0&&u.children.splice(L,1);for(d in f("apply"),void 0!==h&&(r=h,h=void 0),g=void 0,y)Object.prototype.hasOwnProperty.call(y,d)&&(e[d]=y[d]);var U=null;for(d in p)if(Object.prototype.hasOwnProperty.call(p,d)&&(u=P[d])){A=p[d];var N=[];for(s=0;s<A.length;s++)if(a=u.hot._acceptedDependencies[A[s]]){if(-1!==N.indexOf(a))continue;N.push(a)}for(s=0;s<N.length;s++){a=N[s];try{a(A)}catch(z){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:A[s],error:z}),t.ignoreErrored||U||(U=z)}}}for(s=0;s<k.length;s++){var V=k[s];i=V.parents,n=d=V.module;try{D(d)}catch(z){if("function"==typeof V.errorHandler)try{V.errorHandler(z)}catch(q){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:q,originalError:z}),t.ignoreErrored||U||(U=q),U||(U=z)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:z}),t.ignoreErrored||U||(U=z)}}return U?(f("fail"),Promise.reject(U)):v?M(t).then(function(e){return b.forEach(function(t){e.indexOf(t)<0&&e.push(t)}),e}):(f("idle"),new Promise(function(e){e(b)}))}function I(){if(v)return g||(g={}),v.forEach(S),v=void 0,!0}function S(t){Object.prototype.hasOwnProperty.call(g,t)||(g[t]=e[t])}var P={};function D(t){if(P[t])return P[t].exports;var n=P[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return D.m=e,D.c=P,D.d=function(e,t,n){D.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},D.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},D.t=function(e,t){if(1&t&&(e=D(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(D.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)D.d(n,a,(function(t){return e[t]}).bind(null,a));return n},D.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return D.d(t,"a",t),t},D.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},D.p="",D.h=function(){return r},l("./index.js")(D.s="./index.js")}({"./alloc.js":function(e,t,n){"use strict";function a(e,t){if("undefined"!=typeof Buffer&&e instanceof Buffer)return Buffer.alloc(t);if(e instanceof Uint8Array)return new Uint8Array(t);throw"dicomParser.alloc: unknown type for byteArray"}n.r(t),n.d(t,"default",function(){return a})},"./bigEndianByteArrayParser.js":function(e,t,n){"use strict";n.r(t),t.default={readUint16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(e[t]<<8)+e[t+1]},readInt16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";var n=(e[t]<<8)+e[t+1];return 32768&n&&(n=n-65535-1),n},readUint32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*e[t]+e[t+1])+e[t+2])+e[t+3]},readInt32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(e[t]<<24)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]},readFloat:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[3]=e[t],n[2]=e[t+1],n[1]=e[t+2],n[0]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[7]=e[t],n[6]=e[t+1],n[5]=e[t+2],n[4]=e[t+3],n[3]=e[t+4],n[2]=e[t+5],n[1]=e[t+6],n[0]=e[t+7],new Float64Array(n.buffer)[0]}}},"./byteArrayParser.js":function(e,t,n){"use strict";function a(e,t,n){if(n<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(t+n>e.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var a,r="",o=0;o<n;o++){if(0===(a=e[t+o]))return t+=n,r;r+=String.fromCharCode(a)}return r}n.r(t),n.d(t,"readFixedString",function(){return a})},"./byteStream.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./sharedCopy.js"),r=n("./byteArrayParser.js");var o=function(){function e(t,n,a){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===t)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===n)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(n instanceof Uint8Array==0&&("undefined"==typeof Buffer||n instanceof Buffer==0))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(a<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(a>=n.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=t,this.byteArray=n,this.position=a||0,this.warnings=[]}var t;return(t=[{key:"seek",value:function(e){if(this.position+e<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=e}},{key:"readByteStream",value:function(t){if(this.position+t>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var n=Object(a.default)(this.byteArray,this.position,t);return this.position+=t,new e(this.byteArrayParser,n)}},{key:"readUint16",value:function(){var e=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,e}},{key:"readUint32",value:function(){var e=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,e}},{key:"readFixedString",value:function(e){var t=Object(r.readFixedString)(this.byteArray,this.position,e);return this.position+=e,t}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}()},"./dataSet.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./byteArrayParser.js");function r(e,t){return void 0!==e.parser?e.parser:t}var o=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.byteArrayParser=t,this.byteArray=n,this.elements=a}var t;return(t=[{key:"uint16",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return r(n,this.byteArrayParser).readUint16(this.byteArray,n.dataOffset+2*t)}},{key:"int16",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return r(n,this.byteArrayParser).readInt16(this.byteArray,n.dataOffset+2*t)}},{key:"uint32",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return r(n,this.byteArrayParser).readUint32(this.byteArray,n.dataOffset+4*t)}},{key:"int32",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return r(n,this.byteArrayParser).readInt32(this.byteArray,n.dataOffset+4*t)}},{key:"float",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return r(n,this.byteArrayParser).readFloat(this.byteArray,n.dataOffset+4*t)}},{key:"double",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return r(n,this.byteArrayParser).readDouble(this.byteArray,n.dataOffset+8*t)}},{key:"numStringValues",value:function(e){var t=this.elements[e];if(t&&t.length>0){var n=Object(a.readFixedString)(this.byteArray,t.dataOffset,t.length).match(/\\/g);return null===n?1:n.length+1}}},{key:"string",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var r=Object(a.readFixedString)(this.byteArray,n.dataOffset,n.length);return t>=0?r.split("\\")[t].trim():r.trim()}}},{key:"text",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var r=Object(a.readFixedString)(this.byteArray,n.dataOffset,n.length);return t>=0?r.split("\\")[t].replace(/ +$/,""):r.replace(/ +$/,"")}}},{key:"floatString",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var a=this.string(e,t=void 0!==t?t:0);if(void 0!==a)return parseFloat(a)}}},{key:"intString",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var a=this.string(e,t=void 0!==t?t:0);if(void 0!==a)return parseInt(a)}}},{key:"attributeTag",value:function(e){var t=this.elements[e];if(t&&4===t.length){var n=r(t,this.byteArrayParser).readUint16,a=this.byteArray,o=t.dataOffset;return"x".concat("00000000".concat((256*n(a,o)*256+n(a,o+2)).toString(16)).substr(-8))}}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}()},"./findAndSetUNElementLength.js":function(e,t,n){"use strict";function a(e,t){if(void 0===e)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;)if(65534===e.readUint16()&&57565===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}n.r(t),n.d(t,"default",function(){return a})},"./findEndOfEncapsulatedPixelData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./readTag.js");function r(e,t,n){if(void 0===e)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(t.encapsulatedPixelData=!0,t.basicOffsetTable=[],t.fragments=[],"xfffee000"!==Object(a.default)(e))throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var r=e.readUint32()/4,o=0;o<r;o++){var i=e.readUint32();t.basicOffsetTable.push(i)}for(var s=e.position;e.position<e.byteArray.length;){var l=Object(a.default)(e),u=e.readUint32();if("xfffee0dd"===l)return e.seek(u),void(t.length=e.position-t.dataOffset);if("xfffee000"!==l)return n&&n.push("unexpected tag ".concat(l," while searching for end of pixel data element with undefined length")),u>e.byteArray.length-e.position&&(u=e.byteArray.length-e.position),t.fragments.push({offset:e.position-s-8,position:e.position,length:u}),e.seek(u),void(t.length=e.position-t.dataOffset);t.fragments.push({offset:e.position-s-8,position:e.position,length:u}),e.seek(u)}n&&n.push("pixel data element ".concat(t.tag," missing sequence delimiter tag xfffee0dd"))}},"./findItemDelimitationItem.js":function(e,t,n){"use strict";function a(e,t){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;)if(65534===e.readUint16()&&57357===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}n.r(t),n.d(t,"default",function(){return a})},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/index.js");n.d(t,"isStringVr",function(){return a.isStringVr}),n.d(t,"isPrivateTag",function(){return a.isPrivateTag}),n.d(t,"parsePN",function(){return a.parsePN}),n.d(t,"parseTM",function(){return a.parseTM}),n.d(t,"parseDA",function(){return a.parseDA}),n.d(t,"explicitElementToString",function(){return a.explicitElementToString}),n.d(t,"explicitDataSetToJS",function(){return a.explicitDataSetToJS}),n.d(t,"createJPEGBasicOffsetTable",function(){return a.createJPEGBasicOffsetTable});var r=n("./parseDicomDataSet.js");n.d(t,"parseDicomDataSetExplicit",function(){return r.parseDicomDataSetExplicit}),n.d(t,"parseDicomDataSetImplicit",function(){return r.parseDicomDataSetImplicit});var o=n("./byteArrayParser.js");n.d(t,"readFixedString",function(){return o.readFixedString});var i=n("./alloc.js");n.d(t,"alloc",function(){return i.default});var s=n("./version.js");n.d(t,"version",function(){return s.default});var l=n("./bigEndianByteArrayParser.js");n.d(t,"bigEndianByteArrayParser",function(){return l.default});var u=n("./byteStream.js");n.d(t,"ByteStream",function(){return u.default});var d=n("./sharedCopy.js");n.d(t,"sharedCopy",function(){return d.default});var c=n("./dataSet.js");n.d(t,"DataSet",function(){return c.default});var f=n("./findAndSetUNElementLength.js");n.d(t,"findAndSetUNElementLength",function(){return f.default});var m=n("./findEndOfEncapsulatedPixelData.js");n.d(t,"findEndOfEncapsulatedElement",function(){return m.default});var g=n("./findItemDelimitationItem.js");n.d(t,"findItemDelimitationItemAndSetElementLength",function(){return g.default});var h=n("./littleEndianByteArrayParser.js");n.d(t,"littleEndianByteArrayParser",function(){return h.default});var v=n("./parseDicom.js");n.d(t,"parseDicom",function(){return v.default});var p=n("./readDicomElementExplicit.js");n.d(t,"readDicomElementExplicit",function(){return p.default});var b=n("./readDicomElementImplicit.js");n.d(t,"readDicomElementImplicit",function(){return b.default});var y=n("./readEncapsulatedImageFrame.js");n.d(t,"readEncapsulatedImageFrame",function(){return y.default});var x=n("./readEncapsulatedPixelData.js");n.d(t,"readEncapsulatedPixelData",function(){return x.default});var j=n("./readEncapsulatedPixelDataFromFragments.js");n.d(t,"readEncapsulatedPixelDataFromFragments",function(){return j.default});var w=n("./readPart10Header.js");n.d(t,"readPart10Header",function(){return w.default});var T=n("./readSequenceElementExplicit.js");n.d(t,"readSequenceItemsExplicit",function(){return T.default});var E=n("./readSequenceElementImplicit.js");n.d(t,"readSequenceItemsImplicit",function(){return E.default});var O=n("./readSequenceItem.js");n.d(t,"readSequenceItem",function(){return O.default});var C=n("./readTag.js");n.d(t,"readTag",function(){return C.default}),t.default={isStringVr:a.isStringVr,isPrivateTag:a.isPrivateTag,parsePN:a.parsePN,parseTM:a.parseTM,parseDA:a.parseDA,explicitElementToString:a.explicitElementToString,explicitDataSetToJS:a.explicitDataSetToJS,createJPEGBasicOffsetTable:a.createJPEGBasicOffsetTable,parseDicomDataSetExplicit:r.parseDicomDataSetExplicit,parseDicomDataSetImplicit:r.parseDicomDataSetImplicit,readFixedString:o.readFixedString,alloc:i.default,version:s.default,bigEndianByteArrayParser:l.default,ByteStream:u.default,sharedCopy:d.default,DataSet:c.default,findAndSetUNElementLength:f.default,findEndOfEncapsulatedElement:m.default,findItemDelimitationItemAndSetElementLength:g.default,littleEndianByteArrayParser:h.default,parseDicom:v.default,readDicomElementExplicit:p.default,readDicomElementImplicit:b.default,readEncapsulatedImageFrame:y.default,readEncapsulatedPixelData:x.default,readEncapsulatedPixelDataFromFragments:j.default,readPart10Header:w.default,readSequenceItemsExplicit:T.default,readSequenceItemsImplicit:E.default,readSequenceItem:O.default,readTag:C.default}},"./littleEndianByteArrayParser.js":function(e,t,n){"use strict";n.r(t),t.default={readUint16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return e[t]+256*e[t+1]},readInt16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";var n=e[t]+(e[t+1]<<8);return 32768&n&&(n=n-65535-1),n},readUint32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return e[t]+256*e[t+1]+256*e[t+2]*256+256*e[t+3]*256*256},readInt32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)},readFloat:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],n[4]=e[t+4],n[5]=e[t+5],n[6]=e[t+6],n[7]=e[t+7],new Float64Array(n.buffer)[0]}}},"./parseDicom.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return f});var a=n("./alloc.js"),r=n("./bigEndianByteArrayParser.js"),o=n("./byteStream.js"),i=n("./dataSet.js"),s=n("./littleEndianByteArrayParser.js"),l=n("./readPart10Header.js"),u=n("./sharedCopy.js"),d=n("./byteArrayParser.js"),c=n("./parseDicomDataSet.js");function f(e,t){if(void 0===e)throw"dicomParser.parseDicom: missing required parameter 'byteArray'";return function(e,t){for(var n in e.elements)e.elements.hasOwnProperty(n)&&(t.elements[n]=e.elements[n]);return void 0!==e.warnings&&(t.warnings=e.warnings.concat(t.warnings)),t}(f=Object(l.default)(e,t),function(l){var f=function(t){if(void 0===t.elements.x00020010)throw"dicomParser.parseDicom: missing required meta header attribute 0002,0010";var n=t.elements.x00020010;return d.readFixedString(e,n.dataOffset,n.length)}(l),m=function(e){return"1.2.840.10008.1.2"!==e}(f),g=function(i,l){var d="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);if("1.2.840.10008.1.2.1.99"===i){if(t&&t.inflater){var c=t.inflater(e,l);return new o.default(s.default,c,0)}if(!0===d){var f=n("zlib"),m=Object(u.default)(e,l,e.length-l),g=f.inflateRawSync(m),h=Object(a.default)(e,g.length+l);return e.copy(h,0,0,l),g.copy(h,l),new o.default(s.default,h,0)}if("undefined"!=typeof pako){var v=e.slice(l),p=pako.inflateRaw(v),b=Object(a.default)(e,p.length+l);return b.set(e.slice(0,l),0),b.set(p,l),new o.default(s.default,b,0)}throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax"}return new o.default("1.2.840.10008.1.2.2"===i?r.default:s.default,e,l)}(f,l.position),h=new i.default(g.byteArrayParser,g.byteArray,{});h.warnings=g.warnings;try{m?c.parseDicomDataSetExplicit(h,g,g.byteArray.length,t):c.parseDicomDataSetImplicit(h,g,g.byteArray.length,t)}catch(v){throw{exception:v,dataSet:h}}return h}(f));var f}},"./parseDicomDataSet.js":function(e,t,n){"use strict";n.r(t),n.d(t,"parseDicomDataSetExplicit",function(){return o}),n.d(t,"parseDicomDataSetImplicit",function(){return i});var a=n("./readDicomElementExplicit.js"),r=n("./readDicomElementImplicit.js");function o(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(void 0===t)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if((n=void 0===n?t.byteArray.length:n)<t.position||n>t.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var o=e.elements;t.position<n;){var i=Object(a.default)(t,e.warnings,r.untilTag);if(o[i.tag]=i,i.tag===r.untilTag)return}if(t.position>n)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function i(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(void 0===t)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if((n=void 0===n?e.byteArray.length:n)<t.position||n>t.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var o=e.elements;t.position<n;){var i=Object(r.default)(t,a.untilTag,a.vrCallback);if(o[i.tag]=i,i.tag===a.untilTag)return}}},"./readDicomElementExplicit.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l});var a=n("./findEndOfEncapsulatedPixelData.js"),r=(n("./findAndSetUNElementLength.js"),n("./readSequenceElementImplicit.js")),o=n("./readTag.js"),i=n("./findItemDelimitationItem.js"),s=n("./readSequenceElementExplicit.js");function l(e,t,n){if(void 0===e)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var l,u={tag:Object(o.default)(e),vr:e.readFixedString(2)};return 2==("OB"===(l=u.vr)||"OD"===l||"OL"===l||"OW"===l||"SQ"===l||"OF"===l||"UC"===l||"UR"===l||"UT"===l||"UN"===l?4:2)?(u.length=e.readUint16(),u.dataOffset=e.position):(e.seek(2),u.length=e.readUint32(),u.dataOffset=e.position),4294967295===u.length&&(u.hadUndefinedLength=!0),u.tag===n?u:"SQ"===u.vr?(Object(s.default)(e,u,t),u):4294967295===u.length?"x7fe00010"===u.tag?(Object(a.default)(e,u,t),u):"UN"===u.vr?(Object(r.default)(e,u),u):(Object(i.default)(e,u),u):(e.seek(u.length),u)}},"./readDicomElementImplicit.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./findItemDelimitationItem.js"),r=n("./readSequenceElementImplicit.js"),o=n("./readTag.js"),i=n("./util/util.js");function s(e,t,n){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var s={tag:Object(o.default)(e),length:e.readUint32(),dataOffset:e.position};return 4294967295===s.length&&(s.hadUndefinedLength=!0),s.tag===t?s:function(e,t,n){if(void 0!==n)return"SQ"===n(e.tag);if(t.position+4<=t.byteArray.length){var a=Object(o.default)(t);return t.seek(-4),"xfffee000"===a||"xfffee0dd"===a}return t.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1}(s,e,n)&&!Object(i.isPrivateTag)(s.tag)?(Object(r.default)(e,s),s):s.hadUndefinedLength?(Object(a.default)(e,s),s):(e.seek(s.length),s)}},"./readEncapsulatedImageFrame.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./readEncapsulatedPixelDataFromFragments.js");function r(e,t,n,r,o){if(void 0===e)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===n)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===(r=r||t.basicOffsetTable))throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===r.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(n<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(n>=r.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var i=function(e,t){for(var n=0;n<e.length;n++)if(e[n].offset===t)return n}(o=o||t.fragments,r[n]);if(void 0===i)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";var s=function(e,t,n,a){if(e===t.length-1)return n.length-a;for(var r=t[e+1],o=a+1;o<n.length;o++)if(n[o].offset===r)return o-a;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"}(n,r,o,i);return Object(a.default)(e,t,i,s,o)}},"./readEncapsulatedPixelData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./readEncapsulatedImageFrame.js"),r=n("./readEncapsulatedPixelDataFromFragments.js"),o=!1;function i(e,t,n){if(o||(o=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===e)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===n)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(n<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==t.basicOffsetTable.length?Object(a.default)(e,t,n):Object(r.default)(e,t,0,t.fragments.length)}},"./readEncapsulatedPixelDataFromFragments.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./alloc.js"),r=n("./byteStream.js"),o=n("./readSequenceItem.js"),i=n("./sharedCopy.js");function s(e,t,n,s,l){if(l=l||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===n)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===(s=s||1))throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(n<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(n>=t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(s<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(n+s>t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var u=new r.default(e.byteArrayParser,e.byteArray,t.dataOffset),d=Object(o.default)(u);if("xfffee000"!==d.tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";u.seek(d.length);var c=u.position;if(1===s)return Object(i.default)(u.byteArray,c+l[n].offset+8,l[n].length);for(var f=function(e,t,n){for(var a=0,r=t;r<t+n;r++)a+=e[r].length;return a}(l,n,s),m=Object(a.default)(u.byteArray,f),g=0,h=n;h<n+s;h++)for(var v=c+l[h].offset+8,p=0;p<l[h].length;p++)m[g++]=u.byteArray[v++];return m}},"./readPart10Header.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./byteStream.js"),r=n("./dataSet.js"),o=n("./littleEndianByteArrayParser.js"),i=n("./readDicomElementExplicit.js");function s(e,t){if(void 0===e)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var n=new a.default(o.default,e);return function(){!function(){if(n.seek(128),"DICM"!==n.readFixedString(4))throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file."}();for(var e=[],t={};n.position<n.byteArray.length;){var a=n.position,s=Object(i.default)(n,e);if(s.tag>"x0002ffff"){n.position=a;break}s.parser=o.default,t[s.tag]=s}var l=new r.default(n.byteArrayParser,n.byteArray,t);return l.warnings=n.warnings,l.position=n.position,l}()}},"./readSequenceElementExplicit.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("./dataSet.js"),r=n("./readDicomElementExplicit.js"),o=n("./readSequenceItem.js"),i=n("./readTag.js"),s=n("./parseDicomDataSet.js");function l(e,t){var n=Object(o.default)(e);return 4294967295===n.length?(n.hadUndefinedLength=!0,n.dataSet=function(e,t){for(var n={};e.position<e.byteArray.length;){var o=Object(r.default)(e,t);if(n[o.tag]=o,"xfffee00d"===o.tag)return new a.default(e.byteArrayParser,e.byteArray,n)}return t.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new a.default(e.byteArrayParser,e.byteArray,n)}(e,t),n.length=e.position-n.dataOffset):(n.dataSet=new a.default(e.byteArrayParser,e.byteArray,{}),s.parseDicomDataSetExplicit(n.dataSet,e,e.position+n.length)),n}function u(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";t.items=[],4294967295===t.length?function(e,t,n){for(;e.position+4<=e.byteArray.length;){var a=Object(i.default)(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8),t;var r=l(e,n);t.items.push(r)}n.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),t.length=e.position-t.dataOffset}(e,t,n):function(e,t,n){for(var a=t.dataOffset+t.length;e.position<a;){var r=l(e,n);t.items.push(r)}}(e,t,n)}},"./readSequenceElementImplicit.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("./dataSet.js"),r=n("./readDicomElementImplicit.js"),o=n("./readSequenceItem.js"),i=n("./readTag.js"),s=n("./parseDicomDataSet.js");function l(e,t){var n=Object(o.default)(e);return 4294967295===n.length?(n.hadUndefinedLength=!0,n.dataSet=function(e,t){for(var n={};e.position<e.byteArray.length;){var o=Object(r.default)(e,void 0,t);if(n[o.tag]=o,"xfffee00d"===o.tag)return new a.default(e.byteArrayParser,e.byteArray,n)}return e.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new a.default(e.byteArrayParser,e.byteArray,n)}(e,t),n.length=e.position-n.dataOffset):(n.dataSet=new a.default(e.byteArrayParser,e.byteArray,{}),s.parseDicomDataSetImplicit(n.dataSet,e,e.position+n.length,{vrCallback:t})),n}function u(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";t.items=[],4294967295===t.length?function(e,t,n){for(;e.position+4<=e.byteArray.length;){var a=Object(i.default)(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8),t;var r=l(e,n);t.items.push(r)}e.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),t.length=e.byteArray.length-t.dataOffset}(e,t,n):function(e,t,n){for(var a=t.dataOffset+t.length;e.position<a;){var r=l(e,n);t.items.push(r)}}(e,t,n)}},"./readSequenceItem.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./readTag.js");function r(e){if(void 0===e)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var t={tag:Object(a.default)(e),length:e.readUint32(),dataOffset:e.position};if("xfffee000"!==t.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(e.position);return t}},"./readTag.js":function(e,t,n){"use strict";function a(e){if(void 0===e)throw"dicomParser.readTag: missing required parameter 'byteStream'";var t=256*e.readUint16()*256,n=e.readUint16();return"x".concat("00000000".concat((t+n).toString(16)).substr(-8))}n.r(t),n.d(t,"default",function(){return a})},"./sharedCopy.js":function(e,t,n){"use strict";function a(e,t,n){if("undefined"!=typeof Buffer&&e instanceof Buffer)return e.slice(t,t+n);if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset+t,n);throw"dicomParser.from: unknown type for byteArray"}n.r(t),n.d(t,"default",function(){return a})},"./util/createJPEGBasicOffsetTable.js":function(e,t,n){"use strict";function a(e,t){return 255===e.byteArray[t]&&217===e.byteArray[t+1]}function r(e,t,n){var r=t.fragments[n];return!(!a(e,r.position+r.length-2)&&!a(e,r.position+r.length-3))}function o(e,t,n){for(var a=n;a<t.fragments.length;a++)if(r(e,t,a))return a}function i(e,t,n){if(void 0===e)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===t)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==t.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==t.encapsulatedPixelData)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(n&&n.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";n=n||t.fragments;for(var a=[],r=0;;){a.push(t.fragments[r].offset);var i=o(e,t,r);if(void 0===i||i===t.fragments.length-1)return a;r=i+1}}n.r(t),n.d(t,"default",function(){return i})},"./util/dataSetToJS.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./util/elementToString.js"),r=n("./util/util.js");function o(e,t){if(void 0===e)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";t=t||{omitPrivateAttibutes:!0,maxElementLength:128};var n={};for(var i in e.elements){var s=e.elements[i];if(!0!==t.omitPrivateAttibutes||!r.isPrivateTag(i))if(s.items){for(var l=[],u=0;u<s.items.length;u++)l.push(o(s.items[u].dataSet,t));n[i]=l}else{var d;d=void 0,s.length<t.maxElementLength&&(d=Object(a.default)(e,s)),n[i]=void 0!==d?d:{dataOffset:s.dataOffset,length:s.length}}}return n}},"./util/elementToString.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./util/util.js");function r(e,t){if(void 0===e||void 0===t)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===t.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var n,r=t.vr,o=t.tag;function i(t,n){for(var a="",r=0;r<t;r++)0!==r&&(a+="/"),a+=n.call(e,o,r).toString();return a}if(!0===a.isStringVr(r))n=e.string(o);else{if("AT"===r){var s=e.uint32(o);if(void 0===s)return;return s<0&&(s=4294967295+s+1),"x".concat(s.toString(16).toUpperCase())}"US"===r?n=i(t.length/2,e.uint16):"SS"===r?n=i(t.length/2,e.int16):"UL"===r?n=i(t.length/4,e.uint32):"SL"===r?n=i(t.length/4,e.int32):"FD"===r?n=i(t.length/8,e.double):"FL"===r&&(n=i(t.length/4,e.float))}return n}},"./util/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/util.js");n.d(t,"isStringVr",function(){return a.isStringVr}),n.d(t,"isPrivateTag",function(){return a.isPrivateTag}),n.d(t,"parsePN",function(){return a.parsePN});var r=n("./util/parseTM.js");n.d(t,"parseTM",function(){return r.default});var o=n("./util/parseDA.js");n.d(t,"parseDA",function(){return o.default});var i=n("./util/elementToString.js");n.d(t,"explicitElementToString",function(){return i.default});var s=n("./util/dataSetToJS.js");n.d(t,"explicitDataSetToJS",function(){return s.default});var l=n("./util/createJPEGBasicOffsetTable.js");n.d(t,"createJPEGBasicOffsetTable",function(){return l.default})},"./util/parseDA.js":function(e,t,n){"use strict";function a(e,t){if(e&&8===e.length){var n=parseInt(e.substring(0,4),10),a=parseInt(e.substring(4,6),10),r=parseInt(e.substring(6,8),10);if(t&&1!=(o=r,i=a,s=n,!isNaN(s)&&i>0&&i<=12&&o>0&&o<=function(e,t){switch(e){case 2:return t%4==0&&t%100||t%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(i,s)))throw"invalid DA '".concat(e,"'");return{year:n,month:a,day:r}}var o,i,s;if(t)throw"invalid DA '".concat(e,"'")}n.r(t),n.d(t,"default",function(){return a})},"./util/parseTM.js":function(e,t,n){"use strict";function a(e,t){if(e.length>=2){var n=parseInt(e.substring(0,2),10),a=e.length>=4?parseInt(e.substring(2,4),10):void 0,r=e.length>=6?parseInt(e.substring(4,6),10):void 0,o=e.length>=8?e.substring(7,13):void 0,i=o?parseInt(o,10)*Math.pow(10,6-o.length):void 0;if(t&&(isNaN(n)||void 0!==a&&isNaN(a)||void 0!==r&&isNaN(r)||void 0!==i&&isNaN(i)||n<0||n>23||a&&(a<0||a>59)||r&&(r<0||r>59)||i&&(i<0||i>999999)))throw"invalid TM '".concat(e,"'");return{hours:n,minutes:a,seconds:r,fractionalSeconds:i}}if(t)throw"invalid TM '".concat(e,"'")}n.r(t),n.d(t,"default",function(){return a})},"./util/util.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isStringVr",function(){return r}),n.d(t,"isPrivateTag",function(){return o}),n.d(t,"parsePN",function(){return i});var a={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},r=function(e){return a[e]},o=function(e){return parseInt(e[4],10)%2==1},i=function(e){if(void 0!==e){var t=e.split("^");return{familyName:t[0],givenName:t[1],middleName:t[2],prefix:t[3],suffix:t[4]}}}},"./version.js":function(e,t,n){"use strict";n.r(t),t.default="1.8.5"},zlib:function(t,n){t.exports=e}})}),function(e,t,n,a){"use strict";var r,o=["","webkit","Moz","MS","ms","o"],i=t.createElement("div"),s=Math.round,l=Math.abs,u=Date.now;function d(e,t,n){return setTimeout(p(e,n),t)}function c(e,t,n){return!!Array.isArray(e)&&(f(e,n[t],n),!0)}function f(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function m(t,n,a){var r="DEPRECATED METHOD: "+n+"\n"+a+" AT \n";return function(){var n=new Error("get-stack-trace"),a=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=e.console&&(e.console.warn||e.console.log);return o&&o.call(e.console,r,a),t.apply(this,arguments)}}r="function"!=typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}:Object.assign;var g=m(function(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;)(!n||n&&e[r[o]]===a)&&(e[r[o]]=t[r[o]]),o++;return e},"extend","Use `assign`."),h=m(function(e,t){return g(e,t,!0)},"merge","Use `assign`.");function v(e,t,n){var a,o=t.prototype;(a=e.prototype=Object.create(o)).constructor=e,a._super=o,n&&r(a,n)}function p(e,t){return function(){return e.apply(t,arguments)}}function b(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function y(e,t){return e===a?t:e}function x(e,t,n){f(E(t),function(t){e.addEventListener(t,n,!1)})}function j(e,t,n){f(E(t),function(t){e.removeEventListener(t,n,!1)})}function w(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function E(e){return e.trim().split(/\s+/g)}function O(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var a=0;a<e.length;){if(n&&e[a][n]==t||!n&&e[a]===t)return a;a++}return-1}function C(e){return Array.prototype.slice.call(e,0)}function M(e,t,n){for(var a=[],r=[],o=0;o<e.length;){var i=t?e[o][t]:e[o];O(r,i)<0&&a.push(e[o]),r[o]=i,o++}return n&&(a=t?a.sort(function(e,n){return e[t]>n[t]}):a.sort()),a}function I(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),s=0;s<o.length;){if((r=(n=o[s])?n+i:t)in e)return r;s++}return a}var S=1;function P(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}var D="ontouchstart"in e,_=I(e,"PointerEvent")!==a,L=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),k="touch",A="mouse",R=["x","y"],B=["clientX","clientY"];function H(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){b(e.options.enable,[e])&&n.handler(t)},this.init()}function F(e,t,n){var r=n.pointers.length,o=n.changedPointers.length,i=1&t&&r-o==0,s=12&t&&r-o==0;n.isFirst=!!i,n.isFinal=!!s,i&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,o=r.length;n.firstInput||(n.firstInput=U(t)),o>1&&!n.firstMultiple?n.firstMultiple=U(t):1===o&&(n.firstMultiple=!1);var i=n.firstInput,s=n.firstMultiple,d=s?s.center:i.center,c=t.center=N(r);t.timeStamp=u(),t.deltaTime=t.timeStamp-i.timeStamp,t.angle=W(d,c),t.distance=q(d,c),function(e,t){var n=t.center,a=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},a=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=r.x+(n.x-a.x),t.deltaY=r.y+(n.y-a.y)}(n,t),t.offsetDirection=z(t.deltaX,t.deltaY);var f,m,g=V(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=g.x,t.overallVelocityY=g.y,t.overallVelocity=l(g.x)>l(g.y)?g.x:g.y,t.scale=s?(f=s.pointers,q((m=r)[0],m[1],B)/q(f[0],f[1],B)):1,t.rotation=s?function(e,t){return W(t[1],t[0],B)+W(e[1],e[0],B)}(s.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,o,i,s=e.lastInterval||t,u=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(u>25||s.velocity===a)){var d=t.deltaX-s.deltaX,c=t.deltaY-s.deltaY,f=V(u,d,c);r=f.x,o=f.y,n=l(f.x)>l(f.y)?f.x:f.y,i=z(d,c),e.lastInterval=t}else n=s.velocity,r=s.velocityX,o=s.velocityY,i=s.direction;t.velocity=n,t.velocityX=r,t.velocityY=o,t.direction=i}(n,t);var h=e.element;w(t.srcEvent.target,h)&&(h=t.srcEvent.target),t.target=h}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function U(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:s(e.pointers[n].clientX),clientY:s(e.pointers[n].clientY)},n++;return{timeStamp:u(),pointers:t,center:N(t),deltaX:e.deltaX,deltaY:e.deltaY}}function N(e){var t=e.length;if(1===t)return{x:s(e[0].clientX),y:s(e[0].clientY)};for(var n=0,a=0,r=0;r<t;)n+=e[r].clientX,a+=e[r].clientY,r++;return{x:s(n/t),y:s(a/t)}}function V(e,t,n){return{x:t/e||0,y:n/e||0}}function z(e,t){return e===t?1:l(e)>=l(t)?e<0?2:4:t<0?8:16}function q(e,t,n){n||(n=R);var a=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(a*a+r*r)}function W(e,t,n){return n||(n=R),180*Math.atan2(t[n[1]]-e[n[1]],t[n[0]]-e[n[0]])/Math.PI}H.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(P(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&j(this.element,this.evEl,this.domHandler),this.evTarget&&j(this.target,this.evTarget,this.domHandler),this.evWin&&j(P(this.element),this.evWin,this.domHandler)}};var G={mousedown:1,mousemove:2,mouseup:4},Y="mousedown",X="mousemove mouseup";function J(){this.evEl=Y,this.evWin=X,this.pressed=!1,H.apply(this,arguments)}v(J,H,{handler:function(e){var t=G[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:A,srcEvent:e}))}});var Z={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},K={2:k,3:"pen",4:A,5:"kinect"},Q="pointerdown",$="pointermove pointerup pointercancel";function ee(){this.evEl=Q,this.evWin=$,H.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(Q="MSPointerDown",$="MSPointerMove MSPointerUp MSPointerCancel"),v(ee,H,{handler:function(e){var t=this.store,n=!1,a=e.type.toLowerCase().replace("ms",""),r=Z[a],o=K[e.pointerType]||e.pointerType,i=o==k,s=O(t,e.pointerId,"pointerId");1&r&&(0===e.button||i)?s<0&&(t.push(e),s=t.length-1):12&r&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ne="touchstart",ae="touchstart touchmove touchend touchcancel";function re(){this.evTarget=ne,this.evWin=ae,this.started=!1,H.apply(this,arguments)}function oe(e,t){var n=C(e.touches),a=C(e.changedTouches);return 12&t&&(n=M(n.concat(a),"identifier",!0)),[n,a]}v(re,H,{handler:function(e){var t=te[e.type];if(1===t&&(this.started=!0),this.started){var n=oe.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:k,srcEvent:e})}}});var ie={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart touchmove touchend touchcancel";function le(){this.evTarget=se,this.targetIds={},H.apply(this,arguments)}function ue(e,t){var n=C(e.touches),a=this.targetIds;if(3&t&&1===n.length)return a[n[0].identifier]=!0,[n,n];var r,o,i=C(e.changedTouches),s=[],l=this.target;if(o=n.filter(function(e){return w(e.target,l)}),1===t)for(r=0;r<o.length;)a[o[r].identifier]=!0,r++;for(r=0;r<i.length;)a[i[r].identifier]&&s.push(i[r]),12&t&&delete a[i[r].identifier],r++;return s.length?[M(o.concat(s),"identifier",!0),s]:void 0}function de(){H.apply(this,arguments);var e=p(this.handler,this);this.touch=new le(this.manager,e),this.mouse=new J(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ce(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,fe.call(this,t)):12&e&&fe.call(this,t)}function fe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var a=this.lastTouches;setTimeout(function(){var e=a.indexOf(n);e>-1&&a.splice(e,1)},2500)}}function me(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var r=this.lastTouches[a],o=Math.abs(t-r.x),i=Math.abs(n-r.y);if(o<=25&&i<=25)return!0}return!1}v(le,H,{handler:function(e){var t=ie[e.type],n=ue.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:k,srcEvent:e})}}),v(de,H,{handler:function(e,t,n){var a=n.pointerType==A;if(!(a&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(n.pointerType==k)ce.call(this,t,n);else if(a&&me.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ge=I(i.style,"touchAction"),he=ge!==a,ve="compute",pe="auto",be="manipulation",ye="none",xe="pan-x",je="pan-y",we=function(){if(!he)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(a){t[a]=!n||e.CSS.supports("touch-action",a)}),t}();function Te(e,t){this.manager=e,this.set(t)}Te.prototype={set:function(e){e==ve&&(e=this.compute()),he&&this.manager.element.style&&we[e]&&(this.manager.element.style[ge]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return f(this.manager.recognizers,function(t){b(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(T(e,ye))return ye;var t=T(e,xe),n=T(e,je);return t&&n?ye:t||n?t?xe:je:T(e,be)?be:pe}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var a=this.actions,r=T(a,ye)&&!we.none,o=T(a,je)&&!we["pan-y"],i=T(a,xe)&&!we["pan-x"];if(r&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!i||!o)return r||o&&6&n||i&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ee=32;function Oe(e){this.options=r({},this.defaults,e||{}),this.id=S++,this.manager=null,this.options.enable=y(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Ce(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Me(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Ie(e,t){var n=t.manager;return n?n.get(e):e}function Se(){Oe.apply(this,arguments)}function Pe(){Se.apply(this,arguments),this.pX=null,this.pY=null}function De(){Se.apply(this,arguments)}function _e(){Oe.apply(this,arguments),this._timer=null,this._input=null}function Le(){Se.apply(this,arguments)}function ke(){Se.apply(this,arguments)}function Ae(){Oe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Re(e,t){return(t=t||{}).recognizers=y(t.recognizers,Re.defaults.preset),new Be(e,t)}function Be(e,t){this.options=r({},Re.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(_?ee:L?le:D?de:J))(this,F),this.touchAction=new Te(this,this.options.touchAction),He(this,!0),f(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function He(e,t){var n,a=e.element;a.style&&(f(e.options.cssProps,function(r,o){n=I(a.style,o),t?(e.oldCssProps[n]=a.style[n],a.style[n]=r):a.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}Oe.prototype={defaults:{},set:function(e){return r(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(c(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ie(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return c(e,"dropRecognizeWith",this)||(e=Ie(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(c(e,"requireFailure",this))return this;var t=this.requireFail;return-1===O(t,e=Ie(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(c(e,"dropRequireFailure",this))return this;e=Ie(e,this);var t=O(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function a(n){t.manager.emit(n,e)}n<8&&a(t.options.event+Ce(n)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),n>=8&&a(t.options.event+Ce(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ee},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=r({},e);if(!b(this.options.enable,[this,t]))return this.reset(),void(this.state=Ee);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},v(Se,Oe,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,a=6&t,r=this.attrTest(e);return a&&(8&n||!r)?16|t:a||r?4&n?8|t:2&t?4|t:2:Ee}}),v(Pe,Se,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(je),24&e&&t.push(xe),t},directionTest:function(e){var t=this.options,n=!0,a=e.distance,r=e.direction,o=e.deltaX,i=e.deltaY;return r&t.direction||(6&t.direction?(r=0===o?1:o<0?2:4,n=o!=this.pX,a=Math.abs(e.deltaX)):(r=0===i?1:i<0?8:16,n=i!=this.pY,a=Math.abs(e.deltaY))),e.direction=r,n&&a>t.threshold&&r&t.direction},attrTest:function(e){return Se.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Me(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),v(De,Se,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ye]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),this._super.emit.call(this,e)}}),v(_e,Oe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[pe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!a||!n||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=d(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return Ee},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}}),v(Le,Se,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ye]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),v(ke,Se,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Pe.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&l(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Me(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),v(Ae,Oe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[be]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(a&&r&&n){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,i=!this.pCenter||q(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,i&&o?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=d(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return Ee},failTimeout:function(){return this._timer=d(function(){this.state=Ee},this.options.interval,this),Ee},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Re.VERSION="2.0.7",Re.defaults={domEvents:!1,touchAction:ve,enable:!0,inputTarget:null,inputClass:null,preset:[[Le,{enable:!1}],[De,{enable:!1},["rotate"]],[ke,{direction:6}],[Pe,{direction:6},["swipe"]],[Ae],[Ae,{event:"doubletap",taps:2},["tap"]],[_e]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Be.prototype={set:function(e){return r(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var a=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var o=0;o<a.length;)n=a[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Oe)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(c(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(c(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=O(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return f(E(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==a){var n=this.handlers;return f(E(e),function(e){t?n[e]&&n[e].splice(O(n[e],t),1):delete n[e]}),this}},emit:function(e,n){this.options.domEvents&&function(e,n){var a=t.createEvent("Event");a.initEvent(e,!0,!0),a.gesture=n,n.target.dispatchEvent(a)}(e,n);var a=this.handlers[e]&&this.handlers[e].slice();if(a&&a.length){n.type=e,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var r=0;r<a.length;)a[r](n),r++}},destroy:function(){this.element&&He(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},r(Re,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ee,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Be,Input:H,TouchAction:Te,TouchInput:le,MouseInput:J,PointerEventInput:ee,TouchMouseInput:de,SingleTouchInput:re,Recognizer:Oe,AttrRecognizer:Se,Tap:Ae,Pan:Pe,Swipe:ke,Pinch:De,Rotate:Le,Press:_e,on:x,off:j,each:f,merge:h,extend:g,assign:r,inherit:v,bindFn:p,prefixed:I}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Re,"function"==typeof define&&define.amd?define(function(){return Re}):"undefined"!=typeof module&&module.exports?module.exports=Re:e.Hammer=Re}(window,document),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneWADOImageLoader",[],t):"object"==typeof exports?exports.cornerstoneWADOImageLoader=t():e.cornerstoneWADOImageLoader=t()}(this,function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./imageLoader/index.js")}({"./externalModules.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/registerLoaders.js"))&&a.__esModule?a:{default:a},o=void 0,i=void 0;t.default={set cornerstone(e){(0,r.default)(o=e)},get cornerstone(){if(!o){if(!window||!window.cornerstone)throw new Error("cornerstoneWADOImageLoader requires a copy of Cornerstone to work properly. Please add cornerstoneWADOImageLoader.external.cornerstone = cornerstone; to your application.");o=window.cornerstone,(0,r.default)(o)}return o},set dicomParser(e){i=e},get dicomParser(){if(!i){if(!window||!window.dicomParser)throw new Error("cornerstoneWADOImageLoader requires a copy of dicomParser to work properly. Please add cornerstoneWADOImageLoader.external.dicomParser = dicomParser; to your application.");i=window.dicomParser}return i}}},"./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js":function(e,t,n){"use strict";function a(e,t){for(var n=e.length,a=new Uint8ClampedArray(n),r=0;r<n;++r)a[r]=e[r]>>t;return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=e.columns*e.rows,r=e.pixelData,o=e.greenPaletteColorLookupTableData,i=e.bluePaletteColorLookupTableData,s=e.redPaletteColorLookupTableData.length,l=0,u=0,d=e.redPaletteColorLookupTableDescriptor[1],c=8===e.redPaletteColorLookupTableDescriptor[2]?0:8,f=a(e.redPaletteColorLookupTableData,c),m=a(o,c),g=a(i,c),h=0;h<n;++h){var v=r[l++];v<d?v=0:v>d+s-1?v=s-1:v-=d,t[u++]=f[v],t[u++]=m[v],t[u++]=g[v],t[u++]=255}}},"./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var n=e.length/3,a=0,r=0,o=0;o<n;o++)t[r++]=e[a++],t[r++]=e[a++],t[r++]=e[a++],t[r++]=255}},"./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var n=e.length/3,a=0,r=0,o=n,i=2*n,s=0;s<n;s++)t[a++]=e[r++],t[a++]=e[o++],t[a++]=e[i++],t[a++]=255}},"./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var n=e.length/3,a=0,r=0,o=0;o<n;o++){var i=e[a++],s=e[a++],l=e[a++];t[r++]=i+1.402*(l-128),t[r++]=i-.34414*(s-128)-.71414*(l-128),t[r++]=i+1.772*(s-128),t[r++]=255}}},"./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var n=e.length/3,a=0,r=0,o=n,i=2*n,s=0;s<n;s++){var l=e[r++],u=e[o++],d=e[i++];t[a++]=l+1.402*(d-128),t[a++]=l-.34414*(u-128)-.71414*(d-128),t[a++]=l+1.772*(u-128),t[a++]=255}}},"./imageLoader/colorSpaceConverters/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js");Object.defineProperty(t,"convertRGBColorByPixel",{enumerable:!0,get:function(){return l(a).default}});var r=n("./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js");Object.defineProperty(t,"convertRGBColorByPlane",{enumerable:!0,get:function(){return l(r).default}});var o=n("./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js");Object.defineProperty(t,"convertYBRFullByPixel",{enumerable:!0,get:function(){return l(o).default}});var i=n("./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js");Object.defineProperty(t,"convertYBRFullByPlane",{enumerable:!0,get:function(){return l(i).default}});var s=n("./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js");function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"convertPALETTECOLOR",{enumerable:!0,get:function(){return l(s).default}})},"./imageLoader/configure.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/internal/index.js");t.default=function(e){(0,a.setOptions)(e)}},"./imageLoader/convertColorSpace.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.data;if("RGB"===e.photometricInterpretation)r(e,n);else if("YBR_RCT"===e.photometricInterpretation)r(e,n);else if("YBR_ICT"===e.photometricInterpretation)r(e,n);else if("PALETTE COLOR"===e.photometricInterpretation)(0,a.convertPALETTECOLOR)(e,n);else if("YBR_FULL_422"===e.photometricInterpretation)r(e,n);else{if("YBR_FULL"!==e.photometricInterpretation)throw new Error("No color space conversion for photometric interpretation "+e.photometricInterpretation);!function(e,t){0===e.planarConfiguration?(0,a.convertYBRFullByPixel)(e.pixelData,t):(0,a.convertYBRFullByPlane)(e.pixelData,t)}(e,n)}};var a=n("./imageLoader/colorSpaceConverters/index.js");function r(e,t){0===e.planarConfiguration?(0,a.convertRGBColorByPixel)(e.pixelData,t):(0,a.convertRGBColorByPlane)(e.pixelData,t)}},"./imageLoader/createImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n("./externalModules.js")),r=d(n("./imageLoader/getImageFrame.js")),o=d(n("./imageLoader/decodeImageFrame.js")),i=d(n("./imageLoader/isColorImage.js")),s=d(n("./imageLoader/convertColorSpace.js")),l=d(n("./shared/getMinMax.js")),u=d(n("./imageLoader/isJPEGBaseline8BitColor.js"));function d(e){return e&&e.__esModule?e:{default:e}}var c="";t.default=function(e,t,n,d){if(!t||!t.length)return Promise.reject(new Error("The file does not contain image data."));var f=a.default.cornerstone,m=document.createElement("canvas"),g=(0,r.default)(e),h=(0,o.default)(g,n,t,m,d);return new Promise(function(t,a){h.then(function(a){var r=f.metaData.get("imagePlaneModule",e)||{},o=f.metaData.get("voiLutModule",e)||{},d=f.metaData.get("modalityLutModule",e)||{},g=f.metaData.get("sopCommonModule",e)||{},h=(0,i.default)(a.photometricInterpretation);if(!(0,u.default)(a,n)&&(function(e){e.pixelData=32===e.bitsAllocated?new Float32Array(e.pixelData):16===e.bitsAllocated?0===e.pixelRepresentation?new Uint16Array(e.pixelData):new Int16Array(e.pixelData):new Uint8Array(e.pixelData)}(a),h)){m.height=a.rows,m.width=a.columns;var v=m.getContext("2d").createImageData(a.columns,a.rows);(0,s.default)(a,v),a.imageData=v,a.pixelData=v.data;var p=(0,l.default)(a.pixelData);a.smallestPixelValue=p.min,a.largestPixelValue=p.max}var b,y={imageId:e,color:h,columnPixelSpacing:r.pixelSpacing?r.pixelSpacing[1]:void 0,columns:a.columns,height:a.rows,intercept:d.rescaleIntercept?d.rescaleIntercept:0,invert:"MONOCHROME1"===a.photometricInterpretation,minPixelValue:a.smallestPixelValue,maxPixelValue:a.largestPixelValue,rowPixelSpacing:r.pixelSpacing?r.pixelSpacing[0]:void 0,rows:a.rows,sizeInBytes:a.pixelData.length,slope:d.rescaleSlope?d.rescaleSlope:1,width:a.columns,windowCenter:o.windowCenter?o.windowCenter[0]:void 0,windowWidth:o.windowWidth?o.windowWidth[0]:void 0,decodeTimeInMS:a.decodeTimeInMS,floatPixelData:void 0};if(a.pixelData instanceof Float32Array){var x=a.pixelData,j=function(e){for(var t=(0,l.default)(e),n=Math.abs(t.max-t.min)/65535,a=t.min,r=e.length,o=new Uint16Array(r),i=65535,s=0,u=0;u<r;u++){var d=Math.floor((e[u]-a)/n);o[u]=d,i=Math.min(i,d),s=Math.max(s,d)}return{min:i,max:s,intPixelData:o,slope:n,intercept:a}}(x);y.minPixelValue=j.min,y.maxPixelValue=j.max,y.slope=j.slope,y.intercept=j.intercept,y.floatPixelData=x,y.getPixelData=function(){return j.intPixelData}}else y.getPixelData=function(){return a.pixelData};if(y.color&&(y.getCanvas=function(){return c===e||(m.height=y.rows,m.width=y.columns,m.getContext("2d").putImageData(a.imageData,0,0),c=e),m}),d.modalityLUTSequence&&d.modalityLUTSequence.length>0&&"1.2.840.10008.5.1.4.1.1.12.1"!==(b=g.sopClassUID)&&"1.2.840.10008.5.1.4.1.1.12.2.1"!==b&&(y.modalityLUT=d.modalityLUTSequence[0]),o.voiLUTSequence&&o.voiLUTSequence.length>0&&(y.voiLUT=o.voiLUTSequence[0]),y.color&&(y.windowWidth=255,y.windowCenter=127),void 0===y.windowCenter||void 0===y.windowWidth){var w=y.maxPixelValue*y.slope+y.intercept,T=y.minPixelValue*y.slope+y.intercept;y.windowWidth=w-T,y.windowCenter=(w+T)/2}t(y)},a)})}},"./imageLoader/decodeImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/internal/options.js"),r=d(n("./imageLoader/webWorkerManager.js")),o=d(n("./imageLoader/decodeJPEGBaseline8BitColor.js")),i=d(n("./shared/decodeImageFrame.js")),s=d(n("./shared/calculateMinMax.js")),l=n("./shared/decoders/decodeJPEG2000.js"),u=n("./shared/decoders/decodeJPEGLS.js");function d(e){return e&&e.__esModule?e:{default:e}}var c=!1;function f(e,t,n,o){var d=o.priority||void 0,f=o.transferPixelData?[n.buffer]:void 0,m=(0,a.getOptions)(),g=m.strict,h=m.decodeConfig;return!1===m.useWebWorkers?(!1===c&&((0,l.initializeJPEG2000)(h),(0,u.initializeJPEGLS)(h),c=!0),new Promise(function(a,r){try{var l=i.default.apply(void 0,[e,t,n,h,o]);(0,s.default)(l,g),a(l)}catch(u){r(u)}})):r.default.addTask("decodeTask",{imageFrame:e,transferSyntax:t,pixelData:n,options:o},d,f).promise}t.default=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return"1.2.840.10008.1.2"===t||"1.2.840.10008.1.2.1"===t||"1.2.840.10008.1.2.2"===t||"1.2.840.10008.1.2.1.99"===t||"1.2.840.10008.1.2.5"===t?f(e,t,n,r):"1.2.840.10008.1.2.4.50"===t?8!==e.bitsAllocated||3!==e.samplesPerPixel&&4!==e.samplesPerPixel?f(e,t,n,r):(0,o.default)(e,n,a):"1.2.840.10008.1.2.4.51"===t||"1.2.840.10008.1.2.4.57"===t||"1.2.840.10008.1.2.4.70"===t||"1.2.840.10008.1.2.4.80"===t||"1.2.840.10008.1.2.4.81"===t||"1.2.840.10008.1.2.4.90"===t||"1.2.840.10008.1.2.4.91"===t?f(e,t,n,r):new Promise(function(e,n){n(new Error("No decoder for transfer syntax "+t))})}},"./imageLoader/decodeJPEGBaseline8BitColor.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./shared/getMinMax.js"))&&a.__esModule?a:{default:a};t.default=function(e,t,n){var a=(new Date).getTime(),o=new Blob([t],{type:"image/jpeg"});return new Promise(function(t,i){var s=new FileReader;void 0===s.readAsBinaryString?s.readAsArrayBuffer(o):s.readAsBinaryString(o),s.onload=function(){var o=new Image;o.onload=function(){n.height=o.height,n.width=o.width,e.rows=o.height,e.columns=o.width;var i=n.getContext("2d");i.drawImage(this,0,0);var s=i.getImageData(0,0,o.width,o.height),l=(new Date).getTime();e.pixelData=s.data,e.imageData=s,e.decodeTimeInMS=l-a;var u=(0,r.default)(e.pixelData);e.smallestPixelValue=u.min,e.largestPixelValue=u.max,t(e)},o.onerror=function(e){i(e)},o.src=void 0===s.readAsBinaryString?"data:image/jpeg;base64,"+window.btoa(function(e){var t=void 0;try{return decodeURIComponent(escape(e))}catch(n){if((t=n)instanceof URIError)return e;throw t}}(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(s.result))))):"data:image/jpeg;base64,"+window.btoa(s.result)},s.onerror=function(e){i(e)}})}},"./imageLoader/getImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a};t.default=function(e){var t=r.default.cornerstone.metaData.get("imagePixelModule",e);return{samplesPerPixel:t.samplesPerPixel,photometricInterpretation:t.photometricInterpretation,planarConfiguration:t.planarConfiguration,rows:t.rows,columns:t.columns,bitsAllocated:t.bitsAllocated,bitsStored:t.bitsStored,pixelRepresentation:t.pixelRepresentation,smallestPixelValue:t.smallestPixelValue,largestPixelValue:t.largestPixelValue,redPaletteColorLookupTableDescriptor:t.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:t.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:t.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:t.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:t.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:t.bluePaletteColorLookupTableData,pixelData:void 0}}},"./imageLoader/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/colorSpaceConverters/index.js");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var r=n("./imageLoader/wadouri/index.js");Object.defineProperty(t,"wadouri",{enumerable:!0,get:function(){return y(r).default}});var o=n("./imageLoader/wadors/index.js");Object.defineProperty(t,"wadors",{enumerable:!0,get:function(){return y(o).default}});var i=n("./imageLoader/configure.js");Object.defineProperty(t,"configure",{enumerable:!0,get:function(){return y(i).default}});var s=n("./imageLoader/convertColorSpace.js");Object.defineProperty(t,"convertColorSpace",{enumerable:!0,get:function(){return y(s).default}});var l=n("./imageLoader/createImage.js");Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return y(l).default}});var u=n("./imageLoader/decodeImageFrame.js");Object.defineProperty(t,"decodeImageFrame",{enumerable:!0,get:function(){return y(u).default}});var d=n("./imageLoader/decodeJPEGBaseline8BitColor.js");Object.defineProperty(t,"decodeJPEGBaseline8BitColor",{enumerable:!0,get:function(){return y(d).default}});var c=n("./imageLoader/getImageFrame.js");Object.defineProperty(t,"getImageFrame",{enumerable:!0,get:function(){return y(c).default}});var f=n("./shared/getMinMax.js");Object.defineProperty(t,"getMinMax",{enumerable:!0,get:function(){return y(f).default}});var m=n("./imageLoader/isColorImage.js");Object.defineProperty(t,"isColorImage",{enumerable:!0,get:function(){return y(m).default}});var g=n("./imageLoader/isJPEGBaseline8BitColor.js");Object.defineProperty(t,"isJPEGBaseline8BitColor",{enumerable:!0,get:function(){return y(g).default}});var h=n("./imageLoader/webWorkerManager.js");Object.defineProperty(t,"webWorkerManager",{enumerable:!0,get:function(){return y(h).default}});var v=n("./version.js");Object.defineProperty(t,"version",{enumerable:!0,get:function(){return y(v).default}});var p=n("./imageLoader/internal/index.js");Object.defineProperty(t,"internal",{enumerable:!0,get:function(){return p.internal}});var b=n("./externalModules.js");function y(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"external",{enumerable:!0,get:function(){return y(b).default}})},"./imageLoader/internal/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.internal=t.xhrRequest=t.getOptions=t.setOptions=void 0;var a,r=(a=n("./imageLoader/internal/xhrRequest.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/internal/options.js"),i={xhrRequest:r.default,setOptions:o.setOptions,getOptions:o.getOptions};t.setOptions=o.setOptions,t.getOptions=o.getOptions,t.xhrRequest=r.default,t.internal=i},"./imageLoader/internal/options.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOptions=function(e){a=Object.assign(a,e)},t.getOptions=function(){return a};var a={beforeSend:function(){},imageCreated:function(){},strict:!1,useWebWorkers:!0,decodeConfig:{usePDFJS:!1}}},"./imageLoader/internal/xhrRequest.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/internal/options.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.default.cornerstone,s=(0,o.getOptions)();return new Promise(function(r,o){var l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="arraybuffer",s.beforeSend(l,t),Object.keys(n).forEach(function(e){l.setRequestHeader(e,n[e])}),a.deferred={resolve:r,reject:o},a.url=e,a.imageId=t,l.onloadstart=function(n){s.onloadstart&&s.onloadstart(n,a),i.triggerEvent(i.events,"cornerstoneimageloadstart",{url:e,imageId:t})},l.onloadend=function(n){s.onloadend&&s.onloadend(n,a),i.triggerEvent(i.events,"cornerstoneimageloadend",{url:e,imageId:t})},l.onreadystatechange=function(e){s.onreadystatechange?s.onreadystatechange(e,a):4===l.readyState&&(200===l.status?r(l.response,l):o(l))},l.onprogress=function(n){var r=n.loaded,o=void 0,l=void 0;n.lengthComputable&&(o=n.total,l=Math.round(r/o*100)),s.onprogress&&s.onprogress(n,a),i.triggerEvent(i.events,"cornerstoneimageloadprogress",{url:e,imageId:t,loaded:r,total:o,percentComplete:l})},l.send()})}},"./imageLoader/isColorImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"RGB"===e||"PALETTE COLOR"===e||"YBR_FULL"===e||"YBR_FULL_422"===e||"YBR_PARTIAL_422"===e||"YBR_PARTIAL_420"===e||"YBR_RCT"===e||"YBR_ICT"===e}},"./imageLoader/isJPEGBaseline8BitColor.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t=t||e.transferSyntax,8===e.bitsAllocated&&"1.2.840.10008.1.2.4.50"===t&&(3===e.samplesPerPixel||4===e.samplesPerPixel))return!0}},"./imageLoader/registerLoaders.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n("./imageLoader/wadors/index.js")),r=o(n("./imageLoader/wadouri/index.js"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){a.default.register(e),r.default.register(e)}},"./imageLoader/wadors/findIndexOfString.js":function(e,t,n){"use strict";function a(e,t,n){if(n+e.length>t.length)return!1;for(var a=n,r=0;r<e.length;r++)if(e[r]!==t[a++])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n=n||0;for(var r=function(e){for(var t=new Uint8Array(e.length),n=0,a=e.length;n<a;n++)t[n]=e.charCodeAt(n);return t}(t),o=n;o<e.length;o++)if(r[0]===e[o]&&a(r,e,o))return o;return-1}},"./imageLoader/wadors/getPixelData.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n("./imageLoader/internal/index.js"),o=(a=n("./imageLoader/wadors/findIndexOfString.js"))&&a.__esModule?a:{default:a};function i(e){for(var t=0;t<e.length;t++)if("--"===e[t].substr(0,2))return e[t]}function s(e){for(var t=0;t<e.length;t++)if("Content-Type:"===e[t].substr(0,13))return e[t].substr(13).trim()}function l(e,t,n){t=t||0,n=n||e.length-t;for(var a="",r=t;r<t+n;r++)a+=String.fromCharCode(e[r]);return a}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/octet-stream",a={accept:n};return new Promise(function(n,u){(0,r.xhrRequest)(e,t,a).then(function(e){var t=new Uint8Array(e),a=(0,o.default)(t,"\r\n\r\n");-1===a&&u(new Error("invalid response - no multipart mime header"));var r=l(t,0,a).split("\r\n"),d=i(r);d||u(new Error("invalid response - no boundary marker"));var c=a+4,f=(0,o.default)(t,d,c);-1===f&&u(new Error("invalid response - terminating boundary not found"));var m=f-c-2;n({contentType:s(r),imageFrame:{pixelData:new Uint8Array(e,c,m)}})})})}},"./imageLoader/wadors/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadors/metaData/index.js"),r=u(n("./imageLoader/wadors/findIndexOfString.js")),o=u(n("./imageLoader/wadors/getPixelData.js")),i=u(n("./imageLoader/wadors/metaDataManager.js")),s=u(n("./imageLoader/wadors/loadImage.js")),l=u(n("./imageLoader/wadors/register.js"));function u(e){return e&&e.__esModule?e:{default:e}}t.default={metaData:{getNumberString:a.getNumberString,getNumberValue:a.getNumberValue,getNumberValues:a.getNumberValues,getValue:a.getValue,metaDataProvider:a.metaDataProvider},findIndexOfString:r.default,getPixelData:o.default,loadImage:s.default,metaDataManager:i.default,register:l.default}},"./imageLoader/wadors/loadImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTransferSyntaxForContentType=s;var a=i(n("./imageLoader/wadors/metaDataManager.js")),r=i(n("./imageLoader/wadors/getPixelData.js")),o=i(n("./imageLoader/createImage.js"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e){var t="1.2.840.10008.1.2";return e&&e.split(";").forEach(function(e){var n=e.split("=");2===n.length&&"transfer-syntax"===n[0].trim()&&(t=n[1].trim()||t)}),t}t.default=function(e,t){var n=(new Date).getTime(),i=e.substring(7);return{promise:new Promise(function(l,u){if(void 0===a.default.get(e)){var d=new Error("no metadata for imageId "+e);return u(d)}(0,r.default)(i,e,'multipart/related; type="application/octet-stream"').then(function(a){var r=s(a.contentType);(0,o.default)(e,a.imageFrame.pixelData,r,t).then(function(e){var t=(new Date).getTime();e.loadTimeInMS=t-n,l(e)},u)},u)}),cancelFn:void 0}}},"./imageLoader/wadors/metaData/getNumberString.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/wadors/metaData/getValue.js"))&&a.__esModule?a:{default:a};t.default=function(e,t,n){var a=(0,r.default)(e,t,n);if(void 0!==a)return parseFloat(a)}},"./imageLoader/wadors/metaData/getNumberValue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/wadors/metaData/getValue.js"))&&a.__esModule?a:{default:a};t.default=function(e,t){var n=(0,r.default)(e,t);if(void 0!==n)return parseFloat(n)}},"./imageLoader/wadors/metaData/getNumberValues.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&e.Value&&!(t&&e.Value.length<t)){for(var n=[],a=0;a<e.Value.length;a++)n.push(parseFloat(e.Value[a]));return n}}},"./imageLoader/wadors/metaData/getValue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return t=t||0,e&&e.Value?e.Value.length<=t?n:e.Value[t]:n}},"./imageLoader/wadors/metaData/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadors/metaData/getNumberString.js");Object.defineProperty(t,"getNumberString",{enumerable:!0,get:function(){return l(a).default}});var r=n("./imageLoader/wadors/metaData/getNumberValue.js");Object.defineProperty(t,"getNumberValue",{enumerable:!0,get:function(){return l(r).default}});var o=n("./imageLoader/wadors/metaData/getNumberValues.js");Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return l(o).default}});var i=n("./imageLoader/wadors/metaData/getValue.js");Object.defineProperty(t,"getValue",{enumerable:!0,get:function(){return l(i).default}});var s=n("./imageLoader/wadors/metaData/metaDataProvider.js");function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return l(s).default}})},"./imageLoader/wadors/metaData/metaDataProvider.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n("./externalModules.js")),r=l(n("./imageLoader/wadors/metaData/getNumberValues.js")),o=l(n("./imageLoader/wadors/metaData/getValue.js")),i=l(n("./imageLoader/wadors/metaData/getNumberValue.js")),s=l(n("./imageLoader/wadors/metaDataManager.js"));function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var n=a.default.dicomParser,l=s.default.get(t);if(l){if("generalSeriesModule"===e)return{modality:(0,o.default)(l["00080060"]),seriesInstanceUID:(0,o.default)(l["0020000e"]),seriesNumber:(0,i.default)(l["00200011"]),studyInstanceUID:(0,o.default)(l["0020000d"]),seriesDate:n.parseDA((0,o.default)(l["00080021"])),seriesTime:n.parseTM((0,o.default)(l["00080031"],0,""))};if("patientStudyModule"===e)return{patientAge:(0,i.default)(l["00101010"]),patientSize:(0,i.default)(l["00101020"]),patientWeight:(0,i.default)(l["00101030"])};if("imagePlaneModule"===e){var u=(0,r.default)(l["00200037"],6),d=(0,r.default)(l["00200032"],3),c=(0,r.default)(l["00280030"],2),f=1,m=1;c&&(m=c[0],f=c[1]);var g=null,h=null;return u&&(g=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])],h=[parseFloat(u[3]),parseFloat(u[4]),parseFloat(u[5])]),{frameOfReferenceUID:(0,o.default)(l["00200052"]),rows:(0,i.default)(l["00280010"]),columns:(0,i.default)(l["00280011"]),imageOrientationPatient:u,rowCosines:g,columnCosines:h,imagePositionPatient:d,sliceThickness:(0,i.default)(l["00180050"]),sliceLocation:(0,i.default)(l["00201041"]),pixelSpacing:c,rowPixelSpacing:m,columnPixelSpacing:f}}if("imagePixelModule"===e)return{samplesPerPixel:(0,i.default)(l["00280002"]),photometricInterpretation:(0,o.default)(l["00280004"]),rows:(0,i.default)(l["00280010"]),columns:(0,i.default)(l["00280011"]),bitsAllocated:(0,i.default)(l["00280100"]),bitsStored:(0,i.default)(l["00280101"]),highBit:(0,o.default)(l["00280102"]),pixelRepresentation:(0,i.default)(l["00280103"]),planarConfiguration:(0,i.default)(l["00280006"]),pixelAspectRatio:(0,o.default)(l["00280034"]),smallestPixelValue:(0,i.default)(l["00280106"]),largestPixelValue:(0,i.default)(l["00280107"]),redPaletteColorLookupTableDescriptor:(0,r.default)(l["00281101"]),greenPaletteColorLookupTableDescriptor:(0,r.default)(l["00281102"]),bluePaletteColorLookupTableDescriptor:(0,r.default)(l["00281103"]),redPaletteColorLookupTableData:(0,r.default)(l["00281201"]),greenPaletteColorLookupTableData:(0,r.default)(l["00281202"]),bluePaletteColorLookupTableData:(0,r.default)(l["00281203"])};if("voiLutModule"===e)return{windowCenter:(0,r.default)(l["00281050"],1),windowWidth:(0,r.default)(l["00281051"],1)};if("modalityLutModule"===e)return{rescaleIntercept:(0,i.default)(l["00281052"]),rescaleSlope:(0,i.default)(l["00281053"]),rescaleType:(0,o.default)(l["00281054"])};if("sopCommonModule"===e)return{sopClassUID:(0,o.default)(l["00080016"]),sopInstanceUID:(0,o.default)(l["00080018"])};if("petIsotopeModule"===e){var v=(0,o.default)(l["00540016"]);if(void 0===v)return;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:n.parseTM((0,o.default)(v["00181072"],0,"")),radionuclideTotalDose:(0,i.default)(v["00181074"]),radionuclideHalfLife:(0,i.default)(v["00181075"])}}}}}},"./imageLoader/wadors/metaDataManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[];t.default={add:function(e,t){a[e]=t},get:function(e){return a[e]},remove:function(e){a[e]=void 0},purge:function(){a=[]}}},"./imageLoader/wadors/register.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.registerImageLoader("wadors",r.default),e.metaData.addProvider(o.metaDataProvider)};var a,r=(a=n("./imageLoader/wadors/loadImage.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/wadors/metaData/index.js")},"./imageLoader/wadouri/dataSetCacheManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInfo=u;var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/internal/index.js"),i=0,s={},l={};function u(){return{cacheSizeInBytes:i,numberOfDataSetsCached:Object.keys(s).length}}t.default={isLoaded:function(e){return void 0!==s[e]},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.xhrRequest,n=arguments[2],a=r.default.cornerstone,d=r.default.dicomParser;if(s[e])return new Promise(function(t){s[e].cacheCount++,t(s[e].dataSet)});if(l[e])return l[e].cacheCount++,l[e];var c=t(e,n),f=new Promise(function(t,n){c.then(function(r){var o=new Uint8Array(r),l=void 0;try{l=d.parseDicom(o)}catch(c){return n(c)}s[e]={dataSet:l,cacheCount:f.cacheCount},i+=l.byteArray.length,t(l),a.triggerEvent(a.events,"datasetscachechanged",{uri:e,action:"loaded",cacheInfo:u()})},n).then(function(){delete l[e]},function(){delete l[e]})});return f.cacheCount=1,l[e]=f,f},unload:function(e){var t=r.default.cornerstone;s[e]&&(s[e].cacheCount--,0===s[e].cacheCount&&(i-=s[e].dataSet.byteArray.length,delete s[e],t.triggerEvent(t.events,"datasetscachechanged",{uri:e,action:"unloaded",cacheInfo:u()})))},getInfo:u,purge:function(){s={},l={}},get:function(e){if(s[e])return s[e].dataSet}}},"./imageLoader/wadouri/fileManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[];t.default={add:function(e){return"dicomfile:"+(a.push(e)-1)},get:function(e){return a[e]},remove:function(e){a[e]=void 0},purge:function(){a=[]}}},"./imageLoader/wadouri/getEncapsulatedImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=r.default.dicomParser;if(e.elements.x7fe00010&&e.elements.x7fe00010.basicOffsetTable.length)return n.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t);if(function(e){return e.intString("x00280008")!==e.elements.x7fe00010.fragments.length}(e)){var a=n.createJPEGBasicOffsetTable(e,e.elements.x7fe00010);return n.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t,a)}return n.readEncapsulatedPixelDataFromFragments(e,e.elements.x7fe00010,t)};var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a}},"./imageLoader/wadouri/getPixelData.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n("./imageLoader/wadouri/getEncapsulatedImageFrame.js")),r=o(n("./imageLoader/wadouri/getUncompressedImageFrame.js"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.elements.x7fe00010||e.elements.x7fe00008;return n?n.encapsulatedPixelData?(0,a.default)(e,t):(0,r.default)(e,t):null}},"./imageLoader/wadouri/getUncompressedImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/wadouri/unpackBinaryFrame.js"))&&a.__esModule?a:{default:a};t.default=function(e,t){var n=e.elements.x7fe00010||e.elements.x7fe00008,a=e.uint16("x00280100"),o=e.uint16("x00280010"),i=e.uint16("x00280011"),s=e.uint16("x00280002"),l=n.dataOffset,u=o*i*s,d=void 0;if(8===a){if((d=l+t*u)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,u)}if(16===a){if((d=l+t*u*2)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,2*u)}if(1===a){if((d=l+t*u*.125)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return(0,r.default)(e.byteArray,d,u)}if(32===a){if((d=l+t*u*4)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,4*u)}throw new Error("unsupported pixel format")}},"./imageLoader/wadouri/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadouri/metaData/index.js"),r=m(n("./imageLoader/wadouri/dataSetCacheManager.js")),o=m(n("./imageLoader/wadouri/fileManager.js")),i=m(n("./imageLoader/wadouri/getEncapsulatedImageFrame.js")),s=m(n("./imageLoader/wadouri/getUncompressedImageFrame.js")),l=m(n("./imageLoader/wadouri/loadFileRequest.js")),u=n("./imageLoader/wadouri/loadImage.js"),d=m(n("./imageLoader/wadouri/parseImageId.js")),c=m(n("./imageLoader/wadouri/unpackBinaryFrame.js")),f=m(n("./imageLoader/wadouri/register.js"));function m(e){return e&&e.__esModule?e:{default:e}}t.default={metaData:{getImagePixelModule:a.getImagePixelModule,getLUTs:a.getLUTs,getModalityLUTOutputPixelRepresentation:a.getModalityLUTOutputPixelRepresentation,getNumberValues:a.getNumberValues,metaDataProvider:a.metaDataProvider},dataSetCacheManager:r.default,fileManager:o.default,getEncapsulatedImageFrame:i.default,getUncompressedImageFrame:s.default,loadFileRequest:l.default,loadImageFromPromise:u.loadImageFromPromise,getLoaderForScheme:u.getLoaderForScheme,loadImage:u.loadImage,parseImageId:d.default,unpackBinaryFrame:c.default,register:f.default}},"./imageLoader/wadouri/loadFileRequest.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n("./imageLoader/wadouri/parseImageId.js")),r=o(n("./imageLoader/wadouri/fileManager.js"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=(0,a.default)(e),n=parseInt(t.url,10),o=r.default.get(n);return new Promise(function(e,t){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.onerror=t,n.readAsArrayBuffer(o)})}},"./imageLoader/wadouri/loadImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadImage=t.getLoaderForScheme=t.loadImageFromPromise=void 0;var a=u(n("./imageLoader/createImage.js")),r=u(n("./imageLoader/wadouri/parseImageId.js")),o=u(n("./imageLoader/wadouri/dataSetCacheManager.js")),i=u(n("./imageLoader/wadouri/loadFileRequest.js")),s=u(n("./imageLoader/wadouri/getPixelData.js")),l=n("./imageLoader/internal/index.js");function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){e.decache=function(){var e=(0,r.default)(t);o.default.unload(e.url)}}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments[3],o=arguments[4],i=arguments[5],l=(new Date).getTime(),u={cancelFn:void 0};return u.promise=new Promise(function(c,f){e.then(function(e){var m=(0,s.default)(e,n),g=e.string("x00020010"),h=(new Date).getTime(),v=(0,a.default)(t,m,g,o);d(u,t),v.then(function(t){t.data=e,t.sharedCacheKey=r;var n=(new Date).getTime();t.loadTimeInMS=h-l,t.totalTimeInMS=n-l,void 0!==i&&void 0!==i.imageDoneCallback&&i.imageDoneCallback(t),c(t)},function(t){f({error:t,dataSet:e})})},function(e){f({error:e})})}),u}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments[3],o=arguments[4],i=(new Date).getTime(),l=new Promise(function(l,u){var d=(new Date).getTime(),c=void 0;try{var f=(0,s.default)(e,n),m=e.string("x00020010");c=(0,a.default)(t,f,m,o)}catch(g){return void u({error:g,dataSet:e})}c.then(function(t){t.data=e,t.sharedCacheKey=r;var n=(new Date).getTime();t.loadTimeInMS=d-i,t.totalTimeInMS=n-i,l(t)},u)});return{promise:l,cancelFn:void 0}}function m(e){return"dicomweb"===e||"wadouri"===e?l.xhrRequest:"dicomfile"===e?i.default:void 0}t.loadImageFromPromise=c,t.getLoaderForScheme=m,t.loadImage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,r.default)(e),a=t.loader;if(void 0===a&&(a=m(n.scheme)),o.default.isLoaded(n.url)){var i=o.default.get(n.url,a,e);return f(i,e,n.frame,n.url,t)}var s=o.default.load(n.url,a,e);return c(s,e,n.frame,n.url,t)}},"./imageLoader/wadouri/metaData/getImagePixelModule.js":function(e,t,n){"use strict";function a(e,t){if(e.elements[t]&&6===e.elements[t].length)return[e.uint16(t,0),e.uint16(t,1),e.uint16(t,2)]}function r(e,t,n){for(var a=[],r=e.elements[t],o=0;o<n[0];o++)a[o]=16===n[2]?e.uint16(t,o):e.byteArray[o+r.dataOffset];return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={samplesPerPixel:e.uint16("x00280002"),photometricInterpretation:e.string("x00280004"),rows:e.uint16("x00280010"),columns:e.uint16("x00280011"),bitsAllocated:e.uint16("x00280100"),bitsStored:e.uint16("x00280101"),highBit:e.uint16("x00280102"),pixelRepresentation:e.uint16("x00280103"),planarConfiguration:e.uint16("x00280006"),pixelAspectRatio:e.string("x00280034")};return function(e,t){0===e.uint16("x00280103")?(t.smallestPixelValue=e.uint16("x00280106"),t.largestPixelValue=e.uint16("x00280107")):(t.smallestPixelValue=e.int16("x00280106"),t.largestPixelValue=e.int16("x00280107"))}(e,t),"PALETTE COLOR"===t.photometricInterpretation&&e.elements.x00281101&&function(e,t){t.redPaletteColorLookupTableDescriptor=a(e,"x00281101"),t.greenPaletteColorLookupTableDescriptor=a(e,"x00281102"),t.bluePaletteColorLookupTableDescriptor=a(e,"x00281103"),0===t.redPaletteColorLookupTableDescriptor[0]&&(t.redPaletteColorLookupTableDescriptor[0]=65536,t.greenPaletteColorLookupTableDescriptor[0]=65536,t.bluePaletteColorLookupTableDescriptor[0]=65536);var n=e.elements.x00281201.length===t.redPaletteColorLookupTableDescriptor[0]?8:16;t.redPaletteColorLookupTableDescriptor[2]!==n&&(t.redPaletteColorLookupTableDescriptor[2]=n,t.greenPaletteColorLookupTableDescriptor[2]=n,t.bluePaletteColorLookupTableDescriptor[2]=n),t.redPaletteColorLookupTableData=r(e,"x00281201",t.redPaletteColorLookupTableDescriptor),t.greenPaletteColorLookupTableData=r(e,"x00281202",t.greenPaletteColorLookupTableDescriptor),t.bluePaletteColorLookupTableData=r(e,"x00281203",t.bluePaletteColorLookupTableDescriptor)}(e,t),t}},"./imageLoader/wadouri/metaData/getLUTs.js":function(e,t,n){"use strict";function a(e,t){var n=t.uint16("x00283002",0);0===n&&(n=65535);for(var a={id:"1",firstValueMapped:0===e?t.uint16("x00283002",1):t.int16("x00283002",1),numBitsPerEntry:t.uint16("x00283002",2),lut:[]},r=0;r<n;r++)a.lut[r]=0===e?t.uint16("x00283006",r):t.int16("x00283006",r);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t&&t.items.length){for(var n=[],r=0;r<t.items.length;r++){var o=a(e,t.items[r].dataSet);o&&n.push(o)}return n}}},"./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.string("x00080016");if("1.2.840.10008.5.1.4.1.1.2"===t||"1.2.840.10008.5.1.4.1.1.2.1"===t)return 1;var n=e.floatString("x00281052"),a=e.floatString("x00281053");return void 0!==n&&void 0!==a?function(e){var t=e.uint16("x00280103"),n=e.uint16("x00280101");return 0===t?0:-1<<n-1}(e)*a+n<0?1:0:e.elements.x00283000&&e.elements.x00283000.length>0?0:e.uint16("x00280103")}},"./imageLoader/wadouri/metaData/getNumberValues.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var a=[],r=e.string(t);if(r){var o=r.split("\\");if(!(n&&o.length<n)){for(var i=0;i<o.length;i++)a.push(parseFloat(o[i]));return a}}}},"./imageLoader/wadouri/metaData/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadouri/metaData/getImagePixelModule.js");Object.defineProperty(t,"getImagePixelModule",{enumerable:!0,get:function(){return l(a).default}});var r=n("./imageLoader/wadouri/metaData/getLUTs.js");Object.defineProperty(t,"getLUTs",{enumerable:!0,get:function(){return l(r).default}});var o=n("./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js");Object.defineProperty(t,"getModalityLUTOutputPixelRepresentation",{enumerable:!0,get:function(){return l(o).default}});var i=n("./imageLoader/wadouri/metaData/getNumberValues.js");Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return l(i).default}});var s=n("./imageLoader/wadouri/metaData/metaDataProvider.js");function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return l(s).default}})},"./imageLoader/wadouri/metaData/metaDataProvider.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n("./externalModules.js")),r=d(n("./imageLoader/wadouri/metaData/getNumberValues.js")),o=d(n("./imageLoader/wadouri/parseImageId.js")),i=d(n("./imageLoader/wadouri/dataSetCacheManager.js")),s=d(n("./imageLoader/wadouri/metaData/getImagePixelModule.js")),l=d(n("./imageLoader/wadouri/metaData/getLUTs.js")),u=d(n("./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js"));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var n=a.default.dicomParser,d=(0,o.default)(t),c=i.default.get(d.url);if(c){if("generalSeriesModule"===e)return{modality:c.string("x00080060"),seriesInstanceUID:c.string("x0020000e"),seriesNumber:c.intString("x00200011"),studyInstanceUID:c.string("x0020000d"),seriesDate:n.parseDA(c.string("x00080021")),seriesTime:n.parseTM(c.string("x00080031")||"")};if("patientStudyModule"===e)return{patientAge:c.intString("x00101010"),patientSize:c.floatString("x00101020"),patientWeight:c.floatString("x00101030")};if("imagePlaneModule"===e){var f=(0,r.default)(c,"x00200037",6),m=(0,r.default)(c,"x00200032",3),g=(0,r.default)(c,"x00280030",2),h=1,v=1;g&&(v=g[0],h=g[1]);var p=null,b=null;return f&&(p=[parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2])],b=[parseFloat(f[3]),parseFloat(f[4]),parseFloat(f[5])]),{frameOfReferenceUID:c.string("x00200052"),rows:c.uint16("x00280010"),columns:c.uint16("x00280011"),imageOrientationPatient:f,rowCosines:p,columnCosines:b,imagePositionPatient:m,sliceThickness:c.floatString("x00180050"),sliceLocation:c.floatString("x00201041"),pixelSpacing:g,rowPixelSpacing:v,columnPixelSpacing:h}}if("imagePixelModule"===e)return(0,s.default)(c);if("modalityLutModule"===e)return{rescaleIntercept:c.floatString("x00281052"),rescaleSlope:c.floatString("x00281053"),rescaleType:c.string("x00281054"),modalityLUTSequence:(0,l.default)(c.uint16("x00280103"),c.elements.x00283000)};if("voiLutModule"===e){var y=(0,u.default)(c);return{windowCenter:(0,r.default)(c,"x00281050",1),windowWidth:(0,r.default)(c,"x00281051",1),voiLUTSequence:(0,l.default)(y,c.elements.x00283010)}}if("sopCommonModule"===e)return{sopClassUID:c.string("x00080016"),sopInstanceUID:c.string("x00080018")};if("petIsotopeModule"===e){var x=c.elements.x00540016;if(void 0===x)return;var j=x.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:n.parseTM(j.string("x00181072")||""),radionuclideTotalDose:j.floatString("x00181074"),radionuclideHalfLife:j.floatString("x00181075")}}}}}},"./imageLoader/wadouri/parseImageId.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.indexOf(":"),n=e.substring(t+1),a=n.indexOf("frame="),r=void 0;if(-1!==a){var o=n.substr(a+6);r=parseInt(o,10),n=n.substr(0,a-1)}return{scheme:e.substr(0,t),url:n,frame:r}}},"./imageLoader/wadouri/register.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.registerImageLoader("dicomweb",a.loadImage),e.registerImageLoader("wadouri",a.loadImage),e.registerImageLoader("dicomfile",a.loadImage),e.metaData.addProvider(r.metaDataProvider)};var a=n("./imageLoader/wadouri/loadImage.js"),r=n("./imageLoader/wadouri/metaData/index.js")},"./imageLoader/wadouri/unpackBinaryFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){for(var a=new Uint8Array(n),r=0;r<n;r++){var o=Math.floor(r/8);a[r]=e[o+t]&1<<r%8?1:0}return a}},"./imageLoader/webWorkerManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/internal/options.js"),r=0,o=[],i=[],s=(0,a.getOptions)(),l={maxWebWorkers:navigator.hardwareConcurrency||1,startWebWorkersOnDemand:!0,webWorkerPath:"../../dist/cornerstoneWADOImageLoaderWebWorker.js",webWorkerTaskPaths:[],taskConfiguration:{decodeTask:{loadCodecsOnStartup:!0,initializeCodecsOnStartup:!1,codecsPath:"../dist/cornerstoneWADOImageLoaderCodecs.js",usePDFJS:!1,strict:s.strict}}},u=void 0,d={maxWebWorkers:0,numWebWorkers:0,numTasksQueued:0,numTasksExecuting:0,numTasksCompleted:0,totalTaskTimeInMS:0,totalTimeDelayedInMS:0};function c(){if(o.length){for(var e=0;e<i.length;e++)if("ready"===i[e].status){i[e].status="busy";var t=o.shift();t.start=(new Date).getTime();var n=(new Date).getTime();return d.totalTimeDelayedInMS+=n-t.added,i[e].task=t,i[e].worker.postMessage({taskType:t.taskType,workerIndex:e,data:t.data},t.transferList),void d.numTasksExecuting++}i.length<u.maxWebWorkers&&m()}}function f(e){if("initialize"===e.data.taskType)i[e.data.workerIndex].status="ready",c();else{var t=i[e.data.workerIndex].task.start;i[e.data.workerIndex].task.deferred.resolve(e.data.result),i[e.data.workerIndex].task=void 0,d.numTasksExecuting--,i[e.data.workerIndex].status="ready",d.numTasksCompleted++;var n=(new Date).getTime();d.totalTaskTimeInMS+=n-t,c()}}function m(){if(!(i.length>=u.maxWebWorkers)){var e=new Worker(u.webWorkerPath);i.push({worker:e,status:"initializing"}),e.addEventListener("message",f),e.postMessage({taskType:"initialize",workerIndex:i.length-1,config:u})}}function g(e){if(e=e||l,u)throw new Error("WebWorkerManager already initialized");if((u=e).maxWebWorkers=u.maxWebWorkers||navigator.hardwareConcurrency||1,!u.startWebWorkersOnDemand)for(var t=0;t<u.maxWebWorkers;t++)m()}t.default={initialize:g,loadWebWorkerTask:function(e,t){u.webWorkerTaskPaths.push(e),t&&(u.taskConfiguration=Object.assign(u.taskConfiguration,t));for(var n=0;n<i.length;n++)i[n].worker.postMessage({taskType:"loadWebWorkerTask",workerIndex:i.length-1,sourcePath:e,config:u})},addTask:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments[3];u||g();var i={},s=new Promise(function(e,t){i={resolve:e,reject:t}}),l=void 0;for(l=0;l<o.length&&!(o[l].priority<n);l++);var d=r++;return o.splice(l,0,{taskId:d,taskType:e,status:"ready",added:(new Date).getTime(),data:t,deferred:i,priority:n,transferList:a}),c(),{taskId:d,promise:s}},getStatistics:function(){return d.maxWebWorkers=u.maxWebWorkers,d.numWebWorkers=i.length,d.numTasksQueued=o.length,d},setTaskPriority:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<o.length;n++)if(o[n].taskId===e){var a=o.splice(n,1)[0];for(a.priority=t,n=0;n<o.length&&!(o[n].priority<t);n++);return o.splice(n,0,a),!0}return!1},cancelTask:function(e,t){for(var n=0;n<o.length;n++)if(o[n].taskId===e)return o.splice(n,1).deferred.reject(t),!0;return!1}}},"./shared/calculateMinMax.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,r.default)(e.pixelData),a=!(o(e.smallestPixelValue)&&o(e.largestPixelValue));!0!==t||a?(e.smallestPixelValue=n.min,e.largestPixelValue=n.max):(e.smallestPixelValue!==n.min&&console.warn("Image smallestPixelValue tag is incorrect. Rendering performance will suffer considerably."),e.largestPixelValue!==n.max&&console.warn("Image largestPixelValue tag is incorrect. Rendering performance will suffer considerably."))};var a,r=(a=n("./shared/getMinMax.js"))&&a.__esModule?a:{default:a};function o(e){return"number"==typeof e}},"./shared/decodeImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n("./shared/decoders/decodeLittleEndian.js")),r=d(n("./shared/decoders/decodeBigEndian.js")),o=d(n("./shared/decoders/decodeRLE.js")),i=d(n("./shared/decoders/decodeJPEGBaseline.js")),s=d(n("./shared/decoders/decodeJPEGLossless.js")),l=d(n("./shared/decoders/decodeJPEGLS.js")),u=d(n("./shared/decoders/decodeJPEG2000.js"));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n,d,c){var f=(new Date).getTime();if("1.2.840.10008.1.2"===t)e=(0,a.default)(e,n);else if("1.2.840.10008.1.2.1"===t)e=(0,a.default)(e,n);else if("1.2.840.10008.1.2.2"===t)e=(0,r.default)(e,n);else if("1.2.840.10008.1.2.1.99"===t)e=(0,a.default)(e,n);else if("1.2.840.10008.1.2.5"===t)e=(0,o.default)(e,n);else if("1.2.840.10008.1.2.4.50"===t)e=(0,i.default)(e,n);else if("1.2.840.10008.1.2.4.51"===t)e=(0,i.default)(e,n);else if("1.2.840.10008.1.2.4.57"===t)e=(0,s.default)(e,n);else if("1.2.840.10008.1.2.4.70"===t)e=(0,s.default)(e,n);else if("1.2.840.10008.1.2.4.80"===t)e=(0,l.default)(e,n);else if("1.2.840.10008.1.2.4.81"===t)e=(0,l.default)(e,n);else if("1.2.840.10008.1.2.4.90"===t)e=(0,u.default)(e,n,d,c);else{if("1.2.840.10008.1.2.4.91"!==t)throw new Error("no decoder for transfer syntax "+t);e=(0,u.default)(e,n,d,c)}var m=void 0!==e.pixelRepresentation&&1===e.pixelRepresentation,g=m&&void 0!==e.bitsStored?32-e.bitsStored:void 0;if(m&&void 0!==g)for(var h=0;h<e.pixelData.length;h++)e.pixelData[h]=e.pixelData[h]<<g>>g;var v=(new Date).getTime();return e.decodeTimeInMS=v-f,e}},"./shared/decoders/decodeBigEndian.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(16===e.bitsAllocated){var n=t.buffer,a=t.byteOffset,r=t.length;a%2&&(n=n.slice(a),a=0),e.pixelData=0===e.pixelRepresentation?new Uint16Array(n,a,r/2):new Int16Array(n,a,r/2);for(var o=0;o<e.pixelData.length;o++)e.pixelData[o]=(255&(i=e.pixelData[o]))<<8|i>>8&255}else 8===e.bitsAllocated&&(e.pixelData=t);var i;return e}},"./shared/decoders/decodeJPEG2000.js":function(e,t,n){"use strict";function a(e,t){var n=new JpxImage;n.parse(t);var a=n.tiles.length;if(1!==a)throw new Error("JPEG2000 decoder returned a tileCount of "+a+", when 1 is expected");return e.columns=n.width,e.rows=n.height,e.pixelData=n.tiles[0].items,e}Object.defineProperty(t,"__esModule",{value:!0});var r=void 0;function o(e,t){var n=function(e,t,n){var a=r._malloc(e.length);r.writeArrayToMemory(e,a);var o=r._malloc(4),i=r._malloc(4),s=r._malloc(4),l=r._malloc(4),u=r._malloc(4),d=(new Date).getTime();if(0!==r.ccall("jp2_decode","number",["number","number","number","number","number","number","number"],[a,e.length,o,i,s,l,u]))return console.log("[opj_decode] decoding failed!"),r._free(a),r._free(r.getValue(o,"*")),r._free(s),r._free(l),r._free(i),void r._free(u);var c=r.getValue(o,"*"),f={length:r.getValue(i,"i32"),sx:r.getValue(s,"i32"),sy:r.getValue(l,"i32"),nbChannels:r.getValue(u,"i32"),perf_timetodecode:void 0,pixelData:void 0},m=f.sx*f.sy*f.nbChannels,g=new Int32Array(r.HEAP32.buffer,c,m);if(1===t)if(Uint8Array.from)f.pixelData=Uint8Array.from(g);else{f.pixelData=new Uint8Array(m);for(var h=0;h<m;h++)f.pixelData[h]=g[h]}else if(n)if(Int16Array.from)f.pixelData=Int16Array.from(g);else{f.pixelData=new Int16Array(m);for(var v=0;v<m;v++)f.pixelData[v]=g[v]}else if(Uint16Array.from)f.pixelData=Uint16Array.from(g);else{f.pixelData=new Uint16Array(m);for(var p=0;p<m;p++)f.pixelData[p]=g[p]}var b=(new Date).getTime();return f.perf_timetodecode=b-d,r._free(a),r._free(o),r._free(c),r._free(i),r._free(s),r._free(l),r._free(u),f}(t,e.bitsAllocated<=8?1:2,1===e.pixelRepresentation);return e.columns=n.sx,e.rows=n.sy,e.pixelData=n.pixelData,n.nbChannels>1&&(e.photometricInterpretation="RGB"),e}function i(e){if(!e.usePDFJS&&"undefined"==typeof OpenJPEG)throw new Error("OpenJPEG decoder not loaded");if(!(r||(r=OpenJPEG())&&r._jp2_decode))throw new Error("OpenJPEG failed to initialize")}t.default=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i(n),r.usePDFJS||n.usePDFJS?a(e,t):o(e,t)},t.initializeJPEG2000=i},"./shared/decoders/decodeJPEGBaseline.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("undefined"==typeof JpegImage)throw new Error("No JPEG Baseline decoder loaded");var n=new JpegImage;return n.parse(t),n.colorTransform=!1,8===e.bitsAllocated?(e.pixelData=n.getData(e.columns,e.rows),e):16===e.bitsAllocated?(e.pixelData=n.getData16(e.columns,e.rows),e):void 0}},"./shared/decoders/decodeJPEGLS.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=void 0;function r(){if("undefined"==typeof CharLS)throw new Error("No JPEG-LS decoder loaded");if(!(a||(a=CharLS())&&a._jpegls_decode))throw new Error("JPEG-LS failed to initialize")}t.default=function(e,t){r();var n=function(e,t){var n=a._malloc(e.length);a.writeArrayToMemory(e,n);var r=a._malloc(4),o=a._malloc(4),i=a._malloc(4),s=a._malloc(4),l=a._malloc(4),u=a._malloc(4),d=a._malloc(4),c=a._malloc(4),f=a._malloc(4),m={result:a.ccall("jpegls_decode","number",["number","number","number","number","number","number","number","number","number","number","number"],[n,e.length,r,o,i,s,l,u,c,d,f]),width:a.getValue(i,"i32"),height:a.getValue(s,"i32"),bitsPerSample:a.getValue(l,"i32"),stride:a.getValue(u,"i32"),components:a.getValue(c,"i32"),allowedLossyError:a.getValue(d,"i32"),interleaveMode:a.getValue(f,"i32"),pixelData:void 0},g=a.getValue(r,"*");return m.bitsPerSample<=8?(m.pixelData=new Uint8Array(m.width*m.height*m.components),m.pixelData.set(new Uint8Array(a.HEAP8.buffer,g,m.pixelData.length))):t?(m.pixelData=new Int16Array(m.width*m.height*m.components),m.pixelData.set(new Int16Array(a.HEAP16.buffer,g,m.pixelData.length))):(m.pixelData=new Uint16Array(m.width*m.height*m.components),m.pixelData.set(new Uint16Array(a.HEAP16.buffer,g,m.pixelData.length))),a._free(n),a._free(g),a._free(r),a._free(o),a._free(i),a._free(s),a._free(l),a._free(u),a._free(c),a._free(f),m}(t,1===e.pixelRepresentation);if(0!==n.result&&6!==n.result)throw new Error("JPEG-LS decoder failed to decode frame (error code "+n.result+")");return e.columns=n.width,e.rows=n.height,e.pixelData=n.pixelData,e},t.initializeJPEGLS=r},"./shared/decoders/decodeJPEGLossless.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("undefined"==typeof jpeg||void 0===jpeg.lossless||void 0===jpeg.lossless.Decoder)throw new Error("No JPEG Lossless decoder loaded");var n=e.bitsAllocated<=8?1:2,a=t.buffer,r=(new jpeg.lossless.Decoder).decode(a,t.byteOffset,t.length,n);return 0===e.pixelRepresentation?16===e.bitsAllocated?(e.pixelData=new Uint16Array(r.buffer),e):(e.pixelData=new Uint8Array(r.buffer),e):(e.pixelData=new Int16Array(r.buffer),e)}},"./shared/decoders/decodeLittleEndian.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.buffer,a=t.byteOffset,r=t.length;return 16===e.bitsAllocated?(a%2&&(n=n.slice(a),a=0),e.pixelData=0===e.pixelRepresentation?new Uint16Array(n,a,r/2):new Int16Array(n,a,r/2)):8===e.bitsAllocated||1===e.bitsAllocated?e.pixelData=t:32===e.bitsAllocated&&(a%2&&(n=n.slice(a),a=0),e.pixelData=new Float32Array(n,a,r/4)),e}},"./shared/decoders/decodeRLE.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(8===e.bitsAllocated)return e.planarConfiguration?function(e,t){for(var n=t,a=e.rows*e.columns,r=new ArrayBuffer(a*e.samplesPerPixel),o=new DataView(n.buffer,n.byteOffset),i=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(r),l=0,u=o.getInt32(0,!0),d=0;d<u;++d){l=d*a;var c=o.getInt32(4*(d+1),!0),f=o.getInt32(4*(d+2),!0);0===f&&(f=n.length);for(var m=a*u;c<f;){var g=i[c++];if(g>=0&&g<=127)for(var h=0;h<g+1&&l<m;++h)s[l]=i[c++],l++;else if(g<=-1&&g>=-127)for(var v=i[c++],p=0;p<1-g&&l<m;++p)s[l]=v,l++}}return e.pixelData=new Uint8Array(r),e}(e,t):function(e,t){for(var n=t,a=e.rows*e.columns,r=new ArrayBuffer(a*e.samplesPerPixel),o=new DataView(n.buffer,n.byteOffset),i=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(r),l=0,u=o.getInt32(0,!0),d=0;d<u;++d){l=d;var c=o.getInt32(4*(d+1),!0),f=o.getInt32(4*(d+2),!0);0===f&&(f=n.length);for(var m=a*u;c<f;){var g=i[c++];if(g>=0&&g<=127)for(var h=0;h<g+1&&l<m;++h)s[l]=i[c++],l+=e.samplesPerPixel;else if(g<=-1&&g>=-127)for(var v=i[c++],p=0;p<1-g&&l<m;++p)s[l]=v,l+=e.samplesPerPixel}}return e.pixelData=new Uint8Array(r),e}(e,t);if(16===e.bitsAllocated)return function(e,t){for(var n=t,a=e.rows*e.columns,r=new ArrayBuffer(a*e.samplesPerPixel*2),o=new DataView(n.buffer,n.byteOffset),i=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(r),l=o.getInt32(0,!0),u=0;u<l;++u){var d=0,c=0===u?1:0,f=o.getInt32(4*(u+1),!0),m=o.getInt32(4*(u+2),!0);for(0===m&&(m=n.length);f<m;){var g=i[f++];if(g>=0&&g<=127)for(var h=0;h<g+1&&d<a;++h)s[2*d+c]=i[f++],d++;else if(g<=-1&&g>=-127)for(var v=i[f++],p=0;p<1-g&&d<a;++p)s[2*d+c]=v,d++}}return e.pixelData=0===e.pixelRepresentation?new Uint16Array(r):new Int16Array(r),e}(e,t);throw new Error("unsupported pixel format for RLE")}},"./shared/getMinMax.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=e[0],n=e[0],a=void 0,r=e.length,o=1;o<r;o++)a=e[o],t=Math.min(t,a),n=Math.max(n,a);return{min:t,max:n}}},"./version.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="2.1.4"}})});